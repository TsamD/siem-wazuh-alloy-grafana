define(["@grafana/data","lodash","rxjs","@grafana/runtime","react","@emotion/css","@grafana/ui"],((e,t,r,n,a,s,i)=>(()=>{var o={8331:(e,t,r)=>{"use strict";var n=r(8531),a=(r(1269),r(7781),r(688));r(5959),r(2007);function s(e){return"function"==typeof e}var i,o=((i=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),i.prototype.constructor=i,i);function l(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var u=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,r,n,i;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var u=a.__values(l),p=u.next();!p.done;p=u.next())p.value.remove(this)}catch(t){e={error:t}}finally{try{p&&!p.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}else l.remove(this);var d=this.initialTeardown;if(s(d))try{d()}catch(e){i=e instanceof o?e.errors:[e]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var g=a.__values(f),h=g.next();!h.done;h=g.next()){var m=h.value;try{c(m)}catch(e){i=null!=i?i:[],e instanceof o?i=a.__spreadArray(a.__spreadArray([],a.__read(i)),a.__read(e.errors)):i.push(e)}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=g.return)&&n.call(g)}finally{if(r)throw r.error}}}if(i)throw new o(i)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)c(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&l(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&l(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function c(e){s(e)?e():e.unsubscribe()}u.EMPTY;var p=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,a.__spreadArray([e,t],a.__read(r)))};function d(){}var f=function(e){function t(t){var r,n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,((r=t)instanceof u||r&&"closed"in r&&s(r.remove)&&s(r.add)&&s(r.unsubscribe))&&t.add(n)):n.destination=y,n}return a.__extends(t,e),t.create=function(e,t,r){return new h(e,t,r)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(u);Function.prototype.bind;var g=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){m(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){m(e)}else m(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){m(e)}},e}(),h=function(e){function t(t,r,n){var a,i=e.call(this)||this;return a=s(t)||!t?{next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:t,i.destination=new g(a),i}return a.__extends(t,e),t}(f);function m(e){var t;t=e,p((function(){throw t}))}var y={closed:!0,next:d,error:function(e){throw e},complete:d};!function(e){function t(t,r,n,a,s,i){var o=e.call(this,t)||this;return o.onFinalize=s,o.shouldUnsubscribe=i,o._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,o._error=a?function(e){try{a(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,o._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,o}a.__extends(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}(f);Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;n.DataSourceWithBackend},9868:(e,t,r)=>{var n,a,s,i,o,l,u,c,p,d,f=r(2007),g=r(5959),h=(n=g)&&"object"==typeof n&&"default"in n?n.default:n,m=(r(7781),r(8531),r(6089));function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,s=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)i.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return i}function v(e,t,r){if(r||2===arguments.length)for(var n,a=0,s=t.length;a<s;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}(a=t.hu||(t.hu={}))[a.Comparison=0]="Comparison",a[a.Logical=1]="Logical",(s=t.hh||(t.hh={}))[s.Value=0]="Value",s[s.Filter=1]="Filter",s[s.Group=2]="Group",s[s.Column=3]="Column",s[s.Table=4]="Table",(i=t.ks||(t.ks={})).Parenthesis="delimiter.parenthesis.sql",i.Whitespace="white.sql",i.Keyword="keyword.sql",i.Delimiter="delimiter.sql",i.Operator="operator.sql",i.Identifier="identifier.sql",i.IdentifierQuote="identifier.quote.sql",i.Type="type.sql",i.Function="predefined.sql",i.Number="number.sql",i.String="string.sql",i.Variable="variable.sql",(o=t.X7||(t.X7={})).Unknown="unknown",o.SelectKeyword="selectKeyword",o.WithKeyword="withKeyword",o.AfterSelectKeyword="afterSelectKeyword",o.AfterSelectArguments="afterSelectArguments",o.AfterSelectFuncFirstArgument="afterSelectFuncFirstArgument",o.SelectAlias="selectAlias",o.AfterFromKeyword="afterFromKeyword",o.AfterTable="afterTable",o.SchemaFuncFirstArgument="schemaFuncFirstArgument",o.SchemaFuncExtraArgument="schemaFuncExtraArgument",o.FromKeyword="fromKeyword",o.AfterFrom="afterFrom",o.WhereKeyword="whereKeyword",o.WhereComparisonOperator="whereComparisonOperator",o.WhereValue="whereValue",o.AfterWhereFunctionArgument="afterWhereFunctionArgument",o.AfterGroupByFunctionArgument="afterGroupByFunctionArgument",o.AfterWhereValue="afterWhereValue",o.AfterGroupByKeywords="afterGroupByKeywords",o.AfterGroupBy="afterGroupBy",o.AfterOrderByKeywords="afterOrderByKeywords",o.AfterOrderByFunction="afterOrderByFunction",o.AfterOrderByDirection="afterOrderByDirection",o.AfterIsOperator="afterIsOperator",o.AfterIsNotOperator="afterIsNotOperator",o.AfterSchema="afterSchema",(l=t.ng||(t.ng={})).Schemas="schemas",l.Tables="tables",l.Columns="columns",l.SelectKeyword="selectKeyword",l.WithKeyword="withKeyword",l.FunctionsWithArguments="functionsWithArguments",l.FromKeyword="fromKeyword",l.WhereKeyword="whereKeyword",l.GroupByKeywords="groupByKeywords",l.OrderByKeywords="orderByKeywords",l.FunctionsWithoutArguments="functionsWithoutArguments",l.LimitKeyword="limitKeyword",l.SortOrderDirectionKeyword="sortOrderDirectionKeyword",l.ComparisonOperators="comparisonOperators",l.LogicalOperators="logicalOperators",l.SelectMacro="selectMacro",l.TableMacro="tableMacro",l.FilterMacro="filterMacro",l.GroupMacro="groupMacro",l.BoolValues="boolValues",l.NullValue="nullValue",l.NotKeyword="notKeyword",l.TemplateVariables="templateVariables",l.StarWildCard="starWildCard",(u=t.mY||(t.mY={})).High="a",u.MediumHigh="d",u.Medium="g",u.MediumLow="k",u.Low="q",(c=t.Io||(t.Io={}))[c.Method=0]="Method",c[c.Function=1]="Function",c[c.Constructor=2]="Constructor",c[c.Field=3]="Field",c[c.Variable=4]="Variable",c[c.Class=5]="Class",c[c.Struct=6]="Struct",c[c.Interface=7]="Interface",c[c.Module=8]="Module",c[c.Property=9]="Property",c[c.Event=10]="Event",c[c.Operator=11]="Operator",c[c.Unit=12]="Unit",c[c.Value=13]="Value",c[c.Constant=14]="Constant",c[c.Enum=15]="Enum",c[c.EnumMember=16]="EnumMember",c[c.Keyword=17]="Keyword",c[c.Text=18]="Text",c[c.Color=19]="Color",c[c.File=20]="File",c[c.Reference=21]="Reference",c[c.Customcolor=22]="Customcolor",c[c.Folder=23]="Folder",c[c.TypeParameter=24]="TypeParameter",c[c.User=25]="User",c[c.Issue=26]="Issue",c[c.Snippet=27]="Snippet",(p=t._E||(t._E={}))[p.KeepWhitespace=1]="KeepWhitespace",p[p.InsertAsSnippet=4]="InsertAsSnippet",(d=t.lX||(t.lX={})).Builder="builder",d.Code="code";!function(){function e(e,t,r,n,a){this.type=e,this.value=t,this.range=r,this.previous=n,this.next=a}e.prototype.isKeyword=function(){return this.type===t.ks.Keyword},e.prototype.isWhiteSpace=function(){return this.type===t.ks.Whitespace},e.prototype.isParenthesis=function(){return this.type===t.ks.Parenthesis},e.prototype.isIdentifier=function(){return this.type===t.ks.Identifier},e.prototype.isString=function(){return this.type===t.ks.String},e.prototype.isNumber=function(){return this.type===t.ks.Number},e.prototype.isDoubleQuotedString=function(){return this.type===t.ks.Type},e.prototype.isVariable=function(){return this.type===t.ks.Variable},e.prototype.isFunction=function(){return this.type===t.ks.Function},e.prototype.isOperator=function(){return this.type===t.ks.Operator},e.prototype.isTemplateVariable=function(){return this.type===t.ks.Variable},e.prototype.is=function(e,t){var r=this.type===e;return void 0!==t?r&&b(e,this,t):r},e.prototype.getPreviousNonWhiteSpaceToken=function(){for(var e=this.previous;null!=e;){if(!e.isWhiteSpace())return e;e=e.previous}return null},e.prototype.getPreviousOfType=function(e,t){for(var r=this.previous;null!=r;){var n=r.type===e;if(void 0!==t?n&&b(e,r,t):n)return r;r=r.previous}return null},e.prototype.getPreviousUntil=function(e,t,r){for(var n=[],a=this.previous;null!=a;)if(t.some((function(e){return e===(null==a?void 0:a.type)})))a=a.previous;else{var s=a.type===e;if(void 0!==r?s&&b(e,a,r):s)return n;a.isWhiteSpace()||n.push(a),a=a.previous}return n},e.prototype.getNextUntil=function(e,t,r){for(var n=[],a=this.next;null!=a;)if(t.some((function(e){return e===(null==a?void 0:a.type)})))a=a.next;else{var s=a.type===e;if(void 0!==r?s&&b(e,a,r):s)return n;a.isWhiteSpace()||n.push(a),a=a.next}return n},e.prototype.getPreviousKeyword=function(){for(var e=this.previous;null!=e;){if(e.isKeyword())return e;e=e.previous}return null},e.prototype.getNextNonWhiteSpaceToken=function(){for(var e=this.next;null!=e;){if(!e.isWhiteSpace())return e;e=e.next}return null},e.prototype.getNextOfType=function(e,t){for(var r=this.next;null!=r;){var n=r.type===e;if(void 0!==t?n&&b(e,r,t):n)return r;r=r.next}return null}}();function b(e,r,n){return e===t.ks.Keyword||e===t.ks.Operator?r.value.toLowerCase()===n.toString().toLowerCase():r.value===n}var E="select",O="from",w="by",S="desc",q="asc",T=["=","!="],I=v([],y(T),!1);Object.freeze({__proto__:null,SELECT:E,FROM:O,WHERE:"where",GROUP:"group",ORDER:"order",BY:w,DESC:S,ASC:q,LIMIT:"limit",WITH:"with",AS:"as",SCHEMA:"schema",AND:"AND",OR:"OR",LOGICAL_OPERATORS:["AND","OR"],EQUALS:"=",NOT_EQUALS:"!=",COMPARISON_OPERATORS:T,STD_OPERATORS:I,conf:{comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]},language:{defaultToken:"",tokenPostfix:".sql",ignoreCase:!0,brackets:[{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"}],keywords:["ABORT","ABSOLUTE","ACTION","ADA","ADD","AFTER","ALL","ALLOCATE","ALTER","ALWAYS","ANALYZE","AND","ANY","ARE","AS","ASC","ASSERTION","AT","ATTACH","AUTHORIZATION","AUTOINCREMENT","AVG","BACKUP","BEFORE","BEGIN","BETWEEN","BIT","BIT_LENGTH","BOTH","BREAK","BROWSE","BULK","BY","CASCADE","CASCADED","CASE","CAST","CATALOG","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","CHECK","CHECKPOINT","CLOSE","CLUSTERED","COALESCE","COLLATE","COLLATION","COLUMN","COMMIT","COMPUTE","CONFLICT","CONNECT","CONNECTION","CONSTRAINT","CONSTRAINTS","CONTAINS","CONTAINSTABLE","CONTINUE","CONVERT","CORRESPONDING","COUNT","CREATE","CROSS","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATE","DAY","DBCC","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DENY","DESC","DESCRIBE","DESCRIPTOR","DETACH","DIAGNOSTICS","DISCONNECT","DISK","DISTINCT","DISTRIBUTED","DO","DOMAIN","DOUBLE","DROP","DUMP","EACH","ELSE","END","END-EXEC","ERRLVL","ESCAPE","EXCEPT","EXCEPTION","EXCLUDE","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXIT","EXPLAIN","EXTERNAL","EXTRACT","FAIL","FALSE","FETCH","FILE","FILLFACTOR","FILTER","FIRST","FLOAT","FOLLOWING","FOR","FOREIGN","FORTRAN","FOUND","FREETEXT","FREETEXTTABLE","FROM","FULL","FUNCTION","GENERATED","GET","GLOB","GLOBAL","GO","GOTO","GRANT","GROUP","GROUPS","HAVING","HOLDLOCK","HOUR","IDENTITY","IDENTITYCOL","IDENTITY_INSERT","IF","IGNORE","IMMEDIATE","IN","INCLUDE","INDEX","INDEXED","INDICATOR","INITIALLY","INNER","INPUT","INSENSITIVE","INSERT","INSTEAD","INT","INTEGER","INTERSECT","INTERVAL","INTO","IS","ISNULL","ISOLATION","JOIN","KEY","KILL","LANGUAGE","LAST","LEADING","LEFT","LEVEL","LIKE","LIMIT","LINENO","LOAD","LOCAL","LOWER","MATCH","MATERIALIZED","MAX","MERGE","MIN","MINUTE","MODULE","MONTH","NAMES","NATIONAL","NATURAL","NCHAR","NEXT","NO","NOCHECK","NONCLUSTERED","NONE","NOT","NOTHING","NOTNULL","NULL","NULLIF","NULLS","NUMERIC","OCTET_LENGTH","OF","OFF","OFFSET","OFFSETS","ON","ONLY","OPEN","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","OPTION","OR","ORDER","OTHERS","OUTER","OUTPUT","OVER","OVERLAPS","PAD","PARTIAL","PARTITION","PASCAL","PERCENT","PIVOT","PLAN","POSITION","PRAGMA","PRECEDING","PRECISION","PREPARE","PRESERVE","PRIMARY","PRINT","PRIOR","PRIVILEGES","PROC","PROCEDURE","PUBLIC","QUERY","RAISE","RAISERROR","RANGE","READ","READTEXT","REAL","RECONFIGURE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELATIVE","RELEASE","RENAME","REPLACE","REPLICATION","RESTORE","RESTRICT","RETURN","RETURNING","REVERT","REVOKE","RIGHT","ROLLBACK","ROW","ROWCOUNT","ROWGUIDCOL","ROWS","RULE","SAVE","SAVEPOINT","SCHEMA","SCROLL","SECOND","SECTION","SECURITYAUDIT","SELECT","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","SESSION","SESSION_USER","SET","SETUSER","SHUTDOWN","SIZE","SMALLINT","SOME","SPACE","SQL","SQLCA","SQLCODE","SQLERROR","SQLSTATE","SQLWARNING","STATISTICS","SUBSTRING","SUM","SYSTEM_USER","TABLE","TABLESAMPLE","TEMP","TEMPORARY","TEXTSIZE","THEN","TIES","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TOP","TRAILING","TRAN","TRANSACTION","TRANSLATE","TRANSLATION","TRIGGER","TRIM","TRUE","TRUNCATE","TRY_CONVERT","TSEQUAL","UNBOUNDED","UNION","UNIQUE","UNKNOWN","UNPIVOT","UPDATE","UPDATETEXT","UPPER","USAGE","USE","USER","USING","VACUUM","VALUE","VALUES","VARCHAR","VARYING","VIEW","VIRTUAL","WAITFOR","WHEN","WHENEVER","WHERE","WHILE","WINDOW","WITH","WITHIN GROUP","WITHOUT","WORK","WRITE","WRITETEXT","YEAR","ZONE"],operators:["EXCEPT","INTERSECT","UNION","APPLY","CROSS","FULL","INNER","JOIN","LEFT","OUTER","RIGHT","CONTAINS","FREETEXT","IS","NULL","PIVOT","UNPIVOT","MATCHED"],logicalOperators:["ALL","AND","ANY","BETWEEN","EXISTS","IN","LIKE","NOT","OR","SOME"],comparisonOperators:["<>",">","<",">=","<=","=","!=","&","~","^","%"],builtinFunctions:["AVG","CHECKSUM_AGG","COUNT","COUNT_BIG","GROUPING","GROUPING_ID","MAX","MIN","SUM","STDEV","STDEVP","VAR","VARP","CUME_DIST","FIRST_VALUE","LAG","LAST_VALUE","LEAD","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","COLLATE","COLLATIONPROPERTY","TERTIARY_WEIGHTS","FEDERATION_FILTERING_VALUE","CAST","CONVERT","PARSE","TRY_CAST","TRY_CONVERT","TRY_PARSE","ASYMKEY_ID","ASYMKEYPROPERTY","CERTPROPERTY","CERT_ID","CRYPT_GEN_RANDOM","DECRYPTBYASYMKEY","DECRYPTBYCERT","DECRYPTBYKEY","DECRYPTBYKEYAUTOASYMKEY","DECRYPTBYKEYAUTOCERT","DECRYPTBYPASSPHRASE","ENCRYPTBYASYMKEY","ENCRYPTBYCERT","ENCRYPTBYKEY","ENCRYPTBYPASSPHRASE","HASHBYTES","IS_OBJECTSIGNED","KEY_GUID","KEY_ID","KEY_NAME","SIGNBYASYMKEY","SIGNBYCERT","SYMKEYPROPERTY","VERIFYSIGNEDBYCERT","VERIFYSIGNEDBYASYMKEY","CURSOR_STATUS","DATALENGTH","IDENT_CURRENT","IDENT_INCR","IDENT_SEED","IDENTITY","SQL_VARIANT_PROPERTY","CURRENT_TIMESTAMP","DATEADD","DATEDIFF","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","EOMONTH","GETDATE","GETUTCDATE","ISDATE","MONTH","SMALLDATETIMEFROMPARTS","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSUTCDATETIME","TIMEFROMPARTS","TODATETIMEOFFSET","YEAR","CHOOSE","COALESCE","IIF","NULLIF","ABS","ACOS","ASIN","ATAN","ATN2","CEILING","COS","COT","DEGREES","EXP","FLOOR","LOG","LOG10","PI","POWER","RADIANS","RAND","ROUND","SIGN","SIN","SQRT","SQUARE","TAN","APP_NAME","APPLOCK_MODE","APPLOCK_TEST","ASSEMBLYPROPERTY","COL_LENGTH","COL_NAME","COLUMNPROPERTY","DATABASE_PRINCIPAL_ID","DATABASEPROPERTYEX","DB_ID","DB_NAME","FILE_ID","FILE_IDEX","FILE_NAME","FILEGROUP_ID","FILEGROUP_NAME","FILEGROUPPROPERTY","FILEPROPERTY","FULLTEXTCATALOGPROPERTY","FULLTEXTSERVICEPROPERTY","INDEX_COL","INDEXKEY_PROPERTY","INDEXPROPERTY","OBJECT_DEFINITION","OBJECT_ID","OBJECT_NAME","OBJECT_SCHEMA_NAME","OBJECTPROPERTY","OBJECTPROPERTYEX","ORIGINAL_DB_NAME","PARSENAME","SCHEMA_ID","SCHEMA_NAME","SCOPE_IDENTITY","SERVERPROPERTY","STATS_DATE","TYPE_ID","TYPE_NAME","TYPEPROPERTY","DENSE_RANK","NTILE","RANK","ROW_NUMBER","PUBLISHINGSERVERNAME","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","CERTENCODED","CERTPRIVATEKEY","CURRENT_USER","HAS_DBACCESS","HAS_PERMS_BY_NAME","IS_MEMBER","IS_ROLEMEMBER","IS_SRVROLEMEMBER","LOGINPROPERTY","ORIGINAL_LOGIN","PERMISSIONS","PWDENCRYPT","PWDCOMPARE","SESSION_USER","SESSIONPROPERTY","SUSER_ID","SUSER_NAME","SUSER_SID","SUSER_SNAME","SYSTEM_USER","USER","USER_ID","USER_NAME","ASCII","CHAR","CHARINDEX","CONCAT","DIFFERENCE","FORMAT","LEFT","LEN","LOWER","LTRIM","NCHAR","PATINDEX","QUOTENAME","REPLACE","REPLICATE","REVERSE","RIGHT","RTRIM","SOUNDEX","SPACE","STR","STUFF","SUBSTRING","UNICODE","UPPER","BINARY_CHECKSUM","CHECKSUM","CONNECTIONPROPERTY","CONTEXT_INFO","CURRENT_REQUEST_ID","ERROR_LINE","ERROR_NUMBER","ERROR_MESSAGE","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","FORMATMESSAGE","GETANSINULL","GET_FILESTREAM_TRANSACTION_CONTEXT","HOST_ID","HOST_NAME","ISNULL","ISNUMERIC","MIN_ACTIVE_ROWVERSION","NEWID","NEWSEQUENTIALID","ROWCOUNT_BIG","XACT_STATE","TEXTPTR","TEXTVALID","COLUMNS_UPDATED","EVENTDATA","TRIGGER_NESTLEVEL","UPDATE","CHANGETABLE","CHANGE_TRACKING_CONTEXT","CHANGE_TRACKING_CURRENT_VERSION","CHANGE_TRACKING_IS_COLUMN_IN_MASK","CHANGE_TRACKING_MIN_VALID_VERSION","CONTAINSTABLE","FREETEXTTABLE","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","FILETABLEROOTPATH","GETFILENAMESPACEPATH","GETPATHLOCATOR","PATHNAME","GET_TRANSMISSION_STATUS"],builtinVariables:["@@DATEFIRST","@@DBTS","@@LANGID","@@LANGUAGE","@@LOCK_TIMEOUT","@@MAX_CONNECTIONS","@@MAX_PRECISION","@@NESTLEVEL","@@OPTIONS","@@REMSERVER","@@SERVERNAME","@@SERVICENAME","@@SPID","@@TEXTSIZE","@@VERSION","@@CURSOR_ROWS","@@FETCH_STATUS","@@DATEFIRST","@@PROCID","@@ERROR","@@IDENTITY","@@ROWCOUNT","@@TRANCOUNT","@@CONNECTIONS","@@CPU_BUSY","@@IDLE","@@IO_BUSY","@@PACKET_ERRORS","@@PACK_RECEIVED","@@PACK_SENT","@@TIMETICKS","@@TOTAL_ERRORS","@@TOTAL_READ","@@TOTAL_WRITE"],pseudoColumns:["$ACTION","$IDENTITY","$ROWGUID","$PARTITION"],tokenizer:{root:[{include:"@templateVariables"},{include:"@macros"},{include:"@comments"},{include:"@whitespace"},{include:"@pseudoColumns"},{include:"@numbers"},{include:"@strings"},{include:"@complexIdentifiers"},{include:"@scopes"},{include:"@schemaTable"},[/[;,.]/,"delimiter"],[/[()]/,"@brackets"],[/[\w@#$|<|>|=|!|%|&|+|\|-|*|/|~|^]+/,{cases:{"@operators":"operator","@comparisonOperators":"operator","@logicalOperators":"operator","@builtinVariables":"predefined","@builtinFunctions":"predefined","@keywords":"keyword","@default":"identifier"}}]],templateVariables:[[/\$[a-zA-Z0-9]+/,"variable"]],macros:[[/\$__[a-zA-Z0-9-_]+/,"type"]],schemaTable:[[/(\w+)\./,"identifier"],[/(\w+\.\w+)/,"identifier"]],whitespace:[[/\s+/,"white"]],comments:[[/--+.*/,"comment"],[/\/\*/,{token:"comment.quote",next:"@comment"}]],comment:[[/[^*/]+/,"comment"],[/\*\//,{token:"comment.quote",next:"@pop"}],[/./,"comment"]],pseudoColumns:[[/[$][A-Za-z_][\w@#$]*/,{cases:{"@pseudoColumns":"predefined","@default":"identifier"}}]],numbers:[[/0[xX][0-9a-fA-F]*/,"number"],[/[$][+-]*\d*(\.\d*)?/,"number"],[/((\d+(\.\d*)?)|(\.\d+))([eE][\-+]?\d+)?/,"number"]],strings:[[/N'/,{token:"string",next:"@string"}],[/'/,{token:"string",next:"@string"}]],string:[[/[^']+/,"string"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],complexIdentifiers:[[/\[/,{token:"identifier.quote",next:"@bracketedIdentifier"}],[/"/,{token:"identifier.quote",next:"@quotedIdentifier"}]],bracketedIdentifier:[[/[^\]]+/,"identifier"],[/]]/,"identifier"],[/]/,{token:"identifier.quote",next:"@pop"}]],quotedIdentifier:[[/[^"]+/,"identifier"],[/""/,"identifier"],[/"/,{token:"identifier.quote",next:"@pop"}]],scopes:[[/BEGIN\s+(DISTRIBUTED\s+)?TRAN(SACTION)?\b/i,"keyword"],[/BEGIN\s+TRY\b/i,{token:"keyword.try"}],[/END\s+TRY\b/i,{token:"keyword.try"}],[/BEGIN\s+CATCH\b/i,{token:"keyword.catch"}],[/END\s+CATCH\b/i,{token:"keyword.catch"}],[/(BEGIN|CASE)\b/i,{token:"keyword.block"}],[/END\b/i,{token:"keyword.block"}],[/WHEN\b/i,{token:"keyword.choice"}],[/THEN\b/i,{token:"keyword.choice"}]]}}}),new Uint8Array(16);for(var A=[],P=0;P<256;++P)A.push((P+256).toString(16).substr(1));var R={logger:function(){}};f.attachDebugger&&f.createLogger&&(R=f.createLogger("SQLEditor"),R.logger,f.attachDebugger("sqleditor",void 0,R));t.hh.Filter,t.hh.Filter,t.hh.Filter,t.hh.Value,t.hh.Table,t.hh.Column;new Map,new Map,Object.freeze({__proto__:null,singleLineFullQuery:{query:'SELECT column1, FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"keyword.sql",language:"sql"},{offset:20,type:"white.sql",language:"sql"},{offset:21,type:"identifier.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"keyword.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"identifier.sql",language:"sql"},{offset:41,type:"white.sql",language:"sql"},{offset:42,type:"operator.sql",language:"sql"},{offset:43,type:"white.sql",language:"sql"},{offset:44,type:"identifier.quote.sql",language:"sql"},{offset:45,type:"identifier.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"},{offset:53,type:"keyword.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"keyword.sql",language:"sql"},{offset:61,type:"white.sql",language:"sql"},{offset:62,type:"identifier.sql",language:"sql"},{offset:69,type:"white.sql",language:"sql"},{offset:70,type:"keyword.sql",language:"sql"},{offset:75,type:"white.sql",language:"sql"},{offset:76,type:"keyword.sql",language:"sql"},{offset:78,type:"white.sql",language:"sql"},{offset:79,type:"identifier.sql",language:"sql"},{offset:86,type:"white.sql",language:"sql"},{offset:87,type:"keyword.sql",language:"sql"},{offset:91,type:"white.sql",language:"sql"},{offset:92,type:"keyword.sql",language:"sql"},{offset:97,type:"white.sql",language:"sql"},{offset:98,type:"number.sql",language:"sql"},{offset:100,type:"delimiter.sql",language:"sql"}]]},singleLineFullQueryWithAggregation:{query:'SELECT count(column1), FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"identifier.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"keyword.sql",language:"sql"},{offset:40,type:"white.sql",language:"sql"},{offset:41,type:"identifier.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"operator.sql",language:"sql"},{offset:50,type:"white.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"identifier.sql",language:"sql"},{offset:58,type:"identifier.quote.sql",language:"sql"},{offset:59,type:"white.sql",language:"sql"},{offset:60,type:"keyword.sql",language:"sql"},{offset:65,type:"white.sql",language:"sql"},{offset:66,type:"keyword.sql",language:"sql"},{offset:68,type:"white.sql",language:"sql"},{offset:69,type:"identifier.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"keyword.sql",language:"sql"},{offset:82,type:"white.sql",language:"sql"},{offset:83,type:"keyword.sql",language:"sql"},{offset:85,type:"white.sql",language:"sql"},{offset:86,type:"identifier.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"keyword.sql",language:"sql"},{offset:98,type:"white.sql",language:"sql"},{offset:99,type:"keyword.sql",language:"sql"},{offset:104,type:"white.sql",language:"sql"},{offset:105,type:"number.sql",language:"sql"},{offset:107,type:"delimiter.sql",language:"sql"}]]},multiLineFullQuery:{query:'SELECT column1,  \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1 DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"keyword.sql",language:"sql"},{offset:38,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]},multiLineFullQueryWithAggregation:{query:'SELECT count(column1),  \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1 DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"keyword.sql",language:"sql"},{offset:38,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]},singleLineEmptyQuery:{query:"",tokens:[]},singleLineTwoQueries:{query:'SELECT column1, FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10; SELECT column2, FROM table2 WHERE column2 = "value2" GROUP BY column1 ORDER BY column2 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"keyword.sql",language:"sql"},{offset:20,type:"white.sql",language:"sql"},{offset:21,type:"identifier.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"keyword.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"identifier.sql",language:"sql"},{offset:41,type:"white.sql",language:"sql"},{offset:42,type:"operator.sql",language:"sql"},{offset:43,type:"white.sql",language:"sql"},{offset:44,type:"identifier.quote.sql",language:"sql"},{offset:45,type:"identifier.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"},{offset:53,type:"keyword.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"keyword.sql",language:"sql"},{offset:61,type:"white.sql",language:"sql"},{offset:62,type:"identifier.sql",language:"sql"},{offset:69,type:"white.sql",language:"sql"},{offset:70,type:"keyword.sql",language:"sql"},{offset:75,type:"white.sql",language:"sql"},{offset:76,type:"keyword.sql",language:"sql"},{offset:78,type:"white.sql",language:"sql"},{offset:79,type:"identifier.sql",language:"sql"},{offset:86,type:"white.sql",language:"sql"},{offset:87,type:"keyword.sql",language:"sql"},{offset:91,type:"white.sql",language:"sql"},{offset:92,type:"keyword.sql",language:"sql"},{offset:97,type:"white.sql",language:"sql"},{offset:98,type:"number.sql",language:"sql"},{offset:100,type:"delimiter.sql",language:"sql"},{offset:101,type:"white.sql",language:"sql"},{offset:102,type:"keyword.sql",language:"sql"},{offset:108,type:"white.sql",language:"sql"},{offset:109,type:"identifier.sql",language:"sql"},{offset:116,type:"delimiter.sql",language:"sql"},{offset:117,type:"white.sql",language:"sql"},{offset:118,type:"keyword.sql",language:"sql"},{offset:122,type:"white.sql",language:"sql"},{offset:123,type:"identifier.sql",language:"sql"},{offset:129,type:"white.sql",language:"sql"},{offset:130,type:"keyword.sql",language:"sql"},{offset:135,type:"white.sql",language:"sql"},{offset:136,type:"identifier.sql",language:"sql"},{offset:143,type:"white.sql",language:"sql"},{offset:144,type:"operator.sql",language:"sql"},{offset:145,type:"white.sql",language:"sql"},{offset:146,type:"identifier.quote.sql",language:"sql"},{offset:147,type:"identifier.sql",language:"sql"},{offset:153,type:"identifier.quote.sql",language:"sql"},{offset:154,type:"white.sql",language:"sql"},{offset:155,type:"keyword.sql",language:"sql"},{offset:160,type:"white.sql",language:"sql"},{offset:161,type:"keyword.sql",language:"sql"},{offset:163,type:"white.sql",language:"sql"},{offset:164,type:"identifier.sql",language:"sql"},{offset:171,type:"white.sql",language:"sql"},{offset:172,type:"keyword.sql",language:"sql"},{offset:177,type:"white.sql",language:"sql"},{offset:178,type:"keyword.sql",language:"sql"},{offset:180,type:"white.sql",language:"sql"},{offset:181,type:"identifier.sql",language:"sql"},{offset:188,type:"white.sql",language:"sql"},{offset:189,type:"keyword.sql",language:"sql"},{offset:193,type:"white.sql",language:"sql"},{offset:194,type:"keyword.sql",language:"sql"},{offset:199,type:"white.sql",language:"sql"},{offset:200,type:"number.sql",language:"sql"},{offset:202,type:"delimiter.sql",language:"sql"}]]},singleLineTwoQueriesWithAggregation:{query:'SELECT count(column1), FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10; SELECT count(column2), FROM table2 WHERE column2 = "value2" GROUP BY column1 ORDER BY column2 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"identifier.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"keyword.sql",language:"sql"},{offset:40,type:"white.sql",language:"sql"},{offset:41,type:"identifier.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"operator.sql",language:"sql"},{offset:50,type:"white.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"identifier.sql",language:"sql"},{offset:58,type:"identifier.quote.sql",language:"sql"},{offset:59,type:"white.sql",language:"sql"},{offset:60,type:"keyword.sql",language:"sql"},{offset:65,type:"white.sql",language:"sql"},{offset:66,type:"keyword.sql",language:"sql"},{offset:68,type:"white.sql",language:"sql"},{offset:69,type:"identifier.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"keyword.sql",language:"sql"},{offset:82,type:"white.sql",language:"sql"},{offset:83,type:"keyword.sql",language:"sql"},{offset:85,type:"white.sql",language:"sql"},{offset:86,type:"identifier.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"keyword.sql",language:"sql"},{offset:98,type:"white.sql",language:"sql"},{offset:99,type:"keyword.sql",language:"sql"},{offset:104,type:"white.sql",language:"sql"},{offset:105,type:"number.sql",language:"sql"},{offset:107,type:"delimiter.sql",language:"sql"},{offset:108,type:"white.sql",language:"sql"},{offset:109,type:"keyword.sql",language:"sql"},{offset:115,type:"white.sql",language:"sql"},{offset:116,type:"predefined.sql",language:"sql"},{offset:121,type:"delimiter.parenthesis.sql",language:"sql"},{offset:122,type:"identifier.sql",language:"sql"},{offset:129,type:"delimiter.parenthesis.sql",language:"sql"},{offset:130,type:"delimiter.sql",language:"sql"},{offset:131,type:"white.sql",language:"sql"},{offset:132,type:"keyword.sql",language:"sql"},{offset:136,type:"white.sql",language:"sql"},{offset:137,type:"identifier.sql",language:"sql"},{offset:143,type:"white.sql",language:"sql"},{offset:144,type:"keyword.sql",language:"sql"},{offset:149,type:"white.sql",language:"sql"},{offset:150,type:"identifier.sql",language:"sql"},{offset:157,type:"white.sql",language:"sql"},{offset:158,type:"operator.sql",language:"sql"},{offset:159,type:"white.sql",language:"sql"},{offset:160,type:"identifier.quote.sql",language:"sql"},{offset:161,type:"identifier.sql",language:"sql"},{offset:167,type:"identifier.quote.sql",language:"sql"},{offset:168,type:"white.sql",language:"sql"},{offset:169,type:"keyword.sql",language:"sql"},{offset:174,type:"white.sql",language:"sql"},{offset:175,type:"keyword.sql",language:"sql"},{offset:177,type:"white.sql",language:"sql"},{offset:178,type:"identifier.sql",language:"sql"},{offset:185,type:"white.sql",language:"sql"},{offset:186,type:"keyword.sql",language:"sql"},{offset:191,type:"white.sql",language:"sql"},{offset:192,type:"keyword.sql",language:"sql"},{offset:194,type:"white.sql",language:"sql"},{offset:195,type:"identifier.sql",language:"sql"},{offset:202,type:"white.sql",language:"sql"},{offset:203,type:"keyword.sql",language:"sql"},{offset:207,type:"white.sql",language:"sql"},{offset:208,type:"keyword.sql",language:"sql"},{offset:213,type:"white.sql",language:"sql"},{offset:214,type:"number.sql",language:"sql"},{offset:216,type:"delimiter.sql",language:"sql"}]]},singleLineMultipleColumns:{query:'SELECT count(column1), column2 FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1, avg(column2) DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"identifier.sql",language:"sql"},{offset:30,type:"white.sql",language:"sql"},{offset:31,type:"keyword.sql",language:"sql"},{offset:35,type:"white.sql",language:"sql"},{offset:36,type:"identifier.sql",language:"sql"},{offset:42,type:"white.sql",language:"sql"},{offset:43,type:"keyword.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"identifier.sql",language:"sql"},{offset:56,type:"white.sql",language:"sql"},{offset:57,type:"operator.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"identifier.quote.sql",language:"sql"},{offset:60,type:"identifier.sql",language:"sql"},{offset:66,type:"identifier.quote.sql",language:"sql"},{offset:67,type:"white.sql",language:"sql"},{offset:68,type:"keyword.sql",language:"sql"},{offset:73,type:"white.sql",language:"sql"},{offset:74,type:"keyword.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"identifier.sql",language:"sql"},{offset:84,type:"white.sql",language:"sql"},{offset:85,type:"keyword.sql",language:"sql"},{offset:90,type:"white.sql",language:"sql"},{offset:91,type:"keyword.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"identifier.sql",language:"sql"},{offset:101,type:"delimiter.sql",language:"sql"},{offset:102,type:"white.sql",language:"sql"},{offset:103,type:"predefined.sql",language:"sql"},{offset:106,type:"delimiter.parenthesis.sql",language:"sql"},{offset:107,type:"identifier.sql",language:"sql"},{offset:114,type:"delimiter.parenthesis.sql",language:"sql"},{offset:115,type:"white.sql",language:"sql"},{offset:116,type:"keyword.sql",language:"sql"},{offset:120,type:"white.sql",language:"sql"},{offset:121,type:"keyword.sql",language:"sql"},{offset:126,type:"white.sql",language:"sql"},{offset:127,type:"number.sql",language:"sql"},{offset:129,type:"delimiter.sql",language:"sql"}]]},multiLineMultipleColumns:{query:'SELECT count(column1), column2 \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1, avg(column2) DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"identifier.sql",language:"sql"},{offset:30,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"delimiter.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"predefined.sql",language:"sql"},{offset:38,type:"delimiter.parenthesis.sql",language:"sql"},{offset:39,type:"identifier.sql",language:"sql"},{offset:46,type:"delimiter.parenthesis.sql",language:"sql"},{offset:47,type:"white.sql",language:"sql"},{offset:48,type:"keyword.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]}});var N=function(e){var t=e.children,r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(e,["children"]),n=f.useStyles2(g.useCallback((function(e){return _(e,r)}),[r]));return h.createElement("div",{className:n.root},t)},_=function(e,t){var r,n,a;return{root:m.css({display:"flex",flexDirection:null!==(r=t.direction)&&void 0!==r?r:"row",flexWrap:null===(n=t.wrap)||void 0===n||n?"wrap":void 0,alignItems:t.alignItems,gap:e.spacing(null!==(a=t.gap)&&void 0!==a?a:2),flexGrow:t.flexGrow})}};h.forwardRef((function(e,t){var r=e.items,n=e.renderItem,a=e.onChange;return h.createElement(N,null,r.map((function(e,t){return h.createElement("div",{key:t},n(e,(function(e){return function(e,t){var n=v([],y(r),!1);n[e]=t,a(n)}(t,e)}),(function(){return e=t,(n=v([],y(r),!1)).splice(e,1),void a(n);var e,n})))})),h.createElement(f.Button,{ref:t,onClick:function(){var e=v(v([],y(r),!1),[{}],!1);a(e)},variant:"secondary",size:"md",icon:"plus","aria-label":"Add",type:"button"}))}))},4660:(e,t,r)=>{"use strict";r(9868)},5689:(e,t,r)=>{"use strict";const n=r(9691),a=Symbol("max"),s=Symbol("length"),i=Symbol("lengthCalculator"),o=Symbol("allowStale"),l=Symbol("maxAge"),u=Symbol("dispose"),c=Symbol("noDisposeOnSet"),p=Symbol("lruList"),d=Symbol("cache"),f=Symbol("updateAgeOnGet"),g=()=>1,h=(e,t,r)=>{const n=e[d].get(t);if(n){const t=n.value;if(m(e,t)){if(v(e,n),!e[o])return}else r&&(e[f]&&(n.value.now=Date.now()),e[p].unshiftNode(n));return t.value}},m=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[l]&&r>e[l]},y=e=>{if(e[s]>e[a])for(let t=e[p].tail;e[s]>e[a]&&null!==t;){const r=t.prev;v(e,t),t=r}},v=(e,t)=>{if(t){const r=t.value;e[u]&&e[u](r.key,r.value),e[s]-=r.length,e[d].delete(r.key),e[p].removeNode(t)}};class b{constructor(e,t,r,n,a){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=a||0}}const E=(e,t,r,n)=>{let a=r.value;m(e,a)&&(v(e,r),e[o]||(a=void 0)),a&&t.call(n,a.value,a.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[a]=e.max||1/0;const t=e.length||g;if(this[i]="function"!=typeof t?g:t,this[o]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[u]=e.dispose,this[c]=e.noDisposeOnSet||!1,this[f]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[a]=e||1/0,y(this)}get max(){return this[a]}set allowStale(e){this[o]=!!e}get allowStale(){return this[o]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,y(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=g),e!==this[i]&&(this[i]=e,this[s]=0,this[p].forEach((e=>{e.length=this[i](e.value,e.key),this[s]+=e.length}))),y(this)}get lengthCalculator(){return this[i]}get length(){return this[s]}get itemCount(){return this[p].length}rforEach(e,t){t=t||this;for(let r=this[p].tail;null!==r;){const n=r.prev;E(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[p].head;null!==r;){const n=r.next;E(this,e,r,t),r=n}}keys(){return this[p].toArray().map((e=>e.key))}values(){return this[p].toArray().map((e=>e.value))}reset(){this[u]&&this[p]&&this[p].length&&this[p].forEach((e=>this[u](e.key,e.value))),this[d]=new Map,this[p]=new n,this[s]=0}dump(){return this[p].map((e=>!m(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[p]}set(e,t,r){if((r=r||this[l])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,o=this[i](t,e);if(this[d].has(e)){if(o>this[a])return v(this,this[d].get(e)),!1;const i=this[d].get(e).value;return this[u]&&(this[c]||this[u](e,i.value)),i.now=n,i.maxAge=r,i.value=t,this[s]+=o-i.length,i.length=o,this.get(e),y(this),!0}const f=new b(e,t,o,n,r);return f.length>this[a]?(this[u]&&this[u](e,t),!1):(this[s]+=f.length,this[p].unshift(f),this[d].set(e,this[p].head),y(this),!0)}has(e){if(!this[d].has(e))return!1;const t=this[d].get(e).value;return!m(this,t)}get(e){return h(this,e,!0)}peek(e){return h(this,e,!1)}pop(){const e=this[p].tail;return e?(v(this,e),e.value):null}del(e){v(this,this[d].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],a=n.e||0;if(0===a)this.set(n.k,n.v);else{const e=a-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[d].forEach(((e,t)=>h(this,t,!1)))}}},5803:(e,t)=>{function r(e){return"\\"+e}function n(e,t){return t}t.escape=function(e){return e.replace(/[\+\-\!\(\)\{\}\[\]\^\"\?\:\\\&\|\'\/\s\*\~]/g,r)},t.unescape=function(e){return e.replace(/\\([\+\-\!\(\)\{\}\[\]\^\"\?\:\\\&\|\'\/\s\*\~])/g,n)},t.escapePhrase=function(e){return e.replace(/"/g,r)},t.unescapePhrase=function(e){return e.replace(/\\(")/g,n)}},4421:(e,t,r)=>{"use strict";var n=r(7632),a=r(5803);t.parse=n.parse.bind(n),t.toString=r(6251),t.term={escape:a.escape,unescape:a.unescape},t.phrase={escape:a.escapePhrase,unescape:a.unescapePhrase}},7632:e=>{"use strict";function t(e,r,n,a){this.message=e,this.expected=r,this.found=n,this.location=a,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}!function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(t,Error),t.buildMessage=function(e,t){var r={literal:function(e){return'"'+a(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?s(e.parts[t][0])+"-"+s(e.parts[t][1]):s(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function a(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,a,s=new Array(e.length);for(t=0;t<e.length;t++)s[t]=(a=e[t],r[a.type](a));if(s.sort(),s.length>0){for(t=1,n=1;t<s.length;t++)s[t-1]!==s[t]&&(s[n]=s[t],n++);s.length=n}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(e)+" but "+function(e){return e?'"'+a(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:t,parse:function(e,r){r=void 0!==r?r:{};var n,a={},s={start:mt},i=mt,o=function(e){return e[0]},l=function(){return{}},u=function(e){return{operator:e}},c=function(e,t,r,n){var a={start:e,left:t};return null!=(n=0==n.length?null:null==n[0].right?n[0].left:n[0])&&(a.operator=""==r?"<implicit>":r[0],a.right=n),a},p=function(e,t){return t},d=function(e,t,r){var n={left:e};return null!=(r=0==r.length?null:null==r[0].right?r[0].left:r[0])&&(n.operator=""==t?"<implicit>":t[0],n.right=r),n},f=function(e){return e},g="(",h=pt("(",!1),m=")",y=pt(")",!1),v=function(e){return e[0].parenthesized=!0,e[0]},b=function(e,t){return t.field=null==e||""==e.label?"<implicit>":e.label,t.fieldLocation=null==e||""==e.label?null:e.location,t},E=function(e,t){return t.field=e.label,t.fieldLocation=e.location,t},O=function(e,t){var r={field:null==e||""==e.label?"<implicit>":e.label,fieldLocation:null==e||""==e.label?null:e.location};for(var n in t)r[n]=t[n];return r},w=/^[:]/,S=dt([":"],!1,!1),q=function(e){return{label:e.label,location:e.location}},T=function(e,t,r,n){var a={term:t,quoted:!0,regex:!1,termLocation:ct()};return""!=r&&(a.proximity=r),""!=n&&(a.boost=n),""!=e&&(a.prefix=e),a},I=function(e,t){return{term:t,quoted:!1,regex:!0,termLocation:ct()}},A=function(e,t,r,n){var a={term:t.label,quoted:!1,regex:!1,termLocation:ct()};return""!=r&&(a.similarity=r),""!=n&&(a.boost=n),""!=e&&(a.prefix=e),a},P="\\",R=pt("\\",!1),N=function(e){return"\\"+e},_=".",D=pt(".",!1),C=/^[^ \t\r\n\f{}()"\/\^~[\]]/,L=dt([" ","\t","\r","\n","\f","{","}","(",")",'"',"/","^","~","[","]"],!0,!1),j=function(e){return e.join("")},k=function(e){return{label:e.join(""),location:ct()}},x=/^[^: \t\r\n\f{}()"\/\^~[\]]/,F=dt([":"," ","\t","\r","\n","\f","{","}","(",")",'"',"/","^","~","[","]"],!0,!1),M='"',$=pt('"',!1),V=function(e){return e.join("")},U="/",B=pt("/",!1),G=function(e){return e.join("")},Y={type:"any"},W=function(e){return e},H="+",Q=pt("+",!1),K="-",z=pt("-",!1),X="!",J=pt("!",!1),Z="{",ee=pt("{",!1),te="}",re=pt("}",!1),ne="[",ae=pt("[",!1),se="]",ie=pt("]",!1),oe="^",le=pt("^",!1),ue="?",ce=pt("?",!1),pe=":",de=pt(":",!1),fe="&",ge=pt("&",!1),he="|",me=pt("|",!1),ye="'",ve=pt("'",!1),be="~",Ee=pt("~",!1),Oe="*",we=pt("*",!1),Se=" ",qe=pt(" ",!1),Te=function(e){return e},Ie=function(e){return e},Ae=function(e){return""==e||null==e?.5:e},Pe="0.",Re=pt("0.",!1),Ne=/^[0-9]/,_e=dt([["0","9"]],!1,!1),De=function(e){return parseFloat("0."+e.join(""))},Ce=function(e){return parseInt(e.join(""))},Le="TO",je=pt("TO",!1),ke=function(e,t){return{term_min:e,term_max:t,inclusive:"both"}},xe=function(e,t){return{term_min:e,term_max:t,inclusive:"none"}},Fe=function(e,t){return{term_min:e,term_max:t,inclusive:"left"}},Me=function(e,t){return{term_min:e,term_max:t,inclusive:"right"}},$e=function(e){return e},Ve="OR NOT",Ue=pt("OR NOT",!1),Be="AND NOT",Ge=pt("AND NOT",!1),Ye="OR",We=pt("OR",!1),He="AND",Qe=pt("AND",!1),Ke="NOT",ze=pt("NOT",!1),Xe="||",Je=pt("||",!1),Ze="&&",et=pt("&&",!1),tt={type:"other",description:"whitespace"},rt=/^[ \t\r\n\f]/,nt=dt([" ","\t","\r","\n","\f"],!1,!1),at=0,st=0,it=[{line:1,column:1}],ot=0,lt=[],ut=0;if("startRule"in r){if(!(r.startRule in s))throw new Error("Can't start parsing from rule \""+r.startRule+'".');i=s[r.startRule]}function ct(){return gt(st,at)}function pt(e,t){return{type:"literal",text:e,ignoreCase:t}}function dt(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function ft(t){var r,n=it[t];if(n)return n;for(r=t-1;!it[r];)r--;for(n={line:(n=it[r]).line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return it[t]=n,n}function gt(e,t){var r=ft(e),n=ft(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function ht(e){at<ot||(at>ot&&(ot=at,lt=[]),lt.push(e))}function mt(){var e,t,r,n;for(e=at,t=[],r=Lt();r!==a;)t.push(r),r=Lt();if(t!==a){if(r=[],(n=yt())!==a)for(;n!==a;)r.push(n),n=yt();else r=a;r!==a?(st=e,e=t=o(r)):(at=e,e=a)}else at=e,e=a;if(e===a){for(e=at,t=[],r=Lt();r!==a;)t.push(r),r=Lt();t!==a&&(st=e,t=l()),(e=t)===a&&(e=at,(t=jt())!==a&&(st=e,t=l()),e=t)}return e}function yt(){var e,t,r,n,s,i;if(e=at,(t=_t())!==a&&(r=jt())!==a?(st=e,e=t=u(t)):(at=e,e=a),e===a){if(e=at,(t=_t())!==a)if((r=vt())!==a){for(n=[],s=_t();s!==a;)n.push(s),s=_t();if(n!==a){for(s=[],i=yt();i!==a;)s.push(i),i=yt();s!==a?(st=e,e=t=c(t,r,n,s)):(at=e,e=a)}else at=e,e=a}else at=e,e=a;else at=e,e=a;if(e===a&&(e=at,(t=_t())!==a&&(r=yt())!==a?(st=e,e=t=p(t,r)):(at=e,e=a),e===a))if(e=at,(t=vt())!==a){for(r=[],n=_t();n!==a;)r.push(n),n=_t();if(r!==a){for(n=[],s=yt();s!==a;)n.push(s),s=yt();n!==a?(st=e,e=t=d(t,r,n)):(at=e,e=a)}else at=e,e=a}else at=e,e=a}return e}function vt(){var t,r,n,s;if(t=at,r=function(){var t,r,n;return t=at,(r=Et())===a&&(r=null),r!==a?(n=function(){var t,r,n,s,i,o,l,u;if(t=at,91===e.charCodeAt(at)?(r=ne,at++):(r=a,0===ut&&ht(ae)),r!==a)if((n=wt())!==a){for(s=[],i=Lt();i!==a;)s.push(i),i=Lt();if(s!==a)if(e.substr(at,2)===Le?(i=Le,at+=2):(i=a,0===ut&&ht(je)),i!==a){if(o=[],(l=Lt())!==a)for(;l!==a;)o.push(l),l=Lt();else o=a;o!==a&&(l=wt())!==a?(93===e.charCodeAt(at)?(u=se,at++):(u=a,0===ut&&ht(ie)),u!==a?(st=t,t=r=ke(n,l)):(at=t,t=a)):(at=t,t=a)}else at=t,t=a;else at=t,t=a}else at=t,t=a;else at=t,t=a;if(t===a){if(t=at,123===e.charCodeAt(at)?(r=Z,at++):(r=a,0===ut&&ht(ee)),r!==a)if((n=wt())!==a){for(s=[],i=Lt();i!==a;)s.push(i),i=Lt();if(s!==a)if(e.substr(at,2)===Le?(i=Le,at+=2):(i=a,0===ut&&ht(je)),i!==a){if(o=[],(l=Lt())!==a)for(;l!==a;)o.push(l),l=Lt();else o=a;o!==a&&(l=wt())!==a?(125===e.charCodeAt(at)?(u=te,at++):(u=a,0===ut&&ht(re)),u!==a?(st=t,t=r=xe(n,l)):(at=t,t=a)):(at=t,t=a)}else at=t,t=a;else at=t,t=a}else at=t,t=a;else at=t,t=a;if(t===a){if(t=at,91===e.charCodeAt(at)?(r=ne,at++):(r=a,0===ut&&ht(ae)),r!==a)if((n=wt())!==a){for(s=[],i=Lt();i!==a;)s.push(i),i=Lt();if(s!==a)if(e.substr(at,2)===Le?(i=Le,at+=2):(i=a,0===ut&&ht(je)),i!==a){if(o=[],(l=Lt())!==a)for(;l!==a;)o.push(l),l=Lt();else o=a;o!==a&&(l=wt())!==a?(125===e.charCodeAt(at)?(u=te,at++):(u=a,0===ut&&ht(re)),u!==a?(st=t,t=r=Fe(n,l)):(at=t,t=a)):(at=t,t=a)}else at=t,t=a;else at=t,t=a}else at=t,t=a;else at=t,t=a;if(t===a)if(t=at,123===e.charCodeAt(at)?(r=Z,at++):(r=a,0===ut&&ht(ee)),r!==a)if((n=wt())!==a){for(s=[],i=Lt();i!==a;)s.push(i),i=Lt();if(s!==a)if(e.substr(at,2)===Le?(i=Le,at+=2):(i=a,0===ut&&ht(je)),i!==a){if(o=[],(l=Lt())!==a)for(;l!==a;)o.push(l),l=Lt();else o=a;o!==a&&(l=wt())!==a?(93===e.charCodeAt(at)?(u=se,at++):(u=a,0===ut&&ht(ie)),u!==a?(st=t,t=r=Me(n,l)):(at=t,t=a)):(at=t,t=a)}else at=t,t=a;else at=t,t=a}else at=t,t=a;else at=t,t=a}}return t}(),n!==a?(st=t,t=r=b(r,n)):(at=t,t=a)):(at=t,t=a),t===a&&(t=at,(r=Et())!==a&&(n=bt())!==a?(st=t,t=r=E(r,n)):(at=t,t=a),t===a&&(t=at,(r=Et())===a&&(r=null),r!==a?(n=function(){var t,r,n,s,i,o,l;if(t=at,(r=Ct())===a&&(r=null),r!==a)if(n=function(){var t,r,n,s;if(t=at,34===e.charCodeAt(at)?(r=M,at++):(r=a,0===ut&&ht($)),r!==a){for(n=[],s=Tt();s!==a;)n.push(s),s=Tt();n!==a?(34===e.charCodeAt(at)?(s=M,at++):(s=a,0===ut&&ht($)),s!==a?(st=t,t=r=V(n)):(at=t,t=a)):(at=t,t=a)}else at=t,t=a;return t}(),n!==a)if(s=function(){var t,r,n;return t=at,126===e.charCodeAt(at)?(r=be,at++):(r=a,0===ut&&ht(Ee)),r!==a&&(n=Nt())!==a?(st=t,t=r=Te(n)):(at=t,t=a),t}(),s===a&&(s=null),s!==a)if((i=Pt())===a&&(i=null),i!==a){for(o=[],l=Lt();l!==a;)o.push(l),l=Lt();o!==a?(st=t,t=r=T(r,n,s,i)):(at=t,t=a)}else at=t,t=a;else at=t,t=a;else at=t,t=a;else at=t,t=a;if(t===a){if(t=at,(r=Ct())===a&&(r=null),r!==a)if(n=function(){var t,r,n,s;if(t=at,47===e.charCodeAt(at)?(r=U,at++):(r=a,0===ut&&ht(B)),r!==a){if(n=[],(s=It())!==a)for(;s!==a;)n.push(s),s=It();else n=a;n!==a?(47===e.charCodeAt(at)?(s=U,at++):(s=a,0===ut&&ht(B)),s!==a?(st=t,t=r=G(n)):(at=t,t=a)):(at=t,t=a)}else at=t,t=a;return t}(),n!==a){for(s=[],i=Lt();i!==a;)s.push(i),i=Lt();s!==a?(st=t,t=r=I(r,n)):(at=t,t=a)}else at=t,t=a;else at=t,t=a;if(t===a)if(t=at,(r=Ct())===a&&(r=null),r!==a)if((n=St())!==a)if(s=function(){var t,r,n;return t=at,126===e.charCodeAt(at)?(r=be,at++):(r=a,0===ut&&ht(Ee)),r!==a?((n=Rt())===a&&(n=null),n!==a?(st=t,t=r=Ae(n)):(at=t,t=a)):(at=t,t=a),t}(),s===a&&(s=null),s!==a)if((i=Pt())===a&&(i=null),i!==a){for(o=[],l=Lt();l!==a;)o.push(l),l=Lt();o!==a?(st=t,t=r=A(r,n,s,i)):(at=t,t=a)}else at=t,t=a;else at=t,t=a;else at=t,t=a;else at=t,t=a}return t}(),n!==a?(st=t,t=r=O(r,n)):(at=t,t=a)):(at=t,t=a))),t}(),r!==a){for(n=[],s=Lt();s!==a;)n.push(s),s=Lt();n!==a?(st=t,t=r=f(r)):(at=t,t=a)}else at=t,t=a;return t===a&&(t=bt()),t}function bt(){var t,r,n,s,i,o,l;if(t=at,40===e.charCodeAt(at)?(r=g,at++):(r=a,0===ut&&ht(h)),r!==a){for(n=[],s=Lt();s!==a;)n.push(s),s=Lt();if(n!==a){if(s=[],(i=yt())!==a)for(;i!==a;)s.push(i),i=yt();else s=a;if(s!==a)if(41===e.charCodeAt(at)?(i=m,at++):(i=a,0===ut&&ht(y)),i!==a){for(o=[],l=Lt();l!==a;)o.push(l),l=Lt();o!==a?(st=t,t=r=v(s)):(at=t,t=a)}else at=t,t=a;else at=t,t=a}else at=t,t=a}else at=t,t=a;return t}function Et(){var t,r,n,s,i;if(t=at,(r=St())!==a)if(w.test(e.charAt(at))?(n=e.charAt(at),at++):(n=a,0===ut&&ht(S)),n!==a){for(s=[],i=Lt();i!==a;)s.push(i),i=Lt();s!==a?(st=t,t=r=q(r)):(at=t,t=a)}else at=t,t=a;else at=t,t=a;return t}function Ot(){var t,r,n;return t=at,92===e.charCodeAt(at)?(r=P,at++):(r=a,0===ut&&ht(R)),r!==a&&(n=At())!==a?(st=t,t=r=N(n)):(at=t,t=a),t===a&&(46===e.charCodeAt(at)?(t=_,at++):(t=a,0===ut&&ht(D)),t===a&&(C.test(e.charAt(at))?(t=e.charAt(at),at++):(t=a,0===ut&&ht(L)))),t}function wt(){var e,t,r;if(e=at,t=[],(r=Ot())!==a)for(;r!==a;)t.push(r),r=Ot();else t=a;return t!==a&&(st=e,t=j(t)),t}function St(){var e,t,r;if(e=at,t=[],(r=qt())!==a)for(;r!==a;)t.push(r),r=qt();else t=a;return t!==a&&(st=e,t=k(t)),t}function qt(){var t,r,n;return t=at,92===e.charCodeAt(at)?(r=P,at++):(r=a,0===ut&&ht(R)),r!==a&&(n=At())!==a?(st=t,t=r=N(n)):(at=t,t=a),t===a&&(46===e.charCodeAt(at)?(t=_,at++):(t=a,0===ut&&ht(D)),t===a&&(x.test(e.charAt(at))?(t=e.charAt(at),at++):(t=a,0===ut&&ht(F)))),t}function Tt(){var t,r,n;return t=at,r=at,ut++,34===e.charCodeAt(at)?(n=M,at++):(n=a,0===ut&&ht($)),n===a&&(92===e.charCodeAt(at)?(n=P,at++):(n=a,0===ut&&ht(R))),ut--,n===a?r=void 0:(at=r,r=a),r!==a?(e.length>at?(n=e.charAt(at),at++):(n=a,0===ut&&ht(Y)),n!==a?(st=t,t=r=W(n)):(at=t,t=a)):(at=t,t=a),t===a&&(t=at,92===e.charCodeAt(at)?(r=P,at++):(r=a,0===ut&&ht(R)),r!==a&&(n=At())!==a?(st=t,t=r=N(n)):(at=t,t=a)),t}function It(){var t,r,n;return t=at,r=at,ut++,47===e.charCodeAt(at)?(n=U,at++):(n=a,0===ut&&ht(B)),n===a&&(92===e.charCodeAt(at)?(n=P,at++):(n=a,0===ut&&ht(R))),ut--,n===a?r=void 0:(at=r,r=a),r!==a?(e.length>at?(n=e.charAt(at),at++):(n=a,0===ut&&ht(Y)),n!==a?(st=t,t=r=W(n)):(at=t,t=a)):(at=t,t=a),t===a&&(t=at,92===e.charCodeAt(at)?(r=P,at++):(r=a,0===ut&&ht(R)),r!==a&&(n=At())!==a?(st=t,t=r=N(n)):(at=t,t=a)),t}function At(){var t;return 43===e.charCodeAt(at)?(t=H,at++):(t=a,0===ut&&ht(Q)),t===a&&(45===e.charCodeAt(at)?(t=K,at++):(t=a,0===ut&&ht(z)),t===a&&(33===e.charCodeAt(at)?(t=X,at++):(t=a,0===ut&&ht(J)),t===a&&(40===e.charCodeAt(at)?(t=g,at++):(t=a,0===ut&&ht(h)),t===a&&(41===e.charCodeAt(at)?(t=m,at++):(t=a,0===ut&&ht(y)),t===a&&(123===e.charCodeAt(at)?(t=Z,at++):(t=a,0===ut&&ht(ee)),t===a&&(125===e.charCodeAt(at)?(t=te,at++):(t=a,0===ut&&ht(re)),t===a&&(91===e.charCodeAt(at)?(t=ne,at++):(t=a,0===ut&&ht(ae)),t===a&&(93===e.charCodeAt(at)?(t=se,at++):(t=a,0===ut&&ht(ie)),t===a&&(94===e.charCodeAt(at)?(t=oe,at++):(t=a,0===ut&&ht(le)),t===a&&(34===e.charCodeAt(at)?(t=M,at++):(t=a,0===ut&&ht($)),t===a&&(63===e.charCodeAt(at)?(t=ue,at++):(t=a,0===ut&&ht(ce)),t===a&&(58===e.charCodeAt(at)?(t=pe,at++):(t=a,0===ut&&ht(de)),t===a&&(92===e.charCodeAt(at)?(t=P,at++):(t=a,0===ut&&ht(R)),t===a&&(38===e.charCodeAt(at)?(t=fe,at++):(t=a,0===ut&&ht(ge)),t===a&&(124===e.charCodeAt(at)?(t=he,at++):(t=a,0===ut&&ht(me)),t===a&&(39===e.charCodeAt(at)?(t=ye,at++):(t=a,0===ut&&ht(ve)),t===a&&(47===e.charCodeAt(at)?(t=U,at++):(t=a,0===ut&&ht(B)),t===a&&(126===e.charCodeAt(at)?(t=be,at++):(t=a,0===ut&&ht(Ee)),t===a&&(42===e.charCodeAt(at)?(t=Oe,at++):(t=a,0===ut&&ht(we)),t===a&&(32===e.charCodeAt(at)?(t=Se,at++):(t=a,0===ut&&ht(qe)))))))))))))))))))))),t}function Pt(){var t,r,n;return t=at,94===e.charCodeAt(at)?(r=oe,at++):(r=a,0===ut&&ht(le)),r!==a?(n=function(){var e;return(e=Rt())===a&&(e=Nt()),e}(),n!==a?(st=t,t=r=Ie(n)):(at=t,t=a)):(at=t,t=a),t}function Rt(){var t,r,n,s;if(t=at,e.substr(at,2)===Pe?(r=Pe,at+=2):(r=a,0===ut&&ht(Re)),r!==a){if(n=[],Ne.test(e.charAt(at))?(s=e.charAt(at),at++):(s=a,0===ut&&ht(_e)),s!==a)for(;s!==a;)n.push(s),Ne.test(e.charAt(at))?(s=e.charAt(at),at++):(s=a,0===ut&&ht(_e));else n=a;n!==a?(st=t,t=r=De(n)):(at=t,t=a)}else at=t,t=a;return t}function Nt(){var t,r,n;if(t=at,r=[],Ne.test(e.charAt(at))?(n=e.charAt(at),at++):(n=a,0===ut&&ht(_e)),n!==a)for(;n!==a;)r.push(n),Ne.test(e.charAt(at))?(n=e.charAt(at),at++):(n=a,0===ut&&ht(_e));else r=a;return r!==a&&(st=t,r=Ce(r)),r}function _t(){var e,t,r,n,s;for(e=at,t=[],r=Lt();r!==a;)t.push(r),r=Lt();if(t!==a)if((r=Dt())!==a){if(n=[],(s=Lt())!==a)for(;s!==a;)n.push(s),s=Lt();else n=a;n!==a?(st=e,e=t=$e(r)):(at=e,e=a)}else at=e,e=a;else at=e,e=a;if(e===a){for(e=at,t=[],r=Lt();r!==a;)t.push(r),r=Lt();t!==a&&(r=Dt())!==a&&(n=jt())!==a?(st=e,e=t=$e(r)):(at=e,e=a)}return e}function Dt(){var t;return e.substr(at,6)===Ve?(t=Ve,at+=6):(t=a,0===ut&&ht(Ue)),t===a&&(e.substr(at,7)===Be?(t=Be,at+=7):(t=a,0===ut&&ht(Ge)),t===a&&(e.substr(at,2)===Ye?(t=Ye,at+=2):(t=a,0===ut&&ht(We)),t===a&&(e.substr(at,3)===He?(t=He,at+=3):(t=a,0===ut&&ht(Qe)),t===a&&(e.substr(at,3)===Ke?(t=Ke,at+=3):(t=a,0===ut&&ht(ze)),t===a&&(e.substr(at,2)===Xe?(t=Xe,at+=2):(t=a,0===ut&&ht(Je)),t===a&&(e.substr(at,2)===Ze?(t=Ze,at+=2):(t=a,0===ut&&ht(et)))))))),t}function Ct(){var t,r,n;for(t=at,r=[],n=Lt();n!==a;)r.push(n),n=Lt();return r!==a?(n=function(){var t;return 43===e.charCodeAt(at)?(t=H,at++):(t=a,0===ut&&ht(Q)),t===a&&(45===e.charCodeAt(at)?(t=K,at++):(t=a,0===ut&&ht(z)),t===a&&(33===e.charCodeAt(at)?(t=X,at++):(t=a,0===ut&&ht(J)))),t}(),n!==a?(st=t,t=r=$e(n)):(at=t,t=a)):(at=t,t=a),t}function Lt(){var t,r;if(ut++,t=[],rt.test(e.charAt(at))?(r=e.charAt(at),at++):(r=a,0===ut&&ht(nt)),r!==a)for(;r!==a;)t.push(r),rt.test(e.charAt(at))?(r=e.charAt(at),at++):(r=a,0===ut&&ht(nt));else t=a;return ut--,t===a&&(r=a,0===ut&&ht(tt)),t}function jt(){var t,r;return t=at,ut++,e.length>at?(r=e.charAt(at),at++):(r=a,0===ut&&ht(Y)),ut--,r===a?t=void 0:(at=t,t=a),t}if((n=i())!==a&&at===e.length)return n;throw n!==a&&at<e.length&&ht({type:"end"}),function(e,r,n){return new t(t.buildMessage(e,r),e,r,n)}(lt,ot<e.length?e.charAt(ot):null,ot<e.length?gt(ot,ot+1):gt(ot,ot))}}},6251:e=>{"use strict";var t="<implicit>";e.exports=function e(r){if(!r)return"";var n="";return null!=r.start&&(n+=(r.parenthesized?"(":"")+r.start+" "),r.field&&r.field!==t&&(n+=r.field+":"),r.left&&(r.parenthesized&&!r.start&&(n+="("),n+=e(r.left),r.parenthesized&&!r.right&&(n+=")")),r.operator&&(r.left&&(n+=" "),r.operator!==t&&(n+=r.operator)),r.right&&(r.operator&&r.operator!==t&&(n+=" "),n+=e(r.right),r.parenthesized&&(n+=")")),(r.term||""===r.term&&r.quoted)&&(r.prefix&&(n+=r.prefix),r.quoted?(n+='"',n+=r.term,n+='"'):r.regex?(n+="/",n+=r.term,n+="/"):n+=r.term,null!=r.proximity&&(n+="~"+r.proximity),null!=r.boost&&(n+="^"+r.boost)),r.term_min&&("both"===r.inclusive||"left"===r.inclusive?n+="[":n+="{",n+=r.term_min,n+=" TO ",n+=r.term_max,"both"===r.inclusive||"right"===r.inclusive?n+="]":n+="}"),r.similarity&&(n+="~",.5!==r.similarity&&(n+=r.similarity)),n}},9524:(e,t,r)=>{const n=Symbol("SemVer ANY");class a{static get ANY(){return n}constructor(e,t){if(t=s(t),e instanceof a){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),u("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){const t=this.options.loose?i[o.COMPARATORLOOSE]:i[o.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new c(r[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof a))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new p(e.value,t).test(this.value):""===e.operator?""===e.value||new p(this.value,t).test(e.semver):!((t=s(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(l(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(l(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=a;const s=r(7095),{safeRe:i,t:o}=r(6850),l=r(3811),u=r(9796),c=r(7944),p=r(8395)},8395:(e,t,r)=>{class n{constructor(e,t){if(t=s(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof i)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!m(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&y(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&g)|(this.options.loose&&h))+":"+e,r=a.get(t);if(r)return r;const n=this.options.loose,s=n?u[c.HYPHENRANGELOOSE]:u[c.HYPHENRANGE];e=e.replace(s,R(this.options.includePrerelease)),o("hyphen replace",e),e=e.replace(u[c.COMPARATORTRIM],p),o("comparator trim",e);let l=(e=(e=e.replace(u[c.TILDETRIM],d)).replace(u[c.CARETTRIM],f)).split(" ").map((e=>b(e,this.options))).join(" ").split(/\s+/).map((e=>P(e,this.options)));n&&(l=l.filter((e=>(o("loose invalid filter",e,this.options),!!e.match(u[c.COMPARATORLOOSE]))))),o("range list",l);const y=new Map,v=l.map((e=>new i(e,this.options)));for(const e of v){if(m(e))return[e];y.set(e.value,e)}y.size>1&&y.has("")&&y.delete("");const E=[...y.values()];return a.set(t,E),E}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some((r=>v(r,t)&&e.set.some((e=>v(e,t)&&r.every((r=>e.every((e=>r.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(N(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const a=new(r(5689))({max:1e3}),s=r(7095),i=r(9524),o=r(9796),l=r(7944),{safeRe:u,t:c,comparatorTrimReplace:p,tildeTrimReplace:d,caretTrimReplace:f}=r(6850),{FLAG_INCLUDE_PRERELEASE:g,FLAG_LOOSE:h}=r(9630),m=e=>"<0.0.0-0"===e.value,y=e=>""===e.value,v=(e,t)=>{let r=!0;const n=e.slice();let a=n.pop();for(;r&&n.length;)r=n.every((e=>a.intersects(e,t))),a=n.pop();return r},b=(e,t)=>(o("comp",e,t),e=S(e,t),o("caret",e),e=O(e,t),o("tildes",e),e=T(e,t),o("xrange",e),e=A(e,t),o("stars",e),e),E=e=>!e||"x"===e.toLowerCase()||"*"===e,O=(e,t)=>e.trim().split(/\s+/).map((e=>w(e,t))).join(" "),w=(e,t)=>{const r=t.loose?u[c.TILDELOOSE]:u[c.TILDE];return e.replace(r,((t,r,n,a,s)=>{let i;return o("tilde",e,t,r,n,a,s),E(r)?i="":E(n)?i=`>=${r}.0.0 <${+r+1}.0.0-0`:E(a)?i=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:s?(o("replaceTilde pr",s),i=`>=${r}.${n}.${a}-${s} <${r}.${+n+1}.0-0`):i=`>=${r}.${n}.${a} <${r}.${+n+1}.0-0`,o("tilde return",i),i}))},S=(e,t)=>e.trim().split(/\s+/).map((e=>q(e,t))).join(" "),q=(e,t)=>{o("caret",e,t);const r=t.loose?u[c.CARETLOOSE]:u[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,((t,r,a,s,i)=>{let l;return o("caret",e,t,r,a,s,i),E(r)?l="":E(a)?l=`>=${r}.0.0${n} <${+r+1}.0.0-0`:E(s)?l="0"===r?`>=${r}.${a}.0${n} <${r}.${+a+1}.0-0`:`>=${r}.${a}.0${n} <${+r+1}.0.0-0`:i?(o("replaceCaret pr",i),l="0"===r?"0"===a?`>=${r}.${a}.${s}-${i} <${r}.${a}.${+s+1}-0`:`>=${r}.${a}.${s}-${i} <${r}.${+a+1}.0-0`:`>=${r}.${a}.${s}-${i} <${+r+1}.0.0-0`):(o("no pr"),l="0"===r?"0"===a?`>=${r}.${a}.${s}${n} <${r}.${a}.${+s+1}-0`:`>=${r}.${a}.${s}${n} <${r}.${+a+1}.0-0`:`>=${r}.${a}.${s} <${+r+1}.0.0-0`),o("caret return",l),l}))},T=(e,t)=>(o("replaceXRanges",e,t),e.split(/\s+/).map((e=>I(e,t))).join(" ")),I=(e,t)=>{e=e.trim();const r=t.loose?u[c.XRANGELOOSE]:u[c.XRANGE];return e.replace(r,((r,n,a,s,i,l)=>{o("xRange",e,r,n,a,s,i,l);const u=E(a),c=u||E(s),p=c||E(i),d=p;return"="===n&&d&&(n=""),l=t.includePrerelease?"-0":"",u?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&d?(c&&(s=0),i=0,">"===n?(n=">=",c?(a=+a+1,s=0,i=0):(s=+s+1,i=0)):"<="===n&&(n="<",c?a=+a+1:s=+s+1),"<"===n&&(l="-0"),r=`${n+a}.${s}.${i}${l}`):c?r=`>=${a}.0.0${l} <${+a+1}.0.0-0`:p&&(r=`>=${a}.${s}.0${l} <${a}.${+s+1}.0-0`),o("xRange return",r),r}))},A=(e,t)=>(o("replaceStars",e,t),e.trim().replace(u[c.STAR],"")),P=(e,t)=>(o("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),R=e=>(t,r,n,a,s,i,o,l,u,c,p,d,f)=>`${r=E(n)?"":E(a)?`>=${n}.0.0${e?"-0":""}`:E(s)?`>=${n}.${a}.0${e?"-0":""}`:i?`>=${r}`:`>=${r}${e?"-0":""}`} ${l=E(u)?"":E(c)?`<${+u+1}.0.0-0`:E(p)?`<${u}.${+c+1}.0-0`:d?`<=${u}.${c}.${p}-${d}`:e?`<${u}.${c}.${+p+1}-0`:`<=${l}`}`.trim(),N=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(o(e[r].semver),e[r].semver!==i.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},7944:(e,t,r)=>{const n=r(9796),{MAX_LENGTH:a,MAX_SAFE_INTEGER:s}=r(9630),{safeRe:i,t:o}=r(6850),l=r(7095),{compareIdentifiers:u}=r(4031);class c{constructor(e,t){if(t=l(t),e instanceof c){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>a)throw new TypeError(`version is longer than ${a} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?i[o.LOOSE]:i[o.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<s)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"==typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],a=e.prerelease[t];if(n("prerelease compare",t,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return u(r,a)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{const r=this.build[t],a=e.build[t];if(n("prerelease compare",t,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return u(r,a)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===r&&(n=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=c},7994:(e,t,r)=>{const n=r(5860);e.exports=(e,t)=>{const r=n(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},3811:(e,t,r)=>{const n=r(6909),a=r(7659),s=r(144),i=r(2077),o=r(599),l=r(7092);e.exports=(e,t,r,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return n(e,r,u);case"!=":return a(e,r,u);case">":return s(e,r,u);case">=":return i(e,r,u);case"<":return o(e,r,u);case"<=":return l(e,r,u);default:throw new TypeError(`Invalid operator: ${t}`)}}},5334:(e,t,r)=>{const n=r(7944),a=r(5860),{safeRe:s,t:i}=r(6850);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let t;for(;(t=s[i.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&t.index+t[0].length===r.index+r[0].length||(r=t),s[i.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;s[i.COERCERTL].lastIndex=-1}else r=e.match(s[i.COERCE]);return null===r?null:a(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)}},2801:(e,t,r)=>{const n=r(7944);e.exports=(e,t,r)=>{const a=new n(e,r),s=new n(t,r);return a.compare(s)||a.compareBuild(s)}},7023:(e,t,r)=>{const n=r(5380);e.exports=(e,t)=>n(e,t,!0)},5380:(e,t,r)=>{const n=r(7944);e.exports=(e,t,r)=>new n(e,r).compare(new n(t,r))},660:(e,t,r)=>{const n=r(5860);e.exports=(e,t)=>{const r=n(e,null,!0),a=n(t,null,!0),s=r.compare(a);if(0===s)return null;const i=s>0,o=i?r:a,l=i?a:r,u=!!o.prerelease.length;if(l.prerelease.length&&!u)return l.patch||l.minor?o.patch?"patch":o.minor?"minor":"major":"major";const c=u?"pre":"";return r.major!==a.major?c+"major":r.minor!==a.minor?c+"minor":r.patch!==a.patch?c+"patch":"prerelease"}},6909:(e,t,r)=>{const n=r(5380);e.exports=(e,t,r)=>0===n(e,t,r)},144:(e,t,r)=>{const n=r(5380);e.exports=(e,t,r)=>n(e,t,r)>0},2077:(e,t,r)=>{const n=r(5380);e.exports=(e,t,r)=>n(e,t,r)>=0},5955:(e,t,r)=>{const n=r(7944);e.exports=(e,t,r,a,s)=>{"string"==typeof r&&(s=a,a=r,r=void 0);try{return new n(e instanceof n?e.version:e,r).inc(t,a,s).version}catch(e){return null}}},599:(e,t,r)=>{const n=r(5380);e.exports=(e,t,r)=>n(e,t,r)<0},7092:(e,t,r)=>{const n=r(5380);e.exports=(e,t,r)=>n(e,t,r)<=0},2966:(e,t,r)=>{const n=r(7944);e.exports=(e,t)=>new n(e,t).major},5986:(e,t,r)=>{const n=r(7944);e.exports=(e,t)=>new n(e,t).minor},7659:(e,t,r)=>{const n=r(5380);e.exports=(e,t,r)=>0!==n(e,t,r)},5860:(e,t,r)=>{const n=r(7944);e.exports=(e,t,r=!1)=>{if(e instanceof n)return e;try{return new n(e,t)}catch(e){if(!r)return null;throw e}}},1617:(e,t,r)=>{const n=r(7944);e.exports=(e,t)=>new n(e,t).patch},9613:(e,t,r)=>{const n=r(5860);e.exports=(e,t)=>{const r=n(e,t);return r&&r.prerelease.length?r.prerelease:null}},2862:(e,t,r)=>{const n=r(5380);e.exports=(e,t,r)=>n(t,e,r)},6033:(e,t,r)=>{const n=r(2801);e.exports=(e,t)=>e.sort(((e,r)=>n(r,e,t)))},1722:(e,t,r)=>{const n=r(8395);e.exports=(e,t,r)=>{try{t=new n(t,r)}catch(e){return!1}return t.test(e)}},603:(e,t,r)=>{const n=r(2801);e.exports=(e,t)=>e.sort(((e,r)=>n(e,r,t)))},7645:(e,t,r)=>{const n=r(5860);e.exports=(e,t)=>{const r=n(e,t);return r?r.version:null}},8449:(e,t,r)=>{const n=r(6850),a=r(9630),s=r(7944),i=r(4031),o=r(5860),l=r(7645),u=r(7994),c=r(5955),p=r(660),d=r(2966),f=r(5986),g=r(1617),h=r(9613),m=r(5380),y=r(2862),v=r(7023),b=r(2801),E=r(603),O=r(6033),w=r(144),S=r(599),q=r(6909),T=r(7659),I=r(2077),A=r(7092),P=r(3811),R=r(5334),N=r(9524),_=r(8395),D=r(1722),C=r(651),L=r(7840),j=r(7930),k=r(3489),x=r(7494),F=r(5463),M=r(7871),$=r(4266),V=r(1112),U=r(1465),B=r(9252);e.exports={parse:o,valid:l,clean:u,inc:c,diff:p,major:d,minor:f,patch:g,prerelease:h,compare:m,rcompare:y,compareLoose:v,compareBuild:b,sort:E,rsort:O,gt:w,lt:S,eq:q,neq:T,gte:I,lte:A,cmp:P,coerce:R,Comparator:N,Range:_,satisfies:D,toComparators:C,maxSatisfying:L,minSatisfying:j,minVersion:k,validRange:x,outside:F,gtr:M,ltr:$,intersects:V,simplifyRange:U,subset:B,SemVer:s,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:a.SEMVER_SPEC_VERSION,RELEASE_TYPES:a.RELEASE_TYPES,compareIdentifiers:i.compareIdentifiers,rcompareIdentifiers:i.rcompareIdentifiers}},9630:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},9796:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},4031:e=>{const t=/^[0-9]+$/,r=(e,r)=>{const n=t.test(e),a=t.test(r);return n&&a&&(e=+e,r=+r),e===r?0:n&&!a?-1:a&&!n?1:e<r?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},7095:e=>{const t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},6850:(e,t,r)=>{const{MAX_SAFE_COMPONENT_LENGTH:n}=r(9630),a=r(9796),s=(t=e.exports={}).re=[],i=t.safeRe=[],o=t.src=[],l=t.t={};let u=0;const c=(e,t,r)=>{const n=t.split("\\s*").join("\\s{0,1}").split("\\s+").join("\\s"),c=u++;a(e,c,t),l[e]=c,o[c]=t,s[c]=new RegExp(t,r?"g":void 0),i[c]=new RegExp(n,r?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${o[l.NUMERICIDENTIFIER]})\\.(${o[l.NUMERICIDENTIFIER]})\\.(${o[l.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${o[l.NUMERICIDENTIFIERLOOSE]})\\.(${o[l.NUMERICIDENTIFIERLOOSE]})\\.(${o[l.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${o[l.NUMERICIDENTIFIER]}|${o[l.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${o[l.NUMERICIDENTIFIERLOOSE]}|${o[l.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${o[l.PRERELEASEIDENTIFIER]}(?:\\.${o[l.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${o[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[l.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${o[l.BUILDIDENTIFIER]}(?:\\.${o[l.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${o[l.MAINVERSION]}${o[l.PRERELEASE]}?${o[l.BUILD]}?`),c("FULL",`^${o[l.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${o[l.MAINVERSIONLOOSE]}${o[l.PRERELEASELOOSE]}?${o[l.BUILD]}?`),c("LOOSE",`^${o[l.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${o[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${o[l.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${o[l.XRANGEIDENTIFIER]})(?:\\.(${o[l.XRANGEIDENTIFIER]})(?:\\.(${o[l.XRANGEIDENTIFIER]})(?:${o[l.PRERELEASE]})?${o[l.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${o[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[l.XRANGEIDENTIFIERLOOSE]})(?:${o[l.PRERELEASELOOSE]})?${o[l.BUILD]}?)?)?`),c("XRANGE",`^${o[l.GTLT]}\\s*${o[l.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${o[l.GTLT]}\\s*${o[l.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),c("COERCERTL",o[l.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${o[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${o[l.LONETILDE]}${o[l.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${o[l.LONETILDE]}${o[l.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${o[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${o[l.LONECARET]}${o[l.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${o[l.LONECARET]}${o[l.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${o[l.GTLT]}\\s*(${o[l.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${o[l.GTLT]}\\s*(${o[l.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${o[l.GTLT]}\\s*(${o[l.LOOSEPLAIN]}|${o[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${o[l.XRANGEPLAIN]})\\s+-\\s+(${o[l.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${o[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[l.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},7871:(e,t,r)=>{const n=r(5463);e.exports=(e,t,r)=>n(e,t,">",r)},1112:(e,t,r)=>{const n=r(8395);e.exports=(e,t,r)=>(e=new n(e,r),t=new n(t,r),e.intersects(t,r))},4266:(e,t,r)=>{const n=r(5463);e.exports=(e,t,r)=>n(e,t,"<",r)},7840:(e,t,r)=>{const n=r(7944),a=r(8395);e.exports=(e,t,r)=>{let s=null,i=null,o=null;try{o=new a(t,r)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(s&&-1!==i.compare(e)||(s=e,i=new n(s,r)))})),s}},7930:(e,t,r)=>{const n=r(7944),a=r(8395);e.exports=(e,t,r)=>{let s=null,i=null,o=null;try{o=new a(t,r)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(s&&1!==i.compare(e)||(s=e,i=new n(s,r)))})),s}},3489:(e,t,r)=>{const n=r(7944),a=r(8395),s=r(144);e.exports=(e,t)=>{e=new a(e,t);let r=new n("0.0.0");if(e.test(r))return r;if(r=new n("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const a=e.set[t];let i=null;a.forEach((e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":i&&!s(t,i)||(i=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!i||r&&!s(r,i)||(r=i)}return r&&e.test(r)?r:null}},5463:(e,t,r)=>{const n=r(7944),a=r(9524),{ANY:s}=a,i=r(8395),o=r(1722),l=r(144),u=r(599),c=r(7092),p=r(2077);e.exports=(e,t,r,d)=>{let f,g,h,m,y;switch(e=new n(e,d),t=new i(t,d),r){case">":f=l,g=c,h=u,m=">",y=">=";break;case"<":f=u,g=p,h=l,m="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,d))return!1;for(let r=0;r<t.set.length;++r){const n=t.set[r];let i=null,o=null;if(n.forEach((e=>{e.semver===s&&(e=new a(">=0.0.0")),i=i||e,o=o||e,f(e.semver,i.semver,d)?i=e:h(e.semver,o.semver,d)&&(o=e)})),i.operator===m||i.operator===y)return!1;if((!o.operator||o.operator===m)&&g(e,o.semver))return!1;if(o.operator===y&&h(e,o.semver))return!1}return!0}},1465:(e,t,r)=>{const n=r(1722),a=r(5380);e.exports=(e,t,r)=>{const s=[];let i=null,o=null;const l=e.sort(((e,t)=>a(e,t,r)));for(const e of l)n(e,t,r)?(o=e,i||(i=e)):(o&&s.push([i,o]),o=null,i=null);i&&s.push([i,null]);const u=[];for(const[e,t]of s)e===t?u.push(e):t||e!==l[0]?t?e===l[0]?u.push(`<=${t}`):u.push(`${e} - ${t}`):u.push(`>=${e}`):u.push("*");const c=u.join(" || "),p="string"==typeof t.raw?t.raw:String(t);return c.length<p.length?c:t}},9252:(e,t,r)=>{const n=r(8395),a=r(9524),{ANY:s}=a,i=r(1722),o=r(5380),l=[new a(">=0.0.0-0")],u=[new a(">=0.0.0")],c=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===s){if(1===t.length&&t[0].semver===s)return!0;e=r.includePrerelease?l:u}if(1===t.length&&t[0].semver===s){if(r.includePrerelease)return!0;t=u}const n=new Set;let a,c,f,g,h,m,y;for(const t of e)">"===t.operator||">="===t.operator?a=p(a,t,r):"<"===t.operator||"<="===t.operator?c=d(c,t,r):n.add(t.semver);if(n.size>1)return null;if(a&&c){if(f=o(a.semver,c.semver,r),f>0)return null;if(0===f&&(">="!==a.operator||"<="!==c.operator))return null}for(const e of n){if(a&&!i(e,String(a),r))return null;if(c&&!i(e,String(c),r))return null;for(const n of t)if(!i(e,String(n),r))return!1;return!0}let v=!(!c||r.includePrerelease||!c.semver.prerelease.length)&&c.semver,b=!(!a||r.includePrerelease||!a.semver.prerelease.length)&&a.semver;v&&1===v.prerelease.length&&"<"===c.operator&&0===v.prerelease[0]&&(v=!1);for(const e of t){if(y=y||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,a)if(b&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===b.major&&e.semver.minor===b.minor&&e.semver.patch===b.patch&&(b=!1),">"===e.operator||">="===e.operator){if(g=p(a,e,r),g===e&&g!==a)return!1}else if(">="===a.operator&&!i(a.semver,String(e),r))return!1;if(c)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),"<"===e.operator||"<="===e.operator){if(h=d(c,e,r),h===e&&h!==c)return!1}else if("<="===c.operator&&!i(c.semver,String(e),r))return!1;if(!e.operator&&(c||a)&&0!==f)return!1}return!(a&&m&&!c&&0!==f||c&&y&&!a&&0!==f||b||v)},p=(e,t,r)=>{if(!e)return t;const n=o(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},d=(e,t,r)=>{if(!e)return t;const n=o(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new n(e,r),t=new n(t,r);let a=!1;e:for(const n of e.set){for(const e of t.set){const t=c(n,e,r);if(a=a||null!==t,t)continue e}if(a)return!1}return!0}},651:(e,t,r)=>{const n=r(8395);e.exports=(e,t)=>new n(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},7494:(e,t,r)=>{const n=r(8395);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},7103:e=>{"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},9691:(e,t,r)=>{"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,a=arguments.length;r<a;r++)t.push(arguments[r]);return t}function a(e,t,r,n){if(!(this instanceof a))return new a(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=n,n.Node=a,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)n=arguments[e],(r=this).tail=new a(n,r.tail,null,r),r.head||(r.head=r.tail),r.length++;var r,n;return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)n=arguments[e],(r=this).head=new a(n,null,r.head,r),r.tail||(r.tail=r.head),r.length++;var r,n;return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,a=this.head;null!==a;)r.push(e.call(t,a.value,this)),a=a.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,a=this.tail;null!==a;)r.push(e.call(t,a.value,this)),a=a.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var a=0;null!==n;a++)r=e(r,n.value,a),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var a=this.length-1;null!==n;a--)r=e(r,n.value,a),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=0,s=this.head;null!==s&&a<e;a++)s=s.next;for(;null!==s&&a<t;a++,s=s.next)r.push(s.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=this.length,s=this.tail;null!==s&&a>t;a--)s=s.prev;for(;null!==s&&a>e;a--,s=s.prev)r.push(s.value);return r},n.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,s=this.head;null!==s&&n<e;n++)s=s.next;var i,o,l,u,c=[];for(n=0;s&&n<t;n++)c.push(s.value),s=this.removeNode(s);for(null===s&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev),n=0;n<r.length;n++)i=this,o=s,l=r[n],u=void 0,null===(u=o===i.head?new a(l,null,o,i):new a(l,o,o.next,i)).next&&(i.tail=u),null===u.prev&&(i.head=u),i.length++,s=u;return c},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{r(7103)(n)}catch(e){}},6089:e=>{"use strict";e.exports=s},7781:t=>{"use strict";t.exports=e},8531:e=>{"use strict";e.exports=n},2007:e=>{"use strict";e.exports=i},3241:e=>{"use strict";e.exports=t},5959:e=>{"use strict";e.exports=a},1269:e=>{"use strict";e.exports=r},688:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>L,__assign:()=>s,__asyncDelegator:()=>T,__asyncGenerator:()=>q,__asyncValues:()=>I,__await:()=>S,__awaiter:()=>g,__classPrivateFieldGet:()=>_,__classPrivateFieldIn:()=>C,__classPrivateFieldSet:()=>D,__createBinding:()=>m,__decorate:()=>o,__disposeResources:()=>k,__esDecorate:()=>u,__exportStar:()=>y,__extends:()=>a,__generator:()=>h,__importDefault:()=>N,__importStar:()=>R,__makeTemplateObject:()=>A,__metadata:()=>f,__param:()=>l,__propKey:()=>p,__read:()=>b,__rest:()=>i,__runInitializers:()=>c,__setFunctionName:()=>d,__spread:()=>E,__spreadArray:()=>w,__spreadArrays:()=>O,__values:()=>v,default:()=>x});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function o(e,t,r,n){var a,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(i=(s<3?a(i):s>3?a(t,r,i):a(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i}function l(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,a,s){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,l=n.kind,u="getter"===l?"get":"setter"===l?"set":"value",c=!t&&e?n.static?e:e.prototype:null,p=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),d=!1,f=r.length-1;f>=0;f--){var g={};for(var h in n)g[h]="access"===h?{}:n[h];for(var h in n.access)g.access[h]=n.access[h];g.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(i(e||null))};var m=(0,r[f])("accessor"===l?{get:p.get,set:p.set}:p[u],g);if("accessor"===l){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=i(m.get))&&(p.get=o),(o=i(m.set))&&(p.set=o),(o=i(m.init))&&a.unshift(o)}else(o=i(m))&&("field"===l?a.unshift(o):p[u]=o)}c&&Object.defineProperty(c,n.name,p),d=!0}function c(e,t,r){for(var n=arguments.length>2,a=0;a<t.length;a++)r=n?t[a].call(e,r):t[a].call(e);return n?r:void 0}function p(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function g(e,t,r,n){return new(r||(r=Promise))((function(a,s){function i(e){try{l(n.next(e))}catch(e){s(e)}}function o(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,o)}l((n=n.apply(e,t||[])).next())}))}function h(e,t){var r,n,a,s,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}var m=Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||m(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,s=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)i.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return i}function E(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function O(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var s=arguments[t],i=0,o=s.length;i<o;i++,a++)n[a]=s[i];return n}function w(e,t,r){if(r||2===arguments.length)for(var n,a=0,s=t.length;a<s;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function q(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,a=r.apply(e,t||[]),s=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){a[e]&&(n[e]=function(t){return new Promise((function(r,n){s.push([e,t,r,n])>1||o(e,t)}))})}function o(e,t){try{(r=a[e](t)).value instanceof S?Promise.resolve(r.value.v).then(l,u):c(s[0][2],r)}catch(e){c(s[0][3],e)}var r}function l(e){o("next",e)}function u(e){o("throw",e)}function c(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,a){t[n]=e[n]?function(t){return(r=!r)?{value:S(e[n](t)),done:!1}:a?a(t):t}:a}}function I(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,a){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,a,(t=e[r](t)).done,t.value)}))}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function R(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return P(t,e),t}function N(e){return e&&e.__esModule?e:{default:e}}function _(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function D(e,t,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,r):a?a.value=r:t.set(e,r),r}function C(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function L(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var j="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function k(e){function t(t){e.error=e.hasError?new j(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var a=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(a).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const x={__extends:a,__assign:s,__rest:i,__decorate:o,__param:l,__metadata:f,__awaiter:g,__generator:h,__createBinding:m,__exportStar:y,__values:v,__read:b,__spread:E,__spreadArrays:O,__spreadArray:w,__await:S,__asyncGenerator:q,__asyncDelegator:T,__asyncValues:I,__makeTemplateObject:A,__importStar:R,__importDefault:N,__classPrivateFieldGet:_,__classPrivateFieldSet:D,__classPrivateFieldIn:C,__addDisposableResource:L,__disposeResources:k}}},l={};function u(e){var t=l[e];if(void 0!==t)return t.exports;var r=l[e]={exports:{}};return o[e](r,r.exports,u),r.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var r in t)u.o(t,r)&&!u.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};return(()=>{"use strict";u.r(c),u.d(c,{plugin:()=>rs});var e=u(7781),t=u(3241),r=u.n(t),n=u(1269);function a(e){return"function"==typeof e}function s(e){return function(t){if(function(e){return a(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function l(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,s=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)i.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return i}function d(e,t,r){if(r||2===arguments.length)for(var n,a=0,s=t.length;a<s;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var f,g=((f=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),f.prototype.constructor=f,f);function h(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var m=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,r,n,s;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var o=l(i),u=o.next();!u.done;u=o.next())u.value.remove(this)}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(a(c))try{c()}catch(e){s=e instanceof g?e.errors:[e]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var h=l(f),m=h.next();!m.done;m=h.next()){var v=m.value;try{y(v)}catch(e){s=null!=s?s:[],e instanceof g?s=d(d([],p(s)),p(e.errors)):s.push(e)}}}catch(e){r={error:e}}finally{try{m&&!m.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}}if(s)throw new g(s)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)y(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&h(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&h(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function y(e){a(e)?e():e.unsubscribe()}m.EMPTY;var v=null,b=null,E=!1,O=!1,w={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=w.delegate;return(null==a?void 0:a.setTimeout)?a.setTimeout.apply(a,d([e,t],p(r))):setTimeout.apply(void 0,d([e,t],p(r)))},clearTimeout:function(e){var t=w.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function S(){}var q=T("C",void 0,void 0);function T(e,t,r){return{kind:e,value:t,error:r}}var I=function(e){function t(t){var r,n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,((r=t)instanceof m||r&&"closed"in r&&a(r.remove)&&a(r.add)&&a(r.unsubscribe))&&t.add(n)):n.destination=C,n}return o(t,e),t.create=function(e,t,r){return new N(e,t,r)},t.prototype.next=function(e){this.isStopped?D(function(e){return T("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?D(T("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?D(q,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(m),A=Function.prototype.bind;function P(e,t){return A.call(e,t)}var R=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){_(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){_(e)}else _(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){_(e)}},e}(),N=function(e){function t(t,r,n){var s,i,o=e.call(this)||this;return a(t)||!t?s={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:o&&O?((i=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},s={next:t.next&&P(t.next,i),error:t.error&&P(t.error,i),complete:t.complete&&P(t.complete,i)}):s=t,o.destination=new R(s),o}return o(t,e),t}(I);function _(e){E||function(e){w.setTimeout((function(){if(!v)throw e;v(e)}))}(e)}function D(e,t){var r=b;r&&w.setTimeout((function(){return r(e,t)}))}var C={closed:!0,next:S,error:function(e){throw e},complete:S};function L(e,t,r,n,a){return new F(e,t,r,n,a)}var j,k,x,F=function(e){function t(t,r,n,a,s,i){var o=e.call(this,t)||this;return o.onFinalize=s,o.shouldUnsubscribe=i,o._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,o._error=a?function(e){try{a(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,o._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,o}return o(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(I);function M(e){return e}function $(e,t,r){var n=a(e)||t||r?{next:e,error:t,complete:r}:e;return n?s((function(e,t){var r;null===(r=n.subscribe)||void 0===r||r.call(n);var a=!0;e.subscribe(L(t,(function(e){var r;null===(r=n.next)||void 0===r||r.call(n,e),t.next(e)}),(function(){var e;a=!1,null===(e=n.complete)||void 0===e||e.call(n),t.complete()}),(function(e){var r;a=!1,null===(r=n.error)||void 0===r||r.call(n,e),t.error(e)}),(function(){var e,t;a&&(null===(e=n.unsubscribe)||void 0===e||e.call(n)),null===(t=n.finalize)||void 0===t||t.call(n)})))})):M}function V(e,t){return s((function(r,n){var a=0;r.subscribe(L(n,(function(r){n.next(e.call(t,r,a++))})))}))}function U(e,t){const r=(t=t||{}).delimiter||".";let n=t.maxDepth||3,a=1;const s={};return function e(i,o){Object.keys(i).forEach((l=>{const u=i[l],c=null==t?void 0:t.safe,p=Array.isArray(u),d=c&&p,f="[object Object]"===Object.prototype.toString.call(u),g=o?o+r+l:l;if((null==t?void 0:t.maxDepth)||(n=a+1),!d&&f&&Object.keys(u).length&&a<n)return++a,e(u,g);s[g]=p?JSON.stringify(u):u}))}(e,null),s}!function(e){e.Lucene="lucene",e.PPL="PPL"}(j||(j={})),function(e){e.Elasticsearch="elasticsearch",e.OpenSearch="opensearch"}(k||(k={})),function(e){e.Traces="Traces",e.Metric="Metric"}(x||(x={}));const B=e=>H[e.type].requiresField,G=e=>H[e.type].isPipelineAgg,Y=e=>H[e.type].supportsMultipleBucketPaths,W=e=>H[e.type].hasSettings,H={count:{label:"Count",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!1,hasMeta:!1,supportsInlineScript:!1,defaults:{}},avg:{label:"Average",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},sum:{label:"Sum",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},max:{label:"Max",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},min:{label:"Min",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},extended_stats:{label:"Extended Stats",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!0,defaults:{meta:{std_deviation_bounds_lower:!0,std_deviation_bounds_upper:!0}}},percentiles:{label:"Percentiles",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{settings:{percents:["25","50","75","95","99"]}}},cardinality:{label:"Unique Count",requiresField:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},moving_avg:{label:"Moving Average",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{model:"simple",window:5}}},moving_fn:{label:"Moving Function",requiresField:!0,isPipelineAgg:!0,supportsMultipleBucketPaths:!1,supportsInlineScript:!1,supportsMissing:!1,hasMeta:!1,hasSettings:!0,defaults:{},versionRange:{[k.Elasticsearch]:">=7.0.0"}},derivative:{label:"Derivative",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},cumulative_sum:{label:"Cumulative Sum",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},bucket_script:{label:"Bucket Script",requiresField:!1,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!0,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{pipelineVariables:[{name:"var1",pipelineAgg:""}]}},raw_document:{label:"Raw Document (legacy)",requiresField:!1,isSingleMetric:!0,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{size:"500",order:"desc",useTimeRange:!0}}},raw_data:{label:"Raw Data",requiresField:!1,isSingleMetric:!0,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{size:"500",order:"desc",useTimeRange:!0}}},logs:{label:"Logs",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!1,supportsInlineScript:!1,hasMeta:!1,defaults:{}}},Q={moving_avg:[{label:"window",default:5},{label:"model",default:"simple"},{label:"predict"},{label:"minimize",default:!1}],moving_fn:[{label:"window",default:5},{label:"script"}],derivative:[{label:"unit"}],cumulative_sum:[{label:"format"}],bucket_script:[]},K=(e,t)=>{const r=t.filter((t=>{var r;return Y(t)?null===(r=t.pipelineVariables)||void 0===r?void 0:r.some((t=>t.pipelineAgg===e.id)):B(t)&&e.id===t.field}));return[...r,...r.flatMap((e=>K(e,t)))]},z=[{label:"Descending",value:"desc"},{label:"Ascending",value:"asc"}],X=[{label:"Avg",value:"avg"},{label:"Min",value:"min"},{label:"Max",value:"max"},{label:"Sum",value:"sum"},{label:"Count",value:"count"},{label:"Std Dev",value:"std_deviation"},{label:"Std Dev Upper",value:"std_deviation_bounds_upper"},{label:"Std Dev Lower",value:"std_deviation_bounds_lower"}],J=[{label:"Simple",value:"simple"},{label:"Linear",value:"linear"},{label:"Exponentially Weighted",value:"ewma"},{label:"Holt Linear",value:"holt"},{label:"Holt Winters",value:"holt_winters"}];function Z(e="1"){return{type:"count",id:e}}function ee(e="1"){return{type:"date_histogram",id:e,settings:{interval:"auto"}}}const te=(e,t)=>e.find((e=>e.id===t));function re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ne{sort(e){null===e.col||this.columns.length<=e.col||(this.rows.sort(((t,r)=>+(null==(t=t[e.col]))-+(null==(r=r[e.col]))||+(t>r)||-(t<r))),e.desc&&this.rows.reverse(),this.columns[e.col].sort=!0,this.columns[e.col].desc=e.desc)}addColumn(e){this.columnMap[e.text]||(this.columns.push(e),this.columnMap[e.text]=e)}addRow(e){this.rows.push(e)}constructor(e){if(re(this,"columns",void 0),re(this,"rows",void 0),re(this,"type",void 0),re(this,"columnMap",void 0),re(this,"refId",void 0),re(this,"meta",void 0),this.columns=[],this.columnMap={},this.rows=[],this.type="table",e){if(e.columns)for(const t of e.columns)this.addColumn(t);if(e.rows)for(const t of e.rows)this.addRow(t)}}}var ae=u(8531);function se(e,t,r,n,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ie(e,t,r[t])}))}return e}function le(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ue=e=>B(e)?`${H[e.type].label} ${e.field}`:H[e.type].label,ce=e=>Object.entries(e).reduce(((e,[t,r])=>{if(null==r)return oe({},e);if(Array.isArray(r)&&0===r.length)return oe({},e);if("string"==typeof r&&0===(null==r?void 0:r.length))return oe({},e);if(!Array.isArray(r)&&"object"==typeof r){const n=ce(r);return 0===Object.keys(n).length?oe({},e):le(oe({},e),{[t]:n})}return le(oe({},e),{[t]:r})}),{});function pe(){var e;return e=function*(e){const t=(new TextEncoder).encode(e),r=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map((e=>e.toString(16).padStart(2,"0"))).join("")},pe=function(){var t=this,r=arguments;return new Promise((function(n,a){var s=e.apply(t,r);function i(e){se(s,n,a,i,o,"next",e)}function o(e){se(s,n,a,i,o,"throw",e)}i(void 0)}))},pe.apply(this,arguments)}const de=(t,r,n,a,s,i)=>{const o=new e.MutableDataFrame({fields:[]});i&&(n===j.Lucene||r)&&o.addField({config:{filterable:!0},name:i,type:e.FieldType.time}),a&&o.addField({name:a,type:e.FieldType.string}),s&&o.addField({name:"level",type:e.FieldType.string});const l=o.fields.map((e=>e.name));for(const n of t)l.includes(n)||(r||"_source"!==n)&&o.addField({config:{filterable:!0},name:n,type:e.FieldType.string});return o};function fe(e){const t=(0,ae.getDataSourceSrv)();if(e.datasourceUid){const n=t.getInstanceSettings(e.datasourceUid);var r;return{title:"",url:"",internal:{query:{query:e.url},datasourceUid:e.datasourceUid,datasourceName:null!==(r=null==n?void 0:n.name)&&void 0!==r?r:"Data source not found"}}}return{title:"",url:e.url}}function ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function he(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ge(e,t,r[t])}))}return e}class me{processMetrics(e,t,r,n){let a;for(let s=0;s<t.metrics.length;s++){const i=t.metrics[s];if(!i.hide)switch(i.type){case"count":a={datapoints:[],metric:"count",props:n,refId:t.refId};for(let t=0;t<e.buckets.length;t++){const r=e.buckets[t],n=r.doc_count;a.datapoints.push([n,r.key])}r.push(a);break;case"percentiles":{if(0===e.buckets.length)break;const s=e.buckets[0][i.id].values;for(const o in s){a={datapoints:[],metric:"p"+o,props:n,field:i.field,refId:t.refId};for(let t=0;t<e.buckets.length;t++){const r=e.buckets[t],n=r[i.id].values;a.datapoints.push([n[o],r.key])}r.push(a)}break}case"extended_stats":for(const s in i.meta)if(i.meta[s]){a={datapoints:[],metric:s,props:n,field:i.field,refId:t.refId};for(let t=0;t<e.buckets.length;t++){const r=e.buckets[t],n=r[i.id];n.std_deviation_bounds_upper=n.std_deviation_bounds.upper,n.std_deviation_bounds_lower=n.std_deviation_bounds.lower,a.datapoints.push([n[s],r.key])}r.push(a)}break;default:a={datapoints:[],metric:i.type,metricId:i.id,props:n,refId:t.refId},B(i)&&(a.field=i.field);for(let t=0;t<e.buckets.length;t++){const r=e.buckets[t],n=r[i.id];void 0!==n&&(n.normalized_value?a.datapoints.push([n.normalized_value,r.key]):a.datapoints.push([n.value,r.key]))}r.push(a)}}}processAggregationDocs(e,t,n,a,s){if(0===a.columns.length){for(const e of r().keys(s))a.addColumn({text:e,filterable:!0});a.addColumn({text:t.field,filterable:!0})}const i=(e,t,r)=>{a.addColumn({text:t}),e.push(r)},o=r().isArray(e.buckets)?e.buckets:[e.buckets];for(const e of o){const t=[];for(const e of r().values(s))t.push(e);t.push(e.key);for(const a of n.metrics||[])switch(a.type){case"count":i(t,this.getMetricName(a.type),e.doc_count);break;case"extended_stats":for(const r in a.meta){if(!a.meta[r])continue;const n=e[a.id];n.std_deviation_bounds_upper=n.std_deviation_bounds.upper,n.std_deviation_bounds_lower=n.std_deviation_bounds.lower,i(t,this.getMetricName(r),n[r])}break;case"percentiles":{const r=e[a.id].values;for(const e in r)i(t,`p${e} ${a.field}`,r[e]);break}default:{let s=this.getMetricName(a.type);var l;r().filter(n.metrics,{type:a.type}).length>1&&(B(a)&&(s+=" "+a.field),"bucket_script"===a.type&&(s=(null===(l=a.settings)||void 0===l?void 0:l.script)||"")),i(t,s,e[a.id].value);break}}a.rows.push(t)}}processBuckets(e,t,n,a,s,i){let o,l,u,c;const p=t.bucketAggs.length-1;for(c in e)if(l=r().find(t.bucketAggs,{id:c}),u=e[c],l)if(i===p)"date_histogram"===l.type?this.processMetrics(u,t,n,s):this.processAggregationDocs(u,l,t,a,s);else for(const e in u.buckets)o=u.buckets[e],s=r().clone(s),void 0!==o.key?s[l.field]=o.key:s.filter=e,o.key_as_string&&(s[l.field]=o.key_as_string),this.processBuckets(o,t,n,a,s,i+1)}getMetricName(e){const t=Object.entries(H).filter((([t])=>t===e)).map((([e,t])=>t))[0];if(t)return t.label;const r=X.find((t=>t.value===e));return r?r.label:e}getSeriesName(e,t,n){let a=this.getMetricName(e.metric);if(t.alias){const r=/\{\{([\s\S]+?)\}\}/g;return t.alias.replace(r,((t,r,n)=>{const s=r||n;return 0===s.indexOf("term ")?e.props[s.substring(5)]:void 0!==e.props[s]?e.props[s]:"metric"===s?a:"field"===s?e.field||"":t}))}if(e.metric in Q)if(e.metric&&(s=e.metric,H[s].supportsMultipleBucketPaths)){const n=r().find(t.metrics,{id:e.metricId});if(n&&n.settings.script){a=n.settings.script;for(const e of n.pipelineVariables){const n=r().find(t.metrics,{id:e.pipelineAgg});n&&(a=a.replace("params."+e.name,ue(n)))}}else a="Unset"}else{const n=r().find(t.metrics,{id:e.field});n?a+=" "+ue(n):a="Unset"}else e.field&&(a+=" "+e.field);var s;if(0===r().keys(e.props).length)return a;let i="";for(const t in e.props)i+=e.props[t]+" ";return 1===n?i.trim():i.trim()+" "+a}nameSeries(e,t){const n=r().uniq(r().map(e,"metric")).length;for(let r=0;r<e.length;r++){const a=e[r];a.target=this.getSeriesName(a,t,n)}}processHits(e,t,r){const n="number"==typeof e.total?e.total:e.total.value,a={target:r.refId,type:"docs",refId:r.refId,datapoints:[],total:n,filterable:!0};let s,i,o,l;for(l=0;l<e.hits.length;l++){if(i=e.hits[l],o={_id:i._id,_type:i._type,_index:i._index},i._source)for(s in i._source)o[s]=i._source[s];for(s in i.fields)o[s]=i.fields[s];a.datapoints.push(o)}t.push(a)}trimDatapoints(e,t){const n=r().find(t.bucketAggs,{type:"date_histogram"});if(n&&n.settings&&n.settings.trimEdges){const t=n.settings.trimEdges;for(const r in e){const n=e[r];n.datapoints.length>2*t&&(n.datapoints=n.datapoints.slice(t,n.datapoints.length-t))}}}getErrorFromResponse(e,t){const r={};return r.data=JSON.stringify(t,null,4),t.root_cause&&t.root_cause.length>0&&t.root_cause[0].reason?r.message=t.root_cause[0].reason:r.message=t.reason||"Unknown OpenSearch error response",e.$$config&&(r.config=e.$$config),r}getInvalidPPLQuery(e){const t={message:"Invalid time series query"};return e.$$config&&(t.config=e.$$config),t}getTimeSeries(){return this.targetType===j.PPL?this.processPPLTimeSeries():this.targets.some((e=>{var t;return null===(t=e.metrics)||void 0===t?void 0:t.some((e=>"raw_data"===e.type))}))?this.processResponseToDataFrames(!1):this.processLuceneTimeSeries()}getLogs(e,t){return this.targetType===j.PPL?this.processPPLResponseToDataFrames(!0,e,t):this.processResponseToDataFrames(!0,e,t)}getTable(){return this.processPPLResponseToDataFrames(!1)}processResponseToDataFrames(t,r,n){var a;const s=[];for(let a=0;a<this.response.responses.length;a++){const i=this.response.responses[a];if(i.error)throw this.getErrorFromResponse(this.response,i.error);if(i.hits&&i.hits.hits.length>0){const{propNames:e,docs:o}=ye(i.hits.hits);if(o.length>0){let i=de(e,t,this.targetType,r,n,this.targets[0].timeField);for(const e of o)n&&(e.level=e[n]),i.add(e);t&&(i=Ee(i,"logs"));const l=this.targets[a];i.refId=l.refId,s.push(i)}}if(i.aggregations){const r=i.aggregations,n=this.targets[a],o=[],l=new ne;if(this.processBuckets(r,n,o,l,{},0),this.trimDatapoints(o,n),this.nameSeries(o,n),l.rows.length>0){const t=(0,e.toDataFrame)(l);t.refId=n.refId,s.push(t)}for(let r=0;r<o.length;r++){let a=(0,e.toDataFrame)(o[r]);t&&(a=Ee(a,"graph")),a.refId=n.refId,s.push(a)}}}return{data:s,key:null===(a=this.targets[0])||void 0===a?void 0:a.refId}}processPPLResponseToDataFrames(t,n,a){var s;if(this.response.error)throw this.getErrorFromResponse(this.response,this.response.error);const i=[],o=new Map(this.response.schema.map((e=>[e.name,e.type]))),l=r().map(this.response.datarows,(e=>r().zipObject([...o.keys()],e))),{flattenSchema:u,docs:c}=ve(l);if(l.length>0){let r=de(u,t,this.targetType,n,a,this.targets[0].timeField);for(const n of c){if(a&&(n.level=n[a]),!t)for(let[t,r]of o)"timestamp"!==r&&"datetime"!==r||(n[t]=(0,e.toUtc)(n[t]).local().format("YYYY-MM-DD HH:mm:ss.SSS"));r.add(n)}t&&(r=Ee(r,"logs"));const s=this.targets[0];r.refId=s.refId,i.push(r)}return{data:i,key:null===(s=this.targets[0])||void 0===s?void 0:s.refId}}constructor(t,r,n=j.Lucene){ge(this,"targets",void 0),ge(this,"response",void 0),ge(this,"targetType",void 0),ge(this,"processLuceneTimeSeries",void 0),ge(this,"processPPLTimeSeries",void 0),this.targets=t,this.response=r,this.targetType=n,this.processLuceneTimeSeries=()=>{var t;const r=[];for(let e=0;e<this.response.responses.length;e++){const t=this.response.responses[e],n=this.targets[e];if(t.error)throw this.getErrorFromResponse(this.response,t.error);if(t.hits&&t.hits.hits.length>0&&this.processHits(t.hits,r,n),t.aggregations){const n=t.aggregations,a=this.targets[e],s=[],i=new ne;i.refId=a.refId,this.processBuckets(n,a,s,i,{},0),this.trimDatapoints(s,a),this.nameSeries(s,a);for(let e=0;e<s.length;e++)r.push(s[e]);i.rows.length>0&&r.push(i)}}return{data:r.map((t=>(0,e.toDataFrame)(t))),key:null===(t=this.targets[0])||void 0===t?void 0:t.refId}},this.processPPLTimeSeries=()=>{var t;const r=this.targets[0],n=this.response,a=[];if(n.datarows.length>0){if(n.error)throw this.getErrorFromResponse(this.response,n.error);const{datapoints:e,targetVal:t,invalidTS:s}=be(n);if(s)throw this.getInvalidPPLQuery(this.response);const i={datapoints:e,props:n.schema,refId:r.refId,target:t};a.push(i)}return{data:a.map((t=>(0,e.toDataFrame)(t))),key:null===(t=this.targets[0])||void 0===t?void 0:t.refId}},this.targets=t,this.response=r,this.targetType=n}}const ye=e=>{const t=[];let r=[];for(const n of e){const e=n._source?U(n._source):{},a=he({_id:n._id,_type:n._type,_index:n._index,_source:he({},e)},e);for(const e of Object.keys(a))-1===r.indexOf(e)&&r.push(e);t.push(a)}return r.sort(),{docs:t,propNames:r}},ve=e=>{const t=[];let r=[];for(const n of e){const e=U(n);for(const t of Object.keys(e))-1===r.indexOf(t)&&r.push(t);t.push(e)}return{docs:t,flattenSchema:r}},be=t=>{var n;let a=!1;const s=r().findIndex(t.schema,(e=>"timestamp"===e.type||"datetime"===e.type||"date"===e.type)),i=0===s?1:0;return-1!==s&&2===t.datarows[0].length&&"number"==typeof t.datarows[0][i]||(a=!0),{datapoints:r().map(t.datarows,(t=>{const n=r().clone(t),[a]=n.splice(s,1);return n.push(1e3*(0,e.toUtc)(a).unix()),n})),targetVal:null===(n=t.schema[i])||void 0===n?void 0:n.name,invalidTS:a}},Ee=(e,t)=>{let r=e;return r.meta?r.meta.preferredVisualisationType=t:r.meta={preferredVisualisationType:t},r};function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const we={Hourly:{startOf:"hour",amount:"hours"},Daily:{startOf:"day",amount:"days"},Weekly:{startOf:"isoWeek",amount:"weeks"},Monthly:{startOf:"month",amount:"months"},Yearly:{startOf:"year",amount:"years"}};class Se{getIndexForToday(){return this.interval?(0,e.toUtc)().locale(this.dateLocale).format(this.pattern):this.pattern}getIndexList(t,r){if(!this.interval)return this.pattern;const n=we[this.interval],a=(0,e.dateTime)(t||(0,e.dateTime)(r).add(-7,n.amount)).utc().startOf(n.startOf),s=(0,e.dateTime)(r||(0,e.dateTime)(t).add(7,n.amount)).utc().startOf(n.startOf).valueOf(),i=[];for(;a.valueOf()<=s;)i.push(a.locale(this.dateLocale).format(this.pattern)),a.add(1,n.amount);return i}getPPLIndexPattern(){if(!this.interval)return this.pattern;let e=this.pattern.match(/\[(.*?)\]/)[1];return this.pattern.startsWith("[")?e+="*":this.pattern.endsWith("]")&&(e="*"+e),e}constructor(e,t){Oe(this,"pattern",void 0),Oe(this,"interval",void 0),Oe(this,"dateLocale",void 0),this.pattern=e,this.interval=t,this.dateLocale="en"}}var qe=u(8449);function Te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Te(e,t,r[t])}))}return e}class Ae{getRangeFilter(){const e={};return e[this.timeField]={gte:"$timeFrom",lte:"$timeTo",format:"epoch_millis"},e}buildTermsAgg(e,t,r){var n;let a;if(t.terms={field:e.field},!e.settings)return t;const s=(null===(n=e.settings)||void 0===n?void 0:n.size)?parseInt(e.settings.size,10):500;if(t.terms.size=0===s?500:s,void 0!==e.settings.orderBy&&(t.terms.order={},"_term"===e.settings.orderBy&&(this.flavor===k.Elasticsearch&&(0,qe.gte)(this.version,"6.0.0")||this.flavor===k.OpenSearch)?t.terms.order._key=e.settings.order:t.terms.order[e.settings.orderBy]=e.settings.order,a=parseInt(e.settings.orderBy,10),!isNaN(a)))for(let n of r.metrics||[])if(n.id===e.settings.orderBy){t.aggs={},t.aggs[n.id]={},B(n)&&(t.aggs[n.id][n.type]={field:n.field});break}return void 0!==e.settings.min_doc_count&&(t.terms.min_doc_count=parseInt(e.settings.min_doc_count,10),isNaN(t.terms.min_doc_count)&&(t.terms.min_doc_count=e.settings.min_doc_count)),e.settings.missing&&(t.terms.missing=e.settings.missing),t}getDateHistogramAgg(e){const t={},r=e.settings||{};return t.interval=r.interval,t.field=this.timeField,t.min_doc_count=r.min_doc_count||0,t.extended_bounds={min:"$timeFrom",max:"$timeTo"},t.format="epoch_millis",""!==r.offset&&(t.offset=r.offset),"auto"===t.interval&&(t.interval="$__interval"),t}getHistogramAgg(e){const t={},r=e.settings||{};return t.interval=r.interval,t.field=e.field,t.min_doc_count=r.min_doc_count||0,t}getFiltersAgg(e){var t;const r={};for(let{query:n,label:a}of(null===(t=e.settings)||void 0===t?void 0:t.filters)||[])r[a||n]={query_string:{query:n,analyze_wildcard:!0}};return r}documentQuery(e,t,r,n=!0){return e.size=t,n&&(e.sort={},e.sort[this.timeField]={order:r,unmapped_type:"boolean"}),this.flavor===k.Elasticsearch&&(0,qe.lt)(this.version,"5.0.0")&&(e.fields=["*","_source"]),e.script_fields={},e}addAdhocFilters(e,t){if(!t)return;let r,n,a,s;for(r=0;r<t.length;r++)switch(n=t[r],a={},a[n.key]=n.value,s={},s[n.key]={query:n.value},n.operator){case"=":e.query.bool.must||(e.query.bool.must=[]),e.query.bool.must.push({match_phrase:s});break;case"!=":e.query.bool.must_not||(e.query.bool.must_not=[]),e.query.bool.must_not.push({match_phrase:s});break;case"<":a[n.key]={lt:n.value},e.query.bool.filter.push({range:a});break;case">":a[n.key]={gt:n.value},e.query.bool.filter.push({range:a});break;case"=~":e.query.bool.filter.push({regexp:a});break;case"!~":e.query.bool.filter.push({bool:{must_not:{regexp:a}}})}}build(e,t,r){var n,a,s,i;let o,l,u,c,p;e.metrics=e.metrics||[Z()],e.bucketAggs=e.bucketAggs||[ee()],e.timeField=this.timeField,e.queryType=j.Lucene;const d={size:0,query:{bool:{filter:[{range:this.getRangeFilter()},{query_string:{analyze_wildcard:!0,query:r}}]}}};if(this.addAdhocFilters(d,t),0===e.bucketAggs.length&&(p=e.metrics[0],!p||"raw_document"!==p.type&&"raw_data"!==p.type))throw{message:"Invalid query"};if("raw_document"===(null===(a=e.metrics)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.type)||"raw_data"===(null===(i=e.metrics)||void 0===i||null===(s=i[0])||void 0===s?void 0:s.type)){var f,g,h;p=e.metrics[0];const t=(null===(f=p.settings)||void 0===f?void 0:f.size)?parseInt(p.settings.size,10):500,r=(null===(g=p.settings)||void 0===g?void 0:g.order)?p.settings.order:"desc",n=null===(h=p.settings)||void 0===h?void 0:h.useTimeRange;return n||d.query.bool.filter.shift(),this.documentQuery(d,t||500,r,n)}for(c=d,o=0;o<e.bucketAggs.length;o++){const t=e.bucketAggs[o],r={};switch(t.type){case"date_histogram":r.date_histogram=this.getDateHistogramAgg(t);break;case"histogram":r.histogram=this.getHistogramAgg(t);break;case"filters":r.filters={filters:this.getFiltersAgg(t)};break;case"terms":this.buildTermsAgg(t,r,e);break;case"geohash_grid":var m;r.geohash_grid={field:t.field,precision:null===(m=t.settings)||void 0===m?void 0:m.precision}}c.aggs=c.aggs||{},c.aggs[t.id]=r,c=r}for(c.aggs={},o=0;o<e.metrics.length;o++){if(p=e.metrics[o],"count"===p.type)continue;const t={};let r=null;if(G(p))if(Y(p)){if(!p.pipelineVariables)continue;for(r={buckets_path:{}},l=0;l<p.pipelineVariables.length;l++)if(u=p.pipelineVariables[l],u.name&&u.pipelineAgg&&/^\d*$/.test(u.pipelineAgg)){const t=te(e.metrics,u.pipelineAgg);t&&("count"===t.type?r.buckets_path[u.name]="_count":r.buckets_path[u.name]=u.pipelineAgg)}}else{if(!p.field||!/^\d*$/.test(p.field))continue;{const t=te(e.metrics,p.field);t&&(r="count"===t.type?{buckets_path:"_count"}:{buckets_path:p.field})}}else B(p)&&(r={field:p.field});r=Ie({},r,W(p)&&p.settings),t[p.type]=r,c.aggs[p.id]=t}return d}getTermsQuery(e){const t={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};e.query&&t.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:e.query}});let r=500;e.size&&(r=e.size),t.aggs={1:{terms:{field:e.field,script:e.script,size:r,order:{}}}};const{orderBy:n="key",order:a=("doc_count"===n?"desc":"asc")}=e;if(["asc","desc"].indexOf(a)<0)throw{message:`Invalid query sort order ${a}`};switch(n){case"key":case"term":const e=this.flavor===k.Elasticsearch&&(0,qe.lt)(this.version,"6.0.0")?"_term":"_key";t.aggs[1].terms.order[e]=a;break;case"doc_count":t.aggs[1].terms.order._count=a;break;default:throw{message:`Invalid query sort type ${n}`}}return t}getLogsQuery(e,t,r){let n={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};return this.addAdhocFilters(n,t),e.query&&n.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:r}}),n=this.documentQuery(n,500,"desc"),function(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}(Ie({},n),{aggs:this.build(e,null,r).aggs})}addPPLAdhocFilters(t,r){let n,a,s;for(n=0;n<r.length;n++)a=e.dateMath.isValid(r[n].value)?`timestamp('${(0,e.dateTime)(r[n].value).utc().format("YYYY-MM-DD HH:mm:ss.SSSSSS")}')`:"string"==typeof r[n].value?`'${r[n].value}'`:r[n].value,s=`\`${r[n].key}\` ${r[n].operator} ${a}`,t+=n>0?" and "+s:" | where "+s;return t}buildPPLQuery(e,t,r){e.format=e.format||"table",e.queryType=j.PPL,e.isLogsQuery="logs"===e.format,t&&(r=this.addPPLAdhocFilters(r,t));const n=" where $timestamp >= timestamp('$timeFrom') and $timestamp <= timestamp('$timeTo')";if(r){const e=r.indexOf("|");r=-1===e?[r.trimEnd(),n].join(" |"):[r.slice(0,e).trimEnd(),n,r.slice(e+1)].join(" |")}return{query:r}}constructor(e){Te(this,"timeField",void 0),Te(this,"version",void 0),Te(this,"flavor",void 0),this.timeField=e.timeField,this.version=e.version,this.flavor=e.flavor}}const Pe={terms:{label:"Terms",requiresField:!0,defaultSettings:{min_doc_count:"0",size:"10",order:"desc",orderBy:"_term"}},filters:{label:"Filters",requiresField:!1,defaultSettings:{filters:[{label:"",query:"*"}]}},geohash_grid:{label:"Geo Hash Grid",requiresField:!0,defaultSettings:{precision:"3"}},date_histogram:{label:"Date Histogram",requiresField:!0,defaultSettings:{interval:"auto",min_doc_count:"0",trimEdges:"0"}},histogram:{label:"Histogram",requiresField:!0,defaultSettings:{interval:"1000",min_doc_count:"0"}}},Re=[{label:"Top",value:"desc"},{label:"Bottom",value:"asc"}],Ne=[{label:"No limit",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"5",value:"5"},{label:"10",value:"10"},{label:"15",value:"15"},{label:"20",value:"20"}],_e=[{label:"Term value",value:"_term"},{label:"Doc Count",value:"_count"}],De=[{label:"auto",value:"auto"},{label:"10s",value:"10s"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"20m",value:"20m"},{label:"1h",value:"1h"},{label:"1d",value:"1d"}],Ce=e=>Pe[e.type].requiresField;var Le=u(5959),je=u.n(Le),ke=u(6089),xe=u(2007);function Fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Fe(e,t,r[t])}))}return e}function $e(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Ve={marginRight:ke.css`
    margin-right: 4px;
  `,queryWrapper:ke.css`
    display: flex;
    flex-grow: 1;
  `};function Ue(e){var t;const r=e.annotation,n=e.onAnnotationChange;return je().createElement(je().Fragment,null,je().createElement("div",{className:"gf-form-group"},je().createElement("div",{className:Ve.queryWrapper},je().createElement(xe.QueryField,{query:null===(t=r.target)||void 0===t?void 0:t.query,onBlur:()=>{},onChange:e=>{var t;const a=$e(Me({},null!==(t=r.target)&&void 0!==t?t:{refId:"annotation_query"}),{query:e});n($e(Me({},r),{target:a}))},placeholder:"Lucene Query",portalOrigin:"opensearch"}))),je().createElement("div",{className:"gf-form-group"},je().createElement("h6",null,"Field mappings"),je().createElement("div",{className:"gf-form-inline"},je().createElement("div",{className:`gf-form ${Ve.marginRight}`},je().createElement("span",{className:"gf-form-label"},"Time"),je().createElement(xe.Input,{type:"text",placeholder:"@timestamp",value:r.timeField,onChange:e=>{n($e(Me({},r),{timeField:e.currentTarget.value}))}})),je().createElement("div",{className:`gf-form ${Ve.marginRight}`},je().createElement("span",{className:"gf-form-label"},"Time End"),je().createElement(xe.Input,{type:"text",value:r.timeEndField,onChange:e=>{n($e(Me({},r),{timeEndField:e.currentTarget.value}))}}))," ",je().createElement("div",{className:`gf-form ${Ve.marginRight}`},je().createElement("span",{className:"gf-form-label"},"Text"),je().createElement(xe.Input,{type:"text",value:r.textField,onChange:e=>{n($e(Me({},r),{textField:e.currentTarget.value}))}})),je().createElement("div",{className:`gf-form ${Ve.marginRight}`},je().createElement("span",{className:"gf-form-label"},"Tags"),je().createElement(xe.Input,{type:"text",placeholder:"tags",value:r.tagsField,onChange:e=>{n($e(Me({},r),{tagsField:e.currentTarget.value}))}})))))}function Be(t,r,n){if(n!==e.CoreApp.Dashboard&&n!==e.CoreApp.PanelViewer)for(const e of r)try{(0,ae.reportInteraction)("grafana_opensearch_query_executed",{app:n,with_lucene_query:e.queryType===j.Lucene,with_ppl_query:e.queryType===j.PPL,query_type:Ge(e),has_data:t.data.some((e=>{var t;return(null===(t=e.datapoints)||void 0===t?void 0:t.length)>0})),has_error:void 0!==t.error,simultaneously_sent_query_count:r.length,alias:e.alias})}catch(e){console.error("error while reporting opensearch query",e)}}function Ge(e){if(e.metrics&&e.metrics.length)return e.isLogsQuery?"logs":e.luceneQueryType===x.Traces?e.serviceMap?"traces with service map":"traces":e.queryType===j.PPL?"table"===e.format?"raw_data":"metric":["raw_data","raw_document"].includes(e.metrics[0].type)?e.metrics[0].type:"metric"}function Ye(e,t,r,n,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function We(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){We(e,t,r[t])}))}return e}function Qe(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const{Select:Ke,Input:ze,FormField:Xe,Switch:Je}=xe.LegacyForms,Ze=[{label:"No pattern",value:"none"},{label:"Hourly",value:"Hourly",example:"[logstash-]YYYY.MM.DD.HH"},{label:"Daily",value:"Daily",example:"[logstash-]YYYY.MM.DD"},{label:"Weekly",value:"Weekly",example:"[logstash-]GGGG.WW"},{label:"Monthly",value:"Monthly",example:"[logstash-]YYYY.MM"},{label:"Yearly",value:"Yearly",example:"[logstash-]YYYY"}],et=e=>{const{value:t,onChange:r,saveOptions:n,datasource:a}=e,[s,i]=(0,Le.useState)(""),o=(l=function*(){i(""),yield n();try{if(a){const e=yield a.getOpenSearchVersion();yield n(Qe(He({},t),{jsonData:Qe(He({},t.jsonData),{version:e.version,flavor:e.flavor,versionLabel:e.label,maxConcurrentShardRequests:at(e.flavor,e.version,t.jsonData.maxConcurrentShardRequests)})}))}}catch(e){let t=String(e);e instanceof Error&&(t=e.message),i(t)}},u=function(){var e=this,t=arguments;return new Promise((function(r,n){var a=l.apply(e,t);function s(e){Ye(a,r,n,s,i,"next",e)}function i(e){Ye(a,r,n,s,i,"throw",e)}s(void 0)}))},function(){return u.apply(this,arguments)});var l,u;let c=t.jsonData.versionLabel;var p,d,f;return!c&&t.jsonData.flavor&&t.jsonData.version&&(c=`${(null===(p=ct.find((e=>e.value===t.jsonData.flavor)))||void 0===p?void 0:p.label)||t.jsonData.flavor} ${t.jsonData.version}`),je().createElement(je().Fragment,null,je().createElement("h3",{className:"page-heading"},"OpenSearch details"),!t.jsonData.serverless&&je().createElement(xe.Alert,{title:"When the connected OpenSearch instance is upgraded, the configured version should be updated.",severity:"info"},je().createElement(xe.VerticalGroup,null,je().createElement("div",null,"The plugin uses the configured version below to construct the queries it sends to the connected OpenSearch instance. If the configured version does not match the instance version, there could be query errors."))),s&&je().createElement(xe.Alert,{title:s,severity:"error"}),je().createElement("div",{className:"gf-form-group"},je().createElement("div",{className:"gf-form-inline"},je().createElement("div",{className:"gf-form"},je().createElement(Xe,{labelWidth:10,inputWidth:15,label:"Index name",value:t.jsonData.database||"",onChange:tt("database",t,r),placeholder:"es-index-name",required:!0})),je().createElement("div",{className:"gf-form"},je().createElement(Xe,{labelWidth:10,label:"Pattern",inputEl:je().createElement(Ke,{"aria-label":"Pattern",options:Ze,onChange:nt(t,r),value:Ze.find((e=>e.value===(void 0===t.jsonData.interval?"none":t.jsonData.interval)))})}))),je().createElement("div",{className:"gf-form max-width-25"},je().createElement(Xe,{labelWidth:10,inputWidth:15,label:"Time field name",value:t.jsonData.timeField||"",onChange:tt("timeField",t,r),required:!0})),je().createElement("div",{className:"gf-form-inline"},je().createElement(Je,{label:"Serverless",labelClass:"width-10",tooltip:"If this is a DataSource to query a serverless OpenSearch service.",checked:null!==(d=t.jsonData.serverless)&&void 0!==d&&d,onChange:e=>{r((e=>(i(""),Qe(He({},t),{jsonData:Qe(He({},t.jsonData),{serverless:e.currentTarget.checked,flavor:k.OpenSearch,version:"1.0.0",maxConcurrentShardRequests:5,pplEnabled:!e.currentTarget.checked})})))(e))}})),!t.jsonData.serverless&&je().createElement("div",{className:"gf-form"},je().createElement(Xe,{labelWidth:10,inputWidth:15,label:"Version",value:c,placeholder:"version required",disabled:!0,required:!0}),je().createElement(xe.Button,{onClick:o,variant:"secondary"},"Get Version and Save")),function(e){const{flavor:t,version:r,serverless:n}=e;return!n&&(!(!t||!r)&&(t===k.OpenSearch||(0,qe.gte)(r,"5.6.0")))}(t.jsonData)&&je().createElement("div",{className:"gf-form max-width-30"},je().createElement(Xe,{"aria-label":"Max concurrent Shard Requests input",labelWidth:15,label:"Max concurrent Shard Requests",value:t.jsonData.maxConcurrentShardRequests||"",onChange:tt("maxConcurrentShardRequests",t,r)})),je().createElement("div",{className:"gf-form-inline"},je().createElement("div",{className:"gf-form"},je().createElement(Xe,{labelWidth:10,label:"Min time interval",inputEl:je().createElement(ze,{className:"width-6",value:t.jsonData.timeInterval||"",onChange:tt("timeInterval",t,r),placeholder:"10s",validationEvents:{[xe.EventsWithValidation.onBlur]:[(0,xe.regexValidation)(/^\d+(ms|[Mwdhmsy])$/,"Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s")]}}),tooltip:je().createElement(je().Fragment,null,"A lower limit for the auto group by time interval. Recommended to be set to write frequency, for example ",je().createElement("code",null,"1m")," if your data is written every minute.")}))),!t.jsonData.serverless&&je().createElement("div",{className:"gf-form"},je().createElement(Je,{label:"PPL enabled",labelClass:"width-10",tooltip:"Allow Piped Processing Language as an alternative query syntax in the OpenSearch query editor.",checked:null===(f=t.jsonData.pplEnabled)||void 0===f||f,onChange:rt("pplEnabled",t,r)}))))},tt=(e,t,r)=>n=>{r(Qe(He({},t),{jsonData:Qe(He({},t.jsonData),{[e]:n.currentTarget.value})}))},rt=(e,t,r)=>n=>{r(Qe(He({},t),{jsonData:Qe(He({},t.jsonData),{[e]:n.currentTarget.checked})}))},nt=(e,t)=>r=>{const{database:n}=e,a="none"===r.value?void 0:r.value;if(!n||0===n.length||n.startsWith("[logstash-]")){let r="";if(void 0!==a){const e=Ze.find((e=>e.value===a));var s;e&&(r=null!==(s=e.example)&&void 0!==s?s:"")}t(Qe(He({},e),{database:r,jsonData:Qe(He({},e.jsonData),{interval:a})}))}else t(Qe(He({},e),{jsonData:Qe(He({},e.jsonData),{interval:a})}))};function at(e,t,r){return 5===r&&(0,qe.lt)(t,"7.0.0")&&e===k.Elasticsearch?256:256===r&&((0,qe.gte)(t,"7.0.0")&&e===k.Elasticsearch||e===k.OpenSearch)?5:r||st(e,t)}function st(e,t){return e&&t?(0,qe.lt)(t,"7.0.0")&&e===k.Elasticsearch?256:5:0}function it(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){it(e,t,r[t])}))}return e}function lt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ut=e=>{let t=(0,qe.valid)(e.jsonData.version)||"",r=e.jsonData.flavor;var n;return e.jsonData.serverless&&(r=k.OpenSearch,t="1.0.0"),lt(ot({},e),{jsonData:lt(ot({},e.jsonData),{timeField:e.jsonData.timeField||"@timestamp",version:t,flavor:r,maxConcurrentShardRequests:e.jsonData.maxConcurrentShardRequests||st(r,t),logMessageField:e.jsonData.logMessageField||"",logLevelField:e.jsonData.logLevelField||"",pplEnabled:null===(n=e.jsonData.pplEnabled)||void 0===n||n})})},ct=(k.OpenSearch,k.Elasticsearch,k.Elasticsearch,k.Elasticsearch,k.Elasticsearch,k.Elasticsearch,[{label:"OpenSearch",value:k.OpenSearch},{label:"ElasticSearch",value:k.Elasticsearch}]);function pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const dt=(e,r)=>{function n(e,r){const n=r.map((e=>{var r,n;const a=e._source,s={};Object.keys(a).map((e=>{(0,t.set)(s,e,a[e])}));const i=!!s.events&&s.events.some((e=>e.attributes.error));var o,l;return function(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){pt(e,t,r[t])}))}return e}({parentSpanID:s.parentSpanId,traceID:s.traceId,spanID:s.spanId,operationName:s.name,startTime:new Date(s.startTime).getTime(),duration:1e-6*s.durationInNanos,serviceName:s.serviceName,tags:[...ft(null!==(o=null===(r=s.span)||void 0===r?void 0:r.attributes)&&void 0!==o?o:{}),{key:"error",value:i}],serviceTags:(null===(n=s.resource)||void 0===n?void 0:n.attributes)?ft(s.resource.attributes):[]},i?{stackTraces:(l=s.events,l.filter((e=>e.attributes.error)).map((e=>`${e.name}: ${e.attributes.error}`)))}:{}),{logs:s.events.length?gt(s.events):[]})}));let a=de(["traceID","serviceName","parentSpanID","spanID","operationName","startTime","duration","tags","serviceTags","stackTraces","logs"],!1,j.Lucene);const s=[];for(const e of n)a.add(e);return a.refId=e.refId,a=Ee(a,"trace"),s.push(a),s}return{data:e.flatMap(((e,t)=>n(e,r.responses[t].hits.hits)))}};function ft(e){return Object.keys(e).map((t=>({key:t,value:e[t]})))}function gt(e){return e.map((e=>({timestamp:new Date(e.time).getTime(),fields:[{key:"name",value:e.name}]})))}const ht=e=>{const t=e.match(RegExp("(?<=traceId:).*$"));return t?t[0].trim():""};var mt=u(4421);function yt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){yt(e,t,r[t])}))}return e}function bt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Et(e,t,r,n=""){return Ot(e,t,r,n)?e:wt(e,`${n}${t=At(t)}:"${r=Pt(r)}"`)}function Ot(e,t,r,n=""){return null!==qt(e,t,r,n)}function wt(e,t,r="AND"){return t?""===e.trim()?t:`${e} ${r} ${t}`:e}function St(e,t,r,n=""){const a=qt(e,t,r,n),s=Ct(e);return a&&s?mt.toString(It(s,a)):e}function qt(e,t,r,n=""){const a=`${n}${mt.term.escape(t)}`;r=mt.phrase.escape(r);let s=Ct(e);return s?Tt(s,a,r):null}function Tt(e,t,r){return 0===Object.keys(e).length?null:_t(e.left)?Tt(e.left,t,r):Dt(e.left)&&e.left.field===t&&e.left.term===r?e.left:Rt(e)?null:Dt(e.right)&&e.right.field===t&&e.right.term===r?e.right:Nt(e.right)?Tt(e.right,t,r):null}function It(e,r){return 0===Object.keys(e).length?e:_t(e.left)?(e.left=It(e.left,r),e):Dt(e.left)&&(0,t.isEqual)(e.left,r)?(Object.assign(e,{left:void 0,operator:void 0,right:void 0},"right"in e?e.right:{}),e):Rt(e)?e:Dt(e.right)&&(0,t.isEqual)(e.right,r)?(Object.assign(e,{right:void 0,operator:void 0}),e):Nt(e.right)?(e.right=It(e.right,r),e):e}function At(e){return mt.term.escape(e)}function Pt(e){return e=e.replace(/\\/g,"\\\\"),mt.phrase.escape(e)}function Rt(e){return!(!e||"object"!=typeof e)&&"left"in e&&!("right"in e)}function Nt(e){return!(!e||"object"!=typeof e)&&"left"in e&&"right"in e}function _t(e){return Rt(e)||Nt(e)}function Dt(e){return!(!e||"object"!=typeof e||!("term"in e))}function Ct(e){try{return mt.parse(function(e){return e.replace(/(\w+)\s(:)/gi,"$1$2")}(e))}catch(e){return null}}function Lt(t){let r="";return"=~"===t.operator||"!~"===t.operator?"":(r=e.dateMath.isValid(t.value)?`timestamp('${(0,e.dateTime)(t.value).utc().format("YYYY-MM-DD HH:mm:ss.SSSSSS")}')`:"string"==typeof t.value&&function(e){return isNaN(Number(e))}(t.value)?`'${t.value}'`:t.value,`\`${t.key}\` ${t.operator} ${r}`)}function jt(e,t,r){if(!t.key||!t.value)return e;const n=Lt(t);if(""!==n){if(""===e)return n;e+=r&&r>0?" and "+n:" | where "+n}return e}function kt(e,t){const r=Lt(t);return e.replace(` | where ${r}`,"")}function xt(e,t){const r=Lt(t);return e.includes(r)}function Ft(e,t){let r=e;switch(t.type){case"FILTER_FOR":r=Ot(r,t.options.key,t.options.value)?St(r,t.options.key,t.options.value):Et(r,t.options.key,t.options.value);break;case"FILTER_OUT":Ot(r,t.options.key,t.options.value)&&(r=St(r,t.options.key,t.options.value)),r=Et(r,t.options.key,t.options.value,"-")}return r}function Mt(e,t){let r=e;switch(t.type){case"FILTER_FOR":{const e={key:t.options.key,value:t.options.value,operator:"="};r=xt(r,e)?kt(r,e):jt(r,e);break}case"FILTER_OUT":{const e={key:t.options.key,value:t.options.value,operator:"!="},n=bt(vt({},e),{operator:"="});xt(r,n)&&(r=kt(r,n)),r=jt(r,e);break}}return r}function $t(e,t,r,n,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function Vt(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var s=e.apply(t,r);function i(e){$t(s,n,a,i,o,"next",e)}function o(e){$t(s,n,a,i,o,"throw",e)}i(void 0)}))}}function Ut(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ut(e,t,r[t])}))}return e}function Gt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Yt=["_index","_type","_id","_source","_size","_field_names","_ignored","_routing","_meta"];class Wt extends ae.DataSourceWithBackend{request(e,t,r,n){var a=this;return Vt((function*(){const s={url:a.url+"/"+t,method:e,data:r};return s.headers=null!=n?n:{},(a.basicAuth||a.withCredentials)&&(s.withCredentials=!0),a.basicAuth&&(s.headers.Authorization=a.basicAuth),a.sigV4Auth&&r&&(s.headers["x-amz-content-sha256"]=yield function(e){return pe.apply(this,arguments)}(r)),(0,ae.getBackendSrv)().datasourceRequest(s).catch((e=>{if(e.data){var t,r,n;const a=null!==(n=null!==(r=null===(t=e.data.error)||void 0===t?void 0:t.reason)&&void 0!==r?r:e.data.message)&&void 0!==n?n:"Unknown error";throw new Error("OpenSearch error: "+a)}throw e}))}))()}get(t,n=(0,e.getDefaultTimeRange)()){const a=this.indexPattern.getIndexList(n.from,n.to);return r().isArray(a)&&a.length?this.requestAllIndices(a,t).then((e=>(e.data.$$config=e.config,e.data))):this.request("GET",this.indexPattern.getIndexForToday()+t).then((e=>(e.data.$$config=e.config,e.data)))}requestAllIndices(e,t){var r=this;return Vt((function*(){const n=e.length;for(let a=0;a<Math.min(n,7);a++)try{return yield r.request("GET",e[n-a-1]+t)}catch(e){if(404!==e.status||6===a)throw e}}))()}postMultiSearch(e,t){return this.post(e,t,{"Content-Type":"application/x-ndjson"})}post(e,t,r){return this.request("POST",e,t,r).then((e=>(e.data.$$config=e.config,e.data)))}annotationQuery(t){const n=t.annotation,a=n.timeField||"@timestamp",s=n.timeEndField||null,i=n.query||n.target.query,o=n.tagsField||"tags",l=n.textField||null,u=[],c={};if(c[a]={from:t.range.from.valueOf(),to:t.range.to.valueOf(),format:"epoch_millis"},u.push({range:c}),s){const e={};e[s]={from:t.range.from.valueOf(),to:t.range.to.valueOf(),format:"epoch_millis"},u.push({range:e})}const p={query:{bool:{filter:[{bool:{should:u,minimum_should_match:1}},{query_string:{query:(0,ae.getTemplateSrv)().replace(i,{},"lucene")}}]}},size:1e4};this.flavor===k.Elasticsearch&&(0,qe.lt)(this.version,"5.0.0")&&(p.fields=[a,"_source"]);const d={search_type:"query_then_fetch",ignore_unavailable:!0};n.index?d.index=n.index:d.index=this.indexPattern.getIndexList(t.range.from,t.range.to);const f=JSON.stringify(d)+"\n"+JSON.stringify(p)+"\n";return this.postMultiSearch("_msearch",f).then((t=>{const i=[],u=t.responses[0].hits.hits,c=(e,t)=>{if(!t)return;const r=t.split(".");let n=e;for(let e=0;e<r.length;e++)if(n=n[r[e]],!n)return console.log("could not find field in annotation: ",t),"";return n};for(let t=0;t<u.length;t++){const p=u[t]._source;let d=c(p,a);if(void 0!==u[t].fields){const e=u[t].fields;(r().isString(e[a])||r().isNumber(e[a]))&&(d=e[a])}const f={annotation:n,time:(0,e.toUtc)(d).valueOf(),text:c(p,l),tags:c(p,o)};if(s){const t=c(p,s);t&&(f.timeEnd=(0,e.toUtc)(t).valueOf())}if(n.titleField){const e=c(p,n.titleField);e&&(f.text=e+"\n"+f.text)}"string"==typeof f.tags&&(f.tags=f.tags.split(",")),i.push(f)}return i}))}toggleQueryFilter(e,t){return e.queryType===j.Lucene?Gt(Bt({},e),{query:Ft(e.query||"",t)}):Gt(Bt({},e),{query:Mt(e.query||"",t)})}queryHasFilter(e,t){if(e.queryType===j.PPL){const r={key:t.key,value:t.value,operator:"FILTER_FOR"===t.type?"=":"!="};return xt(e.query||"",r)}return Ot(e.query||"",t.key,t.value)}interpolateLuceneQuery(e,t){return this.templateSrv.replace(e,t,"lucene")}interpolatePPLQuery(e,t){return this.templateSrv.replace(e,t,"pipe")}interpolateVariablesInQueries(e,t,r){return e.map((e=>this.applyTemplateVariables(e,t,r)))}applyTemplateVariables(e,t,r){let n;n=e.queryType===j.PPL?this.interpolatePPLQuery(e.query||"",t):this.interpolateLuceneQuery(e.query||"*",t);for(let r of e.bucketAggs||[]){var a;if("filters"===r.type)for(let e of(null===(a=r.settings)||void 0===a?void 0:a.filters)||[])e.query=this.interpolateLuceneQuery(e.query,t)||"*"}const s=(null==r?void 0:r.length)?this.addAdHocFilters(Gt(Bt({},e),{query:n}),r):n;return JSON.parse(this.templateSrv.replace(JSON.stringify(Gt(Bt({},e),{query:s})),t))}addAdHocFilters(e,t){if(e.queryType===j.PPL){let r=e.query||"";return t.forEach(((e,t)=>{r=jt(r,e,t)})),r}var r;let n=null!==(r=e.query)&&void 0!==r?r:"";return t.forEach((e=>{n=function(e,t){if(!t.key||!t.value)return e;if(t=bt(vt({},t),{value:t.value.toString()}),["=","!="].includes(t.operator))return Et(e,t.key,t.value,"="===t.operator?"":"-");const r=At(t.key),n=Pt(t.value);let a="";switch(t.operator){case"=~":a=`${r}:/${n}/`;break;case"!~":a=`-${r}:/${n}/`;break;case">":a=`${r}:>${n}`;break;case"<":a=`${r}:<${n}`}return wt(e,a)}(n,e)})),n||"*"}testDatasource(){return this.flavor&&(0,qe.valid)(this.version)?this.getFields("date").then((e=>r().find(e,{text:this.timeField})?{status:"success",message:"Index OK. Time field name OK."}:{status:"success",message:"Index OK. Note: No date field named "+this.timeField+" found"}),(e=>(console.error(e),e.message?{status:"error",message:e.message}:{status:"error",message:e.status}))):Promise.resolve({status:"error",message:"No version set"})}getQueryHeader(e,t,r){const n={search_type:e,ignore_unavailable:!0,index:this.indexPattern.getIndexList(t,r)};return this.flavor===k.Elasticsearch&&(0,qe.satisfies)(this.version,">=5.6.0 <7.0.0")&&(n.max_concurrent_shard_requests=this.maxConcurrentShardRequests),JSON.stringify(n)}getQueryDisplayText(e){const t=e.metrics,r=e.bucketAggs;let n="";return e.query&&(n+="Query: "+e.query+", "),n+="Metrics: ",n+=null==t?void 0:t.reduce(((e,t)=>{let r=H[t.type].label+"(";var n,a;return B(t)&&(r+=t.field),Y(t)&&(r+=null===(a=t.settings)||void 0===a||null===(n=a.script)||void 0===n?void 0:n.replace(new RegExp("params.","g"),"")),r+="), ",`${e} ${r}`}),""),n+=null==r?void 0:r.reduce(((e,t,r)=>{let n="";return 0===r&&(n+=" Group by: "),n+=Pe[t.type].label+"(",Ce(t)&&(n+=t.field),`${e} ${n}), `}),""),e.alias&&(n+="Alias: "+e.alias),n}query(t){const{openSearchBackendFlowEnabled:r}=ae.config.featureToggles;if(t.app===e.CoreApp.Explore||r)return super.query(t).pipe($({next:e=>{Be(e,t.targets,t.app)},error:e=>{Be({error:e,data:[]},t.targets,t.app)}}),V((e=>{return t=e,r=this.dataLinks,n=this.uid,a=this.name,s=this.type,le(oe({},t),{data:t.data.map((e=>function(e,t,r,n,a){const s=t.length>0,i="Trace List"===e.name&&e.fields.some((e=>{var t;return null===(t=e.config.links)||void 0===t?void 0:t.some((e=>"Trace: ${__value.raw}"===e.title&&!e.internal&&!e.url))}));if(!s&&!i)return e;const o=oe({},e);if(s){const e=o.fields.map((e=>{const r=t.filter((t=>new RegExp(t.field).test(e.name)));return 0===r.length?e:le(oe({},e),{config:le(oe({},e.config),{links:[...e.config.links||[],...r.map(fe)]})})}));o.fields=e}if(i){const e=o.fields.map((e=>{var t;if("Trace Id"!==e.name)return e;const s=null===(t=e.config.links)||void 0===t?void 0:t.map((e=>"Trace: ${__value.raw}"!==e.title||e.internal||e.url?e:{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:r,datasourceName:n,query:{datasource:{uid:r,type:a},query:"traceId: ${__value.raw}",luceneQueryType:x.Traces,queryType:j.Lucene,metrics:[Z()],bucketAggs:[ee()]}}}));return le(oe({},e),{config:le(oe({},e.config),{links:s})})}));o.fields=e}return o}(e,r,n,a,s)))});var t,r,n,a,s})));const a=t.targets.map((e=>e.queryType===j.PPL?Gt(Bt({},e),{query:this.templateSrv.replace(e.query,t.scopedVars,"pipe")}):Gt(Bt({},e),{query:this.templateSrv.replace(e.query,t.scopedVars,"lucene")||"*"}))),s=[],i=[];for(const e of a)if(!e.hide)switch(e.queryType){case j.PPL:i.push(e);break;case j.Lucene:default:s.push(e)}const o=[];if(s.length){const e=this.executeLuceneQueries(s,t);o.push(e)}if(i.length){const e=this.executePPLQueries(i,t);o.push(e)}return 0===o.length?(0,n.of)({data:[],state:e.LoadingState.Done}):(0,n.merge)(...o).pipe($({next:e=>{Be(e,[...i,...s],t.app)},error:e=>{Be({error:e,data:[]},[...i,...s],t.app)}}))}executeLuceneQueries(t,r){const a=e=>{let t="";for(const n of e)t+=this.createLuceneQuery(n,r);return t=t.replace(/"\$timeFrom"/g,r.range.from.valueOf().toString()),t=t.replace(/"\$timeTo"/g,r.range.to.valueOf().toString()),t=(0,ae.getTemplateSrv)().replace(t,r.scopedVars),t},s=t.filter((e=>e.luceneQueryType===x.Traces&&!ht(e.query||""))),i=t.filter((e=>e.luceneQueryType===x.Traces&&ht(e.query||""))),o=t.filter((e=>e.luceneQueryType!==x.Traces)),l=[s.length>0?(0,n.from)(this.postMultiSearch(this.getMultiSearchUrl(),a(s))).pipe(V((t=>((t,r,n,a,s)=>{const i=r.responses.map(((r,i)=>function(t,r){const i=[],o=[],l=[],u=[],c=[];t.aggregations.traces.buckets.forEach((e=>{i.push(e.key),o.push(e.trace_group.buckets[0].key),l.push(e.latency.value),u.push(e.error_count.doc_count),c.push(e.last_updated.value)}));const p={meta:{preferredVisualisationType:"table"},refId:r,fields:[{name:"Trace Id",type:e.FieldType.string,values:i,config:{links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:n,datasourceName:a,query:{datasource:{uid:n,type:s},query:"traceId: ${__value.raw}",luceneQueryType:x.Traces}}}]}},{name:"Trace Group",type:e.FieldType.string,values:o},{name:"Latency (ms)",type:e.FieldType.number,values:l},{name:"Error Count",type:e.FieldType.number,values:u},{name:"Last Updated",type:e.FieldType.time,values:c}]};return new e.MutableDataFrame(p)}(r,t[i].refId)));return{data:i}})(s,t,this.uid,this.name,this.type)))):null,i.length>0?(0,n.from)(this.postMultiSearch(this.getMultiSearchUrl(),a(i))).pipe(V((e=>dt(i,e)))):null,o.length>0?(0,n.from)(this.postMultiSearch(this.getMultiSearchUrl(),a(o))).pipe(V((e=>{const t=new me(o,e);if(o.some((e=>e.isLogsQuery))){const e=t.getLogs(this.logMessageField,this.logLevelField);for(const t of e.data)Ht(t,this.dataLinks);return e}return t.getTimeSeries()}))):null].flatMap((e=>null!==e?e:[]));return(0,n.merge)(...l)}executePPLQueries(t,r){const a=[];for(const s of t){let i=this.createPPLQuery(s,r);const o=(0,e.dateTime)(r.range.from.valueOf()).utc().format("YYYY-MM-DD HH:mm:ss"),l=(0,e.dateTime)(r.range.to.valueOf()).utc().format("YYYY-MM-DD HH:mm:ss");i=i.replace(/\$timeTo/g,l),i=i.replace(/\$timeFrom/g,o),i=i.replace(/\$timestamp/g,`\`${this.timeField}\``),a.push((0,n.from)(this.post(this.getPPLUrl(),i)).pipe(V((e=>{const r=new me([s],e,j.PPL);if(t.some((e=>e.isLogsQuery))){const e=r.getLogs(this.logMessageField,this.logLevelField);for(const t of e.data)Ht(t,this.dataLinks);return e}return t.some((e=>"table"===e.format))?r.getTable():r.getTimeSeries()}))))}return(0,n.merge)(...a)}createLuceneQuery(e,t){let r=(0,ae.getTemplateSrv)().replace(e.query,t.scopedVars,"lucene");const n=(0,ae.getTemplateSrv)().getAdhocFilters(this.name);let a;e.luceneQueryType===x.Traces?a=(e=>{const t=ht(e);return t?(e=>({size:1e3,query:{bool:{must:[{range:{startTime:{gte:"$timeFrom",lte:"$timeTo"}}},{term:{traceId:e}}],filter:[],should:[],must_not:[]}}}))(t):(e=>({size:10,query:{bool:{must:[{range:{startTime:{gte:"$timeFrom",lte:"$timeTo"}}},{query_string:{analyze_wildcard:!0,query:e||"*"}}],filter:[],should:[],must_not:[]}},aggs:{traces:{terms:{field:"traceId",size:100,order:{_key:"asc"}},aggs:{latency:{max:{script:{source:"\n                if (doc.containsKey('traceGroupFields.durationInNanos') && !doc['traceGroupFields.durationInNanos'].empty) {\n                  return Math.round(doc['traceGroupFields.durationInNanos'].value / 10000) / 100.0\n                }\n                return 0\n                ",lang:"painless"}}},trace_group:{terms:{field:"traceGroup",size:1}},error_count:{filter:{term:{"traceGroupFields.statusCode":"2"}}},last_updated:{max:{field:"traceGroupFields.endTime"}}}}}}))(e)})(e.query||""):e.isLogsQuery||function(e){return e&&e.metrics&&e.metrics.some((e=>"logs"===e.type))}(e)?(e.bucketAggs=[ee()],e.metrics=[],e.isLogsQuery=!0,a=this.queryBuilder.getLogsQuery(e,n,r)):(e.alias&&(e.alias=(0,ae.getTemplateSrv)().replace(e.alias,t.scopedVars,"lucene")),a=this.queryBuilder.build(e,n,r));const s=JSON.stringify(a),i=0===a.size&&(0,qe.lt)(this.version,"5.0.0")&&this.flavor===k.Elasticsearch?"count":"query_then_fetch";return this.getQueryHeader(i,t.range.from,t.range.to)+"\n"+s+"\n"}createPPLQuery(e,t){let r,n=(0,ae.getTemplateSrv)().replace(e.query,t.scopedVars,"pipe");const a=(0,ae.getTemplateSrv)().getAdhocFilters(this.name);return n||(n=`source=\`${this.indexPattern.getPPLIndexPattern()}\``),r=this.queryBuilder.buildPPLQuery(e,a,n),JSON.stringify(r)}getOpenSearchVersion(){var e=this;return Vt((function*(){return yield e.request("GET","/").then((e=>{var t;const r={flavor:"opensearch"===e.data.version.distribution?k.OpenSearch:k.Elasticsearch,version:e.data.version.number};if(r.label=`${(null===(t=ct.find((e=>e.value===r.flavor)))||void 0===t?void 0:t.label)||r.flavor} ${r.version}`,r.flavor===k.Elasticsearch&&(0,qe.gte)(r.version,"7.11.0"))throw new Error("ElasticSearch version "+r.version+" is not supported by the OpenSearch plugin. Use the ElasticSearch plugin.");return r.flavor===k.Elasticsearch&&"7.10.2"===r.version&&"The OpenSearch Project: https://opensearch.org/"===e.data.tagline&&(r.flavor=k.OpenSearch,r.version="1.0.0",r.label="OpenSearch (compatibility mode)"),r}))}))()}isMetadataField(e){return Yt.includes(e)}getFields(e,t){var n=this;return Vt((function*(){return n.get("/_mapping",t).then((t=>{const a={float:"number",double:"number",integer:"number",long:"number",date:"date",date_nanos:"date",string:"string",text:"string",scaled_float:"number",nested:"nested"},s=(t,r)=>!(n.isMetadataField(r)||e&&e!==t.type&&e!==a[t.type]),i=[],o={};function l(e){for(const t in e){const n=e[t];if(r().isObject(n.properties)&&(i.push(t),l(n.properties)),r().isObject(n.fields)&&(i.push(t),l(n.fields)),r().isString(n.type)){const e=i.concat(t).join(".");s(n,t)&&(o[e]={text:e,type:n.type})}}i.pop()}for(const e in t){const r=t[e];if(r&&r.mappings){const e=r.mappings;if(n.flavor===k.Elasticsearch&&(0,qe.lt)(n.version,"7.0.0"))for(const t in e)l(e[t].properties);else l(e.properties)}}return r().map(o,(e=>e))}))}))()}getTerms(t,n=(0,e.getDefaultTimeRange)()){const a=this.flavor===k.Elasticsearch&&(0,qe.lt)(this.version,"5.0.0")?"count":"query_then_fetch",s=this.getQueryHeader(a,n.from,n.to);let i=JSON.stringify(this.queryBuilder.getTermsQuery(t));i=i.replace(/\$timeFrom/g,n.from.valueOf().toString()),i=i.replace(/\$timeTo/g,n.to.valueOf().toString()),i=s+"\n"+i+"\n";const o=this.getMultiSearchUrl();return this.postMultiSearch(o,i).then((e=>{if(!e.responses[0].aggregations)return[];const t=e.responses[0].aggregations[1].buckets;return r().map(t,(e=>({text:e.key_as_string||e.key,value:e.key})))}))}getMultiSearchUrl(){return this.maxConcurrentShardRequests&&(this.flavor===k.Elasticsearch&&(0,qe.gte)(this.version,"7.0.0")||this.flavor===k.OpenSearch)?`_msearch?max_concurrent_shard_requests=${this.maxConcurrentShardRequests}`:"_msearch"}getPPLUrl(){return"_opendistro/_ppl"}metricFindQuery(e,t){const r=null==t?void 0:t.range,n=JSON.parse(e);if(e){if("fields"===n.find)return n.type=(0,ae.getTemplateSrv)().replace(n.type,{},"lucene"),this.getFields(n.type,r);if("terms"===n.find)return n.field&&(n.field=(0,ae.getTemplateSrv)().replace(n.field,{},"lucene")),n.script&&(n.script=(0,ae.getTemplateSrv)().replace(n.script)),n.query=(0,ae.getTemplateSrv)().replace(n.query||"*",{},"lucene"),this.getTerms(n,r)}return Promise.resolve([])}getTagKeys(){return this.getFields()}getTagValues(e){return this.getTerms({field:e.key,query:"*"},e.timeRange)}targetContainsTemplate(e){if((0,ae.getTemplateSrv)().variableExists(e.query)||(0,ae.getTemplateSrv)().variableExists(e.alias))return!0;for(const t of e.bucketAggs)if((0,ae.getTemplateSrv)().variableExists(t.field)||this.objectContainsTemplate(t.settings))return!0;for(const t of e.metrics)if((0,ae.getTemplateSrv)().variableExists(t.field)||this.objectContainsTemplate(t.settings)||this.objectContainsTemplate(t.meta))return!0;return!1}isPrimitive(e){return null==e||!!["string","number","boolean"].some((e=>"boolean"===e))}objectContainsTemplate(e){if(!e)return!1;for(const t of Object.keys(e))if(this.isPrimitive(e[t])){if((0,ae.getTemplateSrv)().variableExists(e[t]))return!0}else if(Array.isArray(e[t])){for(const r of e[t])if(this.objectContainsTemplate(r))return!0}else if(this.objectContainsTemplate(e[t]))return!0;return!1}getSupportedQueryTypes(){return[j.Lucene,...this.pplEnabled?[j.PPL]:[]]}constructor(e,t=(0,ae.getTemplateSrv)()){super(e),Ut(this,"templateSrv",void 0),Ut(this,"basicAuth",void 0),Ut(this,"withCredentials",void 0),Ut(this,"url",void 0),Ut(this,"name",void 0),Ut(this,"uid",void 0),Ut(this,"type",void 0),Ut(this,"index",void 0),Ut(this,"timeField",void 0),Ut(this,"flavor",void 0),Ut(this,"version",void 0),Ut(this,"interval",void 0),Ut(this,"maxConcurrentShardRequests",void 0),Ut(this,"queryBuilder",void 0),Ut(this,"indexPattern",void 0),Ut(this,"logMessageField",void 0),Ut(this,"logLevelField",void 0),Ut(this,"dataLinks",void 0),Ut(this,"pplEnabled",void 0),Ut(this,"sigV4Auth",void 0),this.templateSrv=t,this.basicAuth=e.basicAuth,this.withCredentials=e.withCredentials,this.url=e.url,this.name=e.name,this.uid=e.uid,this.type=e.type;const r=e.jsonData||{};var n,a,s;this.index=null!==(n=r.database)&&void 0!==n?n:"",this.timeField=r.timeField,this.flavor=r.flavor||k.OpenSearch,this.version=r.version,this.indexPattern=new Se(this.index,r.interval),this.interval=r.timeInterval,this.maxConcurrentShardRequests=r.maxConcurrentShardRequests,this.queryBuilder=new Ae({timeField:this.timeField,flavor:this.flavor,version:this.version}),this.logMessageField=r.logMessageField||"",this.logLevelField=r.logLevelField||"",this.dataLinks=r.dataLinks||[],this.annotations={QueryEditor:Ue},""===this.logMessageField&&(this.logMessageField=void 0),""===this.logLevelField&&(this.logLevelField=void 0),this.pplEnabled=null===(a=r.pplEnabled)||void 0===a||a,this.sigV4Auth=null!==(s=r.sigV4Auth)&&void 0!==s&&s}}function Ht(e,t){const r=(0,ae.getDataSourceSrv)();if(t.length)for(const a of e.fields){const e=t.find((e=>a.name&&a.name.match(e.field)));if(!e)continue;let s;if(e.datasourceUid){const t=r.getInstanceSettings(e.datasourceUid);var n;s={title:"",url:"",internal:{query:{query:e.url},datasourceUid:e.datasourceUid,datasourceName:null!==(n=null==t?void 0:t.name)&&void 0!==n?n:"Data source not found"}}}else s={title:"",url:e.url};a.config=a.config||{},a.config.links=[...a.config.links||[],s]}}function Qt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{FormField:Kt}=xe.LegacyForms,zt=e=>{const{value:t,onChange:r}=e,n=e=>n=>{var a,s;r((a=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Qt(e,t,r[t])}))}return e}({},t),s=null!=(s={[e]:n.currentTarget.value})?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(s)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(s,e))})),a))};return je().createElement(je().Fragment,null,je().createElement("h3",{className:"page-heading"},"Logs"),je().createElement("div",{className:"gf-form-group"},je().createElement("div",{className:"gf-form max-width-30"},je().createElement(Kt,{"data-testid":"log-message-input",labelWidth:11,label:"Message field name",value:t.logMessageField,onChange:n("logMessageField"),placeholder:"_source"})),je().createElement("div",{className:"gf-form max-width-30"},je().createElement(Kt,{"data-testid":"field-name-input",labelWidth:11,label:"Level field name",value:t.logLevelField,onChange:n("logLevelField")}))))},Xt={Breadcrumbs:{breadcrumb:e=>`data-testid ${e} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",fromField:"Time Range from field",toField:"Time Range to field",applyTimeRange:"data-testid TimePicker submit button",calendar:{label:"Time Range calendar",openButton:"Open time range calendar",closeButton:"Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",exemplarsAddButton:"Add exemplar config button",internalLinkSwitch:"Internal link switch"},exemplarMarker:"Exemplar marker"}},Menu:{MenuComponent:e=>`${e} menu`,MenuGroup:e=>`${e} menu group`,MenuItem:e=>`${e} menu item`,SubMenu:{container:"SubMenu container",icon:"SubMenu icon"}},Panels:{Panel:{title:e=>`data-testid Panel header ${e}`,headerItems:e=>`data-testid Panel header item ${e}`,menuItems:e=>`data-testid Panel menu item ${e}`,menu:e=>`data-testid Panel menu ${e}`,containerByTitle:e=>`${e} panel`,headerCornerInfo:e=>`Panel header ${e}`,status:e=>`data-testid Panel status ${e}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"}},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:e=>`gpl alias ${e}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:e=>`VizLegend series ${e}`},Drawer:{General:{title:e=>`Drawer title ${e}`,expand:"Drawer expand",contract:"Drawer contract",close:"Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper"}},PanelEditor:{General:{content:"Panel editor content"},OptionsPane:{content:"Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:e=>`${e} field property editor`},DataPane:{content:"Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:e=>`Tab ${e}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:e=>`${e}`,title:e=>`Query editor row title ${e}`,container:e=>`Query editor row ${e}`},AlertTab:{content:"Alert editor tab content"},Alert:{alert:e=>`Alert ${e}`,alertV2:e=>`data-testid Alert ${e}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:e=>`data-testid New transform ${e}`,transformationEditor:e=>`data-testid Transformation editor ${e}`,transformationEditorDebugger:e=>`data-testid Transformation editor debugger ${e}`},Transforms:{card:e=>`data-testid New transform ${e}`,Reduce:{modeLabel:"Transform mode label",calculationsLabel:"Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"search transformations",addTransformationButton:"data-testid add transformation button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar"},PageToolbar:{container:()=>".page-toolbar",item:e=>`${e}`,itemButton:e=>`data-testid ${e}`},QueryEditorToolbarItem:{button:e=>`QueryEditor toolbar item button ${e}`},BackButton:{backArrow:"Go Back"},OptionsGroup:{group:e=>e?`Options group ${e}`:"Options group",toggle:e=>e?`Options group ${e} toggle`:"Options group toggle"},PluginVisualization:{item:e=>`Plugin visualization item ${e}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"Select a folder"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source"},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"Query field"},QueryBuilder:{queryPatterns:"Query patterns",labelSelect:"Select label",valueSelect:"Select value",matchOperatorSelect:"Select match operator"},ValuePicker:{button:e=>`Value picker button ${e}`,select:e=>`Value picker select ${e}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:e=>`data-testid Collapse folder ${e}`,expandFolder:e=>`data-testid Expand folder ${e}`,dashboardItem:e=>`${Xt.Search.dashboardItems} ${e}`,dashboardCard:e=>`data-testid Search card ${e}`,folderHeader:e=>`data-testid Folder header ${e}`,folderContent:e=>`data-testid Folder content ${e}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"Loading indicator"},CallToActionCard:{button:e=>`Call to action button ${e}`,buttonV2:e=>`data-testid Call to action button ${e}`},DataLinksContextMenu:{singleLink:"Data link"},CodeEditor:{container:"Code editor container"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"Unified alert editor tab content"},VisualizationPreview:{card:e=>`data-testid suggestion-${e}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:e=>`data-testid dashboard-row-title-${e}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table"},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option"},Annotations:{annotationsTypeInput:"annotations-type-input",annotationsChoosePanelInput:"choose-panels-input"},Tooltip:{container:"data-testid tooltip"}},Jt={pages:{Login:{url:"/login",username:"Username input field",password:"Password input field",submit:"Login button",skip:"Skip change password button"},Home:{url:"/"},DataSource:{name:"Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:e=>`Data source list item ${e}`},EditDataSource:{url:e=>`/datasources/edit/${e}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:e=>`Data source plugin item ${e}`,dataSourcePluginsV2:e=>`Add new data source ${e}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:e=>`data-testid ${e}`,addNewPanel:"Add new panel",addNewRow:"Add new row",addNewPanelLibrary:"Add new panel from panel library"},Dashboard:{url:e=>`/d/${e}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag"},SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:e=>`data-testid Dashboard template variables submenu Label ${e}`,submenuItemValueDropDownValueLinkTexts:e=>`data-testid Dashboard template variables Variable Value DropDown value link text ${e}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:e=>`data-testid Dashboard template variables Variable Value DropDown option text ${e}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:e=>`data-testid Dashboard annotations submenu Label ${e}`,annotationToggle:e=>`data-testid Dashboard annotations submenu Toggle ${e}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"Dashboard settings page delete dashboard button",sectionItems:e=>`Dashboard settings section item ${e}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Tab General"},Annotations:{List:{addAnnotationCTA:Xt.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:Xt.CallToActionCard.buttonV2("Add annotation query")},Settings:{name:"Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"show-in-label",previewInDashboard:"data-testid annotations-preview"}},Variables:{List:{addVariableCTA:Xt.CallToActionCard.button("Add variable"),addVariableCTAV2:Xt.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:e=>`Variable editor Table Name field ${e}`,tableRowDefinitionFields:e=>`Variable editor Table Definition field ${e}`,tableRowArrowUpButtons:e=>`Variable editor Table ArrowUp button ${e}`,tableRowArrowDownButtons:e=>`Variable editor Table ArrowDown button ${e}`,tableRowDuplicateButtons:e=>`Variable editor Table Duplicate button ${e}`,tableRowRemoveButtons:e=>`Variable editor Table Remove button ${e}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"Variable editor Form IncludeAll field",selectionOptionsCustomAllInputV2:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"Variable editor Preview of Values option",submitButton:"Variable editor Submit button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:Xt.DataSourcePicker.container,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:e=>`Dashboard search item ${e}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{shareButton:"Share dashboard",PublicDashboard:{Tab:"Tab Public dashboard",WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"}},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"}},SoloPanel:{url:e=>`/d-solo/${e}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"Plugin signature info",disabledInfo:"Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:e=>`data-testid browse dashboards row ${e}`,checkbox:e=>`data-testid ${e} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:e=>`data-testid dashboards-list-item-${e}`}}},ProfilePage:{url:"/profile"}},components:Xt};function Zt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const er=t=>{var{status:r}=t,n=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(t,["status"]);const a=function(t){switch(t||(t=e.PluginSignatureStatus.invalid),t){case e.PluginSignatureStatus.internal:return{text:"Core",icon:"cube",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case e.PluginSignatureStatus.valid:return{text:"Signed",icon:"lock",color:"green",tooltip:"Signed and verified plugin"};case e.PluginSignatureStatus.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case e.PluginSignatureStatus.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case e.PluginSignatureStatus.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"}}return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}(r);return je().createElement(xe.Badge,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Zt(e,t,r[t])}))}return e}({text:a.text,color:a.color,icon:a.icon,tooltip:a.tooltip},n))};function tr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}er.displayName="PluginSignatureBadge";class rr extends Le.PureComponent{componentDidMount(){const{current:e}=this.props;this.dataSourceSrv.getInstanceSettings(e)||this.setState({error:"Could not find data source "+e})}getCurrentValue(){const{current:e,hideTextValue:t,noDefault:r}=this.props;if(!e&&r)return null;const n=this.dataSourceSrv.getInstanceSettings(e);return n?{label:n.name.substr(0,37),value:n.name,imgUrl:n.meta.info.logos.small,hideText:t,meta:n.meta}:{label:(null!=e?e:"no name")+" - not found",value:e||void 0,imgUrl:"",hideText:t}}getDataSourceOptions(){const{tracing:e,metrics:t,mixed:r,dashboard:n,variables:a,annotations:s,pluginId:i}=this.props;return this.dataSourceSrv.getList({tracing:e,metrics:t,dashboard:n,mixed:r,variables:a,annotations:s,pluginId:i}).map((e=>({value:e.name,label:`${e.name}${e.isDefault?" (default)":""}`,imgUrl:e.meta.info.logos.small,meta:e.meta})))}render(){const{autoFocus:t,onBlur:r,openMenuOnFocus:n,placeholder:a}=this.props,{error:s}=this.state,i=this.getDataSourceOptions(),o=this.getCurrentValue();return je().createElement("div",{"aria-label":Jt.components.DataSourcePicker.container},je().createElement(xe.Select,{className:"ds-picker select-container",isMulti:!1,isClearable:!1,backspaceRemovesValue:!1,onChange:this.onChange,options:i,autoFocus:t,onBlur:r,openMenuOnFocus:n,maxMenuHeight:500,menuPlacement:"bottom",placeholder:a,noOptionsMessage:"No datasources found",value:o,invalid:!!s,getOptionLabel:t=>{return t.meta&&(r=t.meta.signature)&&r!==e.PluginSignatureStatus.valid&&r!==e.PluginSignatureStatus.internal&&t!==o?je().createElement(xe.HorizontalGroup,{align:"center",justify:"space-between"},je().createElement("span",null,t.label)," ",je().createElement(er,{status:t.meta.signature})):t.label||"";var r}}))}constructor(e){super(e),tr(this,"dataSourceSrv",(0,ae.getDataSourceSrv)()),tr(this,"state",{}),tr(this,"onChange",(e=>{const t=this.dataSourceSrv.getInstanceSettings(e.value);t&&(this.props.onChange(t),this.setState({error:void 0}))}))}}function nr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ar(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){nr(e,t,r[t])}))}return e}function sr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}tr(rr,"defaultProps",{autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select datasource"});const{FormField:ir,Switch:or}=xe.LegacyForms,lr=(0,xe.stylesFactory)((()=>({firstRow:ke.css`
    display: flex;
  `,nameField:ke.css`
    flex: 2;
  `,regexField:ke.css`
    flex: 3;
  `,row:ke.css`
    display: flex;
    align-items: baseline;
  `}))),ur=e=>{const{value:t,onChange:r,onDelete:n,suggestions:a,className:s}=e,i=lr(),[o,l]=function(e){const[t,r]=(0,Le.useState)(!!e),n=(a=e,s=(0,Le.useRef)(),(0,Le.useEffect)((function(){s.current=a})),s.current);var a,s;return(0,Le.useEffect)((()=>{n||!e||t||r(!0),n&&!e&&t&&r(!1)}),[n,e,t]),[t,r]}(t.datasourceUid);return je().createElement("div",{className:s},je().createElement("div",{className:i.firstRow+" gf-form"},je().createElement(ir,{className:i.nameField,labelWidth:6,inputWidth:null,label:"Field",type:"text",value:t.field,tooltip:"Can be exact field name or a regex pattern that will match on the field name.",onChange:(u="field",e=>{r(sr(ar({},t),{[u]:e.currentTarget.value}))})}),je().createElement(xe.Button,{"data-testid":`remove-button-${t.field}`,variant:"destructive",title:"Remove field",icon:"times",onClick:e=>{e.preventDefault(),n()}})),je().createElement("div",{className:"gf-form"},je().createElement(ir,{label:o?"Query":"URL",labelWidth:6,inputEl:je().createElement(xe.DataLinkInput,{placeholder:o?"${__value.raw}":"http://example.com/${__value.raw}",value:t.url||"",onChange:e=>r(sr(ar({},t),{url:e})),suggestions:a}),className:ke.css`
            width: 100%;
          `})),je().createElement("div",{className:i.row},je().createElement(or,{labelClass:"width-6",label:"Internal link",checked:o,onChange:()=>{o&&r(sr(ar({},t),{datasourceUid:void 0})),l(!o)}}),o&&je().createElement(rr,{tracing:!0,onChange:e=>{r(sr(ar({},t),{datasourceUid:e.uid}))},current:t.datasourceUid})));var u},cr=e=>({infoText:ke.css`
    padding-bottom: ${e.spacing.md};
    color: ${e.colors.textWeak};
  `,dataLink:ke.css`
    margin-bottom: ${e.spacing.sm};
  `}),pr=t=>{const{value:r,onChange:n}=t,a=(0,xe.useStyles)(cr);return je().createElement(je().Fragment,null,je().createElement("h3",{className:"page-heading"},"Data links"),je().createElement("div",{className:a.infoText},"Add links to existing fields. Links will be shown in log row details next to the field value."),r&&r.length>0&&je().createElement("div",{className:"gf-form-group"},r.map(((t,s)=>je().createElement(ur,{"data-testid":"data-link",className:a.dataLink,key:s,value:t,onChange:e=>{const t=[...r];t.splice(s,1,e),n(t)},onDelete:()=>{const e=[...r];e.splice(s,1),n(e)},suggestions:[{value:e.DataLinkBuiltInVars.valueRaw,label:"Raw value",documentation:"Raw value of the field",origin:e.VariableOrigin.Value}]})))),je().createElement(xe.Button,{"data-testid":"button-add",variant:"secondary",className:ke.css`
          margin-right: 10px;
        `,icon:"plus",onClick:e=>{e.preventDefault();const t=[...r||[],{field:"",url:""}];n(t)}},"Add"))},dr=["af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","cn-north-1","cn-northwest-1","eu-central-1","eu-north-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-gov-east-1","us-gov-west-1","us-iso-east-1","us-isob-east-1","us-west-1","us-west-2"];var fr=(e=>(e.Keys="keys",e.Credentials="credentials",e.Default="default",e.EC2IAMRole="ec2_iam_role",e.ARN="arn",e.GrafanaAssumeRole="grafana_assume_role",e))(fr||{});const gr=[{label:"Workspace IAM Role",value:fr.EC2IAMRole},{label:"Grafana Assume Role",value:fr.GrafanaAssumeRole},{label:"AWS SDK Default",value:fr.Default},{label:"Access & secret key",value:fr.Keys},{label:"Credentials file",value:fr.Credentials}];var hr=Object.defineProperty,mr=Object.defineProperties,yr=Object.getOwnPropertyDescriptors,vr=Object.getOwnPropertySymbols,br=Object.prototype.hasOwnProperty,Er=Object.prototype.propertyIsEnumerable,Or=(e,t,r)=>t in e?hr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wr=(e,t)=>{for(var r in t||(t={}))br.call(t,r)&&Or(e,r,t[r]);if(vr)for(var r of vr(t))Er.call(t,r)&&Or(e,r,t[r]);return e},Sr=(e,t)=>mr(e,yr(t));const qr=28,Tr=["cloudwatch"],Ir=e=>({value:e,label:e}),Ar=e=>"string"==typeof e&&gr.some((t=>t.value===e)),Pr=t=>{var r,n,a,s,i,o,l,u;const[c,p]=(0,Le.useState)(!1),[d,f]=(0,Le.useState)((t.standardRegions||dr).map(Ir)),{loadRegions:g,onOptionsChange:h,skipHeader:m=!1,skipEndpoint:y=!1}=t,{labelWidth:v=qr,options:b,inExperimentalAuthComponent:E}=t;let O=b.jsonData.profile;void 0===O&&(O=b.database);const w=ae.config.featureToggles.awsDatasourcesTempCredentials&&Tr.includes(b.type),S=null==(r=ae.config.awsAssumeRoleEnabled)||r,q=(0,Le.useMemo)((()=>ae.config.awsAllowedAuthProviders.filter((e=>e!==fr.GrafanaAssumeRole||w)).filter(Ar)),[w]),T=gr.find((e=>e.value===b.jsonData.authType));(0,Le.useEffect)((()=>{!T&&q.length&&h(Sr(wr({},b),{jsonData:Sr(wr({},b.jsonData),{authType:q[0]})}))}),[T,b,h,q]),(0,Le.useEffect)((()=>{g&&g().then((e=>f(e.map(Ir))))}),[g]);const I=E?"width-20":"width-30";return je().createElement(xe.FieldSet,{label:m?"":"Connection Details","data-testid":"connection-config"},je().createElement(xe.InlineField,{label:"Authentication Provider",labelWidth:v,tooltip:"Specify which AWS credentials chain to use."},je().createElement(xe.Select,{"aria-label":"Authentication Provider",className:I,value:T,options:gr.filter((e=>q.includes(e.value))),defaultValue:b.jsonData.authType,onChange:r=>{(0,e.onUpdateDatasourceJsonDataOptionSelect)(t,"authType")(r)},menuShouldPortal:!0})),"credentials"===b.jsonData.authType&&je().createElement(xe.InlineField,{label:"Credentials Profile Name",labelWidth:v,tooltip:"Credentials profile name, as specified in ~/.aws/credentials, leave blank for default."},je().createElement(xe.Input,{"aria-label":"Credentials Profile Name",className:I,placeholder:"default",value:O,onChange:(0,e.onUpdateDatasourceJsonDataOption)(t,"profile")})),"keys"===b.jsonData.authType&&je().createElement(je().Fragment,null,je().createElement(xe.InlineField,{label:"Access Key ID",labelWidth:v},(null==(n=t.options.secureJsonFields)?void 0:n.accessKey)?je().createElement(xe.ButtonGroup,{className:I},je().createElement(xe.Input,{disabled:!0,placeholder:"Configured"}),je().createElement(xe.ToolbarButton,{icon:"edit",tooltip:"Edit Access Key ID",type:"button",onClick:(0,e.onUpdateDatasourceResetOption)(t,"accessKey")})):je().createElement(xe.Input,{"aria-label":"Access Key ID",className:I,value:null!=(s=null==(a=b.secureJsonData)?void 0:a.accessKey)?s:"",onChange:(0,e.onUpdateDatasourceSecureJsonDataOption)(t,"accessKey")})),je().createElement(xe.InlineField,{label:"Secret Access Key",labelWidth:v},(null==(i=t.options.secureJsonFields)?void 0:i.secretKey)?je().createElement(xe.ButtonGroup,{className:I},je().createElement(xe.Input,{disabled:!0,placeholder:"Configured"}),je().createElement(xe.ToolbarButton,{icon:"edit",type:"button",tooltip:"Edit Secret Access Key",onClick:(0,e.onUpdateDatasourceResetOption)(t,"secretKey")})):je().createElement(xe.Input,{"aria-label":"Secret Access Key",className:I,value:null!=(l=null==(o=b.secureJsonData)?void 0:o.secretKey)?l:"",onChange:(0,e.onUpdateDatasourceSecureJsonDataOption)(t,"secretKey")}))),b.jsonData.authType===fr.GrafanaAssumeRole&&je().createElement(xe.Collapse,{label:"How to create an IAM role for grafana to assume:",collapsible:!0,isOpen:c,onToggle:()=>p(!c)},je().createElement("ol",null,je().createElement("li",null,je().createElement("p",null,"1. Create a new IAM role in the AWS console, and select ",je().createElement("code",null,"Another AWS account")," as the"," ",je().createElement("code",null,"Trusted entity"),".")),je().createElement("li",null,je().createElement("p",null,"2. Enter the account ID of the Grafana account that has permission to assume this role:",je().createElement("code",null," 008923505280 ")," and check the ",je().createElement("code",null,"Require external ID")," box.")),je().createElement("li",null,je().createElement("p",null,"3. Enter the following external ID:"," ",je().createElement("code",null,t.externalId||"External Id is currently unavailable")," and click ",je().createElement("code",null,"Next"),".")),je().createElement("li",null,je().createElement("p",null,"4. Add any required permissions you would like Grafana to be able to access on your behalf. For more details on our permissions please"," ",je().createElement("a",{href:"https://grafana.com/docs/grafana/latest/datasources/aws-cloudwatch/",target:"_blank",rel:"noreferrer"},"read through our documentation"),".")),je().createElement("li",null,je().createElement("p",null,"5. Give the role a name and description, and click ",je().createElement("code",null,"Create role"),".")),je().createElement("li",null,je().createElement("p",null,"6. Copy the ARN of the role you just created and paste it into the ",je().createElement("code",null,"Assume Role ARN")," field below.")))),S&&je().createElement(je().Fragment,null,je().createElement(xe.InlineField,{label:"Assume Role ARN",labelWidth:v,tooltip:"Optionally, specify the ARN of a role to assume. Specifying a role here will ensure that the selected authentication provider is used to assume the specified role rather than using the credentials directly. Leave blank if you don't need to assume a role at all"},je().createElement(xe.Input,{"aria-label":"Assume Role ARN",className:I,placeholder:"arn:aws:iam:*",value:b.jsonData.assumeRoleArn||"",onChange:(0,e.onUpdateDatasourceJsonDataOption)(t,"assumeRoleArn")})),b.jsonData.authType!==fr.GrafanaAssumeRole&&je().createElement(xe.InlineField,{label:"External ID",labelWidth:v,tooltip:"If you are assuming a role in another account, that has been created with an external ID, specify the external ID here."},je().createElement(xe.Input,{"aria-label":"External ID",className:I,placeholder:"External ID",value:b.jsonData.externalId||"",onChange:(0,e.onUpdateDatasourceJsonDataOption)(t,"externalId")}))),!y&&b.jsonData.authType!==fr.GrafanaAssumeRole&&je().createElement(xe.InlineField,{label:"Endpoint",labelWidth:v,tooltip:"Optionally, specify a custom endpoint for the service"},je().createElement(xe.Input,{"aria-label":"Endpoint",className:I,placeholder:null!=(u=t.defaultEndpoint)?u:"https://{service}.{region}.amazonaws.com",value:b.jsonData.endpoint||"",onChange:(0,e.onUpdateDatasourceJsonDataOption)(t,"endpoint")})),je().createElement(xe.InlineField,{label:"Default Region",labelWidth:v,tooltip:"Specify the region, such as for US West (Oregon) use ` us-west-2 ` as the region."},je().createElement(xe.Select,{"aria-label":"Default Region",className:I,value:d.find((e=>e.value===b.jsonData.defaultRegion)),options:d,defaultValue:b.jsonData.defaultRegion,allowCustomValue:!0,onChange:(0,e.onUpdateDatasourceJsonDataOptionSelect)(t,"defaultRegion"),formatCreateLabel:e=>`Use region: ${e}`,menuShouldPortal:!0})),t.children)};var Rr=Object.defineProperty,Nr=Object.defineProperties,_r=Object.getOwnPropertyDescriptors,Dr=Object.getOwnPropertySymbols,Cr=Object.prototype.hasOwnProperty,Lr=Object.prototype.propertyIsEnumerable,jr=(e,t,r)=>t in e?Rr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,kr=(e,t)=>{for(var r in t||(t={}))Cr.call(t,r)&&jr(e,r,t[r]);if(Dr)for(var r of Dr(t))Lr.call(t,r)&&jr(e,r,t[r]);return e},xr=(e,t)=>Nr(e,_r(t));const Fr=e=>{var t,r,n,a;const{onOptionsChange:s,options:i}=e,o={onOptionsChange:e=>{var t,r,n,a;const o=xr(kr({},i),{jsonData:xr(kr({},i.jsonData),{sigV4AuthType:e.jsonData.authType,sigV4Profile:e.jsonData.profile,sigV4AssumeRoleArn:e.jsonData.assumeRoleArn,sigV4ExternalId:e.jsonData.externalId,sigV4Region:e.jsonData.defaultRegion,sigV4Endpoint:e.jsonData.endpoint}),secureJsonFields:{sigV4AccessKey:null==(t=e.secureJsonFields)?void 0:t.accessKey,sigV4SecretKey:null==(r=e.secureJsonFields)?void 0:r.secretKey},secureJsonData:{sigV4AccessKey:null==(n=e.secureJsonData)?void 0:n.accessKey,sigV4SecretKey:null==(a=e.secureJsonData)?void 0:a.secretKey}});s(o)},options:xr(kr({},i),{jsonData:xr(kr({},i.jsonData),{authType:i.jsonData.sigV4AuthType,profile:i.jsonData.sigV4Profile,assumeRoleArn:i.jsonData.sigV4AssumeRoleArn,externalId:i.jsonData.sigV4ExternalId,defaultRegion:i.jsonData.sigV4Region,endpoint:i.jsonData.sigV4Endpoint}),secureJsonFields:{accessKey:null==(t=i.secureJsonFields)?void 0:t.sigV4AccessKey,secretKey:null==(r=i.secureJsonFields)?void 0:r.sigV4SecretKey},secureJsonData:{accessKey:null==(n=i.secureJsonData)?void 0:n.sigV4AccessKey,secretKey:null==(a=i.secureJsonData)?void 0:a.sigV4SecretKey}}),inExperimentalAuthComponent:e.inExperimentalAuthComponent};return je().createElement(je().Fragment,null,je().createElement("div",{className:"gf-form"},je().createElement("h6",null,"SigV4 Auth Details")),je().createElement(Pr,xr(kr({},o),{skipHeader:!0,skipEndpoint:!0})))};function Mr(e,t,r,n,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function $r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){$r(e,t,r[t])}))}return e}function Ur(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,u(4660),u(8331),Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;const Br=(e,t,r)=>(0,Le.useCallback)((n=>{e(r(t,n))}),[e,t,r]),Gr=(0,Le.createContext)(void 0),Yr=()=>{const e=(0,Le.useContext)(Gr);if(!e)throw new Error("Use DispatchContext first.");return e},Wr="init",Hr="change_query",Qr="change_alias_pattern",Kr=(e,t)=>{switch(t.type){case Hr:return t.payload.query;case Wr:return e||"";default:return e}},zr=(e,t)=>{switch(t.type){case Qr:return t.payload.aliasPattern;case Wr:return e||"";default:return e}},Xr="@metrics/add",Jr="@metrics/remove",Zr="@metrics/change_type",en="@metrics/change_field",tn="@metrics/change_setting",rn="@metrics/change_meta",nn="@metrics/change_attr",an="@metrics/toggle_visibility";function sn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function on(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){sn(e,t,r[t])}))}return e}function ln(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const un=(e,t)=>{switch(t.type){case Xr:return[...e||[],Z(t.payload.id)];case Jr:const r=null==e?void 0:e.find((e=>e.id===t.payload.id)),n=[r,...K(r,e||[])],a=null==e?void 0:e.filter((e=>!n.some((t=>t.id===e.id))));return 0===(null==a?void 0:a.length)?[Z("1")]:a;case Zr:return null==e?void 0:e.filter((e=>!H[t.payload.type].isSingleMetric||e.id===t.payload.id)).map((e=>e.id!==t.payload.id?e:on({id:e.id,type:t.payload.type},H[t.payload.type].defaults)));case en:return null==e?void 0:e.map((e=>e.id!==t.payload.id?e:ln(on({},e),{field:t.payload.field})));case an:return null==e?void 0:e.map((e=>e.id!==t.payload.id?e:ln(on({},e),{hide:!e.hide})));case tn:return e.map((e=>{if(e.id!==t.payload.metric.id)return e;if(W(e)){const r=ce(ln(on({},e.settings),{[t.payload.settingName]:t.payload.newValue}));return ln(on({},e),{settings:on({},r)})}return e}));case rn:return null==e?void 0:e.map((e=>e.id!==t.payload.metric.id?e:(e=>H[e.type].hasMeta)(e)?ln(on({},e),{meta:ln(on({},e.meta),{[t.payload.meta]:t.payload.newValue})}):e));case nn:return null==e?void 0:e.map((e=>e.id!==t.payload.metric.id?e:ln(on({},e),{[t.payload.attribute]:t.payload.newValue})));case Wr:return(null==e?void 0:e.length)?e:[Z("1")];default:return e}},cn="@bucketAggs/add",pn="@bucketAggs/remove",dn="@bucketAggs/change_type",fn="@bucketAggs/change_field",gn="@bucketAggs/change_setting";function hn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){hn(e,t,r[t])}))}return e}function yn(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const vn="change_query_type",bn=(e,t)=>{switch(t.type){case vn:return t.payload.queryType;case Wr:return j.Lucene;default:return e}},En="change_format",On=(e,t)=>{switch(t.type){case En:return t.payload.format;case Wr:return"table";default:return e}};function wn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Sn=(0,Le.createContext)(void 0),qn=(0,Le.createContext)(void 0),Tn=({children:e,onChange:t,query:r,datasource:n})=>{const a=(s={query:Kr,queryType:bn,alias:zr,metrics:un,bucketAggs:(i=n.timeField,(e,t)=>{switch(t.type){case cn:const r={id:t.payload.id,type:"terms",settings:Pe.terms.defaultSettings},n=null==e?void 0:e[e.length-1];return"date_histogram"===(null==n?void 0:n.type)?[...(e||[]).slice(0,-1),r,n]:[...e||[],r];case pn:return null==e?void 0:e.filter((e=>e.id!==t.payload.id));case dn:return null==e?void 0:e.map((e=>e.id!==t.payload.id?e:{id:e.id,type:t.payload.newType,settings:Pe[t.payload.newType].defaultSettings}));case fn:return null==e?void 0:e.map((e=>e.id!==t.payload.id?e:yn(mn({},e),{field:t.payload.newField})));case Zr:return H[t.payload.type].isSingleMetric?[]:0===(null==e?void 0:e.length)?[ee()]:e;case gn:return e.map((e=>{if(e.id!==t.payload.bucketAgg.id)return e;const r=ce(yn(mn({},e.settings),{[t.payload.settingName]:t.payload.newValue}));return yn(mn({},e),{settings:mn({},r)})}));case Wr:return(null==e?void 0:e.length)?e:[yn(mn({},ee("2")),{field:i})];default:return e}}),format:On},(e,t)=>{const r={};for(const n in s)r[n]=s[n](e[n],t);return r});var s,i;const o=Br((e=>{return t((a=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){wn(e,t,r[t])}))}return e}({},r,e),s=null!=(s={timeField:n.timeField})?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(s)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(s,e))})),a));var a,s}),r,a);return r.metrics&&r.bucketAggs&&void 0!==r.query?je().createElement(Sn.Provider,{value:n},je().createElement(qn.Provider,{value:r},je().createElement(Gr.Provider,{value:o},e))):(o({type:Wr}),null)},In=()=>{const e=(0,Le.useContext)(qn);if(!e)throw new Error("use OpenSearchProvider first.");return e},An=()=>{const e=(0,Le.useContext)(Sn);if(!e)throw new Error("use OpenSearchProvider first.");return e},Pn={[j.Lucene]:{label:"Lucene"},[j.PPL]:{label:"PPL"}},Rn=ke.css`
  min-width: 150px;
`,Nn=e=>{const t=Pn[e];return t?{label:t.label,value:e}:{label:"Invalid query type",value:""}},_n=({value:e})=>{const t=An(),r=Yr();return je().createElement(xe.Segment,{"data-testid":"query-type-select",className:Rn,options:(n=t.getSupportedQueryTypes(),Object.entries(Pn).filter((([e,t])=>n.includes(e))).map((([e,{label:t}])=>({label:t,value:e})))),onChange:e=>{var t,n;n=e.value,Object.values(j).includes(n)&&r((t=e.value,{type:vn,payload:{queryType:t}}))},value:Nn(e)});var n},Dn=({children:e,label:r,onRemoveClick:n,onHideClick:a,hidden:s=!1,disableRemove:i=!1})=>{const o=(0,xe.useTheme)(),l=Cn(o);return je().createElement(xe.InlineFieldRow,null,je().createElement(xe.InlineSegmentGroup,null,je().createElement(xe.InlineLabel,{width:17,as:"div"},je().createElement("span",null,r),je().createElement("span",{className:l.iconWrapper},a&&je().createElement(xe.IconButton,{name:s?"eye-slash":"eye",onClick:a,size:"sm","aria-pressed":s,"aria-label":"hide metric",className:l.icon}),n&&je().createElement(xe.IconButton,{name:"trash-alt",size:"sm",className:l.icon,onClick:n||t.noop,disabled:i,"aria-label":"remove metric"})))),e)},Cn=(0,xe.stylesFactory)((e=>({iconWrapper:ke.css`
      display: flex;
    `,icon:ke.css`
      color: ${e.colors.textWeak};
      margin-left: ${e.spacing.xxs};
    `}))),Ln={table:{label:"Table"},logs:{label:"Logs"},time_series:{label:"Time series"}},jn=Object.entries(Ln).map((([e,{label:t}])=>({label:t,value:e}))),kn=({value:e})=>{const t=Yr();return je().createElement(xe.InlineSegmentGroup,{"data-testid":"settings-editor-wrapper"},je().createElement(xe.Segment,{className:Rn,options:jn,onChange:e=>{return t((r=e.value,{type:En,payload:{format:r}}));var r},value:(r=e,{label:Ln[r].label,value:r})}));var r},xn=(0,xe.stylesFactory)((e=>({icon:ke.css`
      margin-right: ${e.spacing.xs};
    `,button:ke.css`
      justify-content: start;
    `}))),Fn=({label:e,open:t,onClick:r})=>{const n=xn((0,xe.useTheme)());return je().createElement("button",{"data-testid":"open-close-button",className:(0,ke.cx)("gf-form-label",n.button,Rn),onClick:r,"aria-expanded":t},je().createElement(xe.Icon,{name:t?"angle-down":"angle-right","aria-hidden":"true",className:n.icon}),e)},Mn=()=>je().createElement("div",{"data-testid":"help-message",className:"gf-form grafana-info-box"},je().createElement("div",null,je().createElement("h5",null,"Table"),je().createElement("ul",null,je().createElement("li",null,"return any set of columns")),je().createElement("br",null),je().createElement("h5",null,"Logs"),je().createElement("ul",null,je().createElement("li",null,"return any set of columns")),je().createElement("br",null),je().createElement("h5",null,"Time series"),je().createElement("ul",null,je().createElement("li",null,"return column as date, datetime, or timestamp"),je().createElement("li",null,"return column with numeric datatype as values")),je().createElement("br",null),"Example PPL query for time series:",je().createElement("br",null),je().createElement("code",null,"source=<index> | eval dateValue=timestamp(timestamp) | stats count(response) by dateValue"))),$n=()=>{const{format:e}=In(),[t,r]=(0,Le.useState)(!1);return je().createElement(je().Fragment,null,je().createElement(Dn,{label:"Format"},je().createElement(kn,{value:null!=e?e:"table"}),je().createElement(Fn,{label:"Show help",open:t,onClick:()=>r(!t)})),t&&je().createElement(Mn,null))},Vn=e=>e.id,Un=e=>parseInt(e,10),Bn=(0,xe.stylesFactory)(((e,t)=>({wrapper:ke.css`
      display: flex;
      flex-direction: column;
    `,settingsWrapper:ke.css`
      padding-top: ${e.spacing.xs};
    `,icon:ke.css`
      margin-right: ${e.spacing.xs};
    `,button:ke.css`
      justify-content: start;
      ${t&&ke.css`
          color: ${e.colors.textFaint};
        `}
    `}))),Gn=({label:e,children:t,hidden:r=!1})=>{const[n,a]=(0,Le.useState)(!1),s=Bn((0,xe.useTheme)(),r);return je().createElement(xe.InlineSegmentGroup,null,je().createElement("div",{className:(0,ke.cx)(s.wrapper)},je().createElement("button",{className:(0,ke.cx)("gf-form-label query-part",s.button,Rn),onClick:()=>a(!n),"aria-expanded":n},je().createElement(xe.Icon,{name:n?"angle-down":"angle-right","aria-hidden":"true",className:s.icon}),e),n&&je().createElement("div",{className:s.settingsWrapper},t)))},Yn=(e,t,r)=>({type:gn,payload:{bucketAgg:e,settingName:t,newValue:r}});function Wn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Hn=ke.css`
  clip: rect(0 0 0 0);
  clip-path: inset(50%);
  height: 1px;
  overflow: hidden;
  position: absolute;
  white-space: nowrap;
  width: 1px;
`,Qn=e=>{var{iconName:t,onClick:r,className:n,label:a}=e,s=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,["iconName","onClick","className","label"]);return je().createElement("button",function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Wn(e,t,r[t])}))}return e}({className:(0,ke.cx)("gf-form-label gf-form-label--btn query-part",n),onClick:r},s),je().createElement("span",{className:Hn},a),je().createElement(xe.Icon,{name:t,"aria-hidden":"true"}))},Kn=({index:e,onAdd:t,onRemove:r,elements:n})=>je().createElement("div",{className:ke.css`
        display: flex;
      `},0===e&&je().createElement(Qn,{iconName:"plus",onClick:t,label:"add"}),n.length>=2&&je().createElement(Qn,{iconName:"minus",onClick:r,label:"remove"})),zn="@bucketAggregations/filter/add",Xn="@bucketAggregations/filter/remove",Jn="@bucketAggregations/filter/change",Zn=()=>({type:zn}),ea=(e,t)=>({type:Jn,payload:{index:e,filter:t}}),ta=(e=[],t)=>{switch(t.type){case zn:return[...e,{label:"",query:"*"}];case Xn:return e.slice(0,t.payload.index).concat(e.slice(t.payload.index+1));case Jn:return e.map(((e,r)=>r!==t.payload.index?e:t.payload.filter))}};function ra(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function na(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ra(e,t,r[t])}))}return e}function aa(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const sa=({value:e})=>{var t,r,n,a;const s=Yr(),i=Br((t=>s(Yn(e,"filters",t))),null===(t=e.settings)||void 0===t?void 0:t.filters,ta);return(0,Le.useEffect)((()=>{var t,r;(null===(r=e.settings)||void 0===r||null===(t=r.filters)||void 0===t?void 0:t.length)||i(Zn())}),[null===(n=e.settings)||void 0===n||null===(r=n.filters)||void 0===r?void 0:r.length,i]),je().createElement(je().Fragment,null,je().createElement("div",{className:ke.css`
          display: flex;
          flex-direction: column;
        `},null===(a=e.settings)||void 0===a?void 0:a.filters.map(((t,r)=>{var n;return je().createElement("div",{key:r,className:ke.css`
              display: flex;
            `},je().createElement("div",{className:ke.css`
                width: 250px;
              `},je().createElement(xe.InlineField,{label:"Query",labelWidth:10},je().createElement(xe.QueryField,{placeholder:"Lucene Query",portalOrigin:"opensearch",onBlur:()=>{},onChange:e=>i(ea(r,aa(na({},t),{query:e}))),query:t.query}))),je().createElement(xe.InlineField,{label:"Label",labelWidth:10},je().createElement(xe.Input,{placeholder:"Label",onBlur:e=>i(ea(r,aa(na({},t),{label:e.target.value}))),defaultValue:t.label})),je().createElement(Kn,{index:r,elements:(null===(n=e.settings)||void 0===n?void 0:n.filters)||[],onAdd:()=>i(Zn()),onRemove:()=>i((e=>({type:Xn,payload:{index:e}}))(r))}))}))))},ia=e=>t=>t.value===e;function oa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function la(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){oa(e,t,r[t])}))}return e}function ua(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ca={labelWidth:16},pa=({bucketAgg:e})=>{var t,r,n,a,s,i,o,l,u,c,p,d,f,g,h,m,y,v,b,E,O,w,S,q;const T=Yr(),{metrics:I}=In(),A=(e=>{const{metrics:t}=In();switch(e.type){case"terms":{var r,n,a,s;const o=(null===(r=e.settings)||void 0===r?void 0:r.order)||"desc",l=(null===(n=e.settings)||void 0===n?void 0:n.size)||"10",u=parseInt((null===(a=e.settings)||void 0===a?void 0:a.min_doc_count)||"0",10),c=(null===(s=e.settings)||void 0===s?void 0:s.orderBy)||"_term";let p="";var i;"0"!==l&&(p=`${null===(i=Re.find(ia(o)))||void 0===i?void 0:i.label} ${l}, `),u>0&&(p+=`Min Doc Count: ${u}, `),p+="Order by: ";const d=_e.find(ia(c));if(d)p+=d.label;else{const e=null==t?void 0:t.find((e=>e.id===c));p+=e?ue(e):"metric not found"}return"0"===l&&(p+=` (${o})`),p}case"histogram":{var o,l;const t=(null===(o=e.settings)||void 0===o?void 0:o.interval)||1e3,r=parseInt((null===(l=e.settings)||void 0===l?void 0:l.min_doc_count)||"1",10);return`Interval: ${t}${r>0?`, Min Doc Count: ${r}`:""}`}case"filters":var u,c;return`Filter Queries (${((null===(u=e.settings)||void 0===u?void 0:u.filters)||(null===(c=Pe.filters.defaultSettings)||void 0===c?void 0:c.filters)).length})`;case"geohash_grid":var p;return`Precision: ${Math.max(Math.min(parseInt((null===(p=e.settings)||void 0===p?void 0:p.precision)||"5",10),12),1)}`;case"date_histogram":{var d,f,g;const t=(null===(d=e.settings)||void 0===d?void 0:d.interval)||"auto",r=parseInt((null===(f=e.settings)||void 0===f?void 0:f.min_doc_count)||"0",10),n=parseInt((null===(g=e.settings)||void 0===g?void 0:g.trimEdges)||"0",10);let a=`Interval: ${t}`;return r>0&&(a+=`, Min Doc Count: ${r}`),n>0&&(a+=`, Trim edges: ${n}`),a}default:return"Settings"}})(e),P=[..._e,...(I||[]).map((e=>({label:ue(e),value:e.id})))];return je().createElement(Gn,{label:A},"terms"===e.type&&je().createElement(je().Fragment,null,je().createElement(xe.InlineField,la({label:"Order"},ca),je().createElement(xe.Select,{onChange:t=>T(Yn(e,"order",t.value)),options:Re,value:(null===(t=e.settings)||void 0===t?void 0:t.order)||(null===(r=Pe[e.type].defaultSettings)||void 0===r?void 0:r.order)})),je().createElement(xe.InlineField,la({label:"Size"},ca),je().createElement(xe.Select,{onChange:t=>T(Yn(e,"size",t.value)),options:Ne,value:(null===(n=e.settings)||void 0===n?void 0:n.size)||(null===(a=Pe[e.type].defaultSettings)||void 0===a?void 0:a.size),allowCustomValue:!0})),je().createElement(xe.InlineField,la({label:"Min Doc Count"},ca),je().createElement(xe.Input,{onBlur:t=>T(Yn(e,"min_doc_count",t.target.value)),defaultValue:(null===(s=e.settings)||void 0===s?void 0:s.min_doc_count)||(null===(i=Pe[e.type].defaultSettings)||void 0===i?void 0:i.min_doc_count)})),je().createElement(xe.InlineField,la({label:"Order By"},ca),je().createElement(xe.Select,{onChange:t=>T(Yn(e,"orderBy",t.value)),options:P,value:(null===(o=e.settings)||void 0===o?void 0:o.orderBy)||(null===(l=Pe[e.type].defaultSettings)||void 0===l?void 0:l.orderBy)})),je().createElement(xe.InlineField,la({label:"Missing"},ca),je().createElement(xe.Input,{onBlur:t=>T(Yn(e,"missing",t.target.value)),defaultValue:(null===(u=e.settings)||void 0===u?void 0:u.missing)||(null===(c=Pe[e.type].defaultSettings)||void 0===c?void 0:c.missing)}))),"geohash_grid"===e.type&&je().createElement(xe.InlineField,la({label:"Precision"},ca),je().createElement(xe.Input,{onBlur:t=>T(Yn(e,"precision",t.target.value)),defaultValue:(null===(p=e.settings)||void 0===p?void 0:p.precision)||(null===(d=Pe[e.type].defaultSettings)||void 0===d?void 0:d.precision)})),"date_histogram"===e.type&&je().createElement(je().Fragment,null,je().createElement(xe.InlineField,la({label:"Interval"},ca),je().createElement(xe.Select,{onChange:t=>T(Yn(e,"interval",t.value)),options:De,value:(null===(f=e.settings)||void 0===f?void 0:f.interval)||(null===(g=Pe[e.type].defaultSettings)||void 0===g?void 0:g.interval),allowCustomValue:!0})),je().createElement(xe.InlineField,la({label:"Min Doc Count"},ca),je().createElement(xe.Input,{onBlur:t=>T(Yn(e,"min_doc_count",t.target.value)),defaultValue:(null===(h=e.settings)||void 0===h?void 0:h.min_doc_count)||(null===(m=Pe[e.type].defaultSettings)||void 0===m?void 0:m.min_doc_count)})),je().createElement(xe.InlineField,ua(la({label:"Trim Edges"},ca),{tooltip:"Trim the edges on the timeseries datapoints"}),je().createElement(xe.Input,{onBlur:t=>T(Yn(e,"trimEdges",t.target.value)),defaultValue:(null===(y=e.settings)||void 0===y?void 0:y.trimEdges)||(null===(v=Pe[e.type].defaultSettings)||void 0===v?void 0:v.trimEdges)})),je().createElement(xe.InlineField,ua(la({label:"Offset"},ca),{tooltip:"Change the start value of each bucket by the specified positive (+) or negative offset (-) duration, such as 1h for an hour, or 1d for a day"}),je().createElement(xe.Input,{onBlur:t=>T(Yn(e,"offset",t.target.value)),defaultValue:(null===(b=e.settings)||void 0===b?void 0:b.offset)||(null===(E=Pe[e.type].defaultSettings)||void 0===E?void 0:E.offset)}))),"histogram"===e.type&&je().createElement(je().Fragment,null,je().createElement(xe.InlineField,la({label:"Interval"},ca),je().createElement(xe.Input,{onBlur:t=>T(Yn(e,"interval",t.target.value)),defaultValue:(null===(O=e.settings)||void 0===O?void 0:O.interval)||(null===(w=Pe[e.type].defaultSettings)||void 0===w?void 0:w.interval)})),je().createElement(xe.InlineField,la({label:"Min Doc Count"},ca),je().createElement(xe.Input,{onBlur:t=>T(Yn(e,"min_doc_count",t.target.value)),defaultValue:(null===(S=e.settings)||void 0===S?void 0:S.min_doc_count)||(null===(q=Pe[e.type].defaultSettings)||void 0===q?void 0:q.min_doc_count)}))),"filters"===e.type&&je().createElement(sa,{value:e}))};function da(e,t,r,n,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}const fa=Object.entries(Pe).map((([e,{label:t}])=>({label:t,value:e}))),ga=({value:e,text:t})=>({label:t,value:`${e||t}`}),ha=({value:e})=>{const t=An(),r=Yr(),n=(a=function*(){return(yield(()=>{switch(e.type){case"date_histogram":return t.getFields("date");case"geohash_grid":return t.getFields("geo_point");default:return t.getFields()}})()).map(ga)},s=function(){var e=this,t=arguments;return new Promise((function(r,n){var s=a.apply(e,t);function i(e){da(s,r,n,i,o,"next",e)}function o(e){da(s,r,n,i,o,"throw",e)}i(void 0)}))},function(){return s.apply(this,arguments)});var a,s,i;return je().createElement(je().Fragment,null,je().createElement(xe.InlineSegmentGroup,null,je().createElement(xe.Segment,{className:Rn,options:fa,onChange:t=>{return r((n=e.id,a=t.value,{type:dn,payload:{id:n,newType:a}}));var n,a},value:(i=e,{label:Pe[i.type].label,value:i.type})}),Ce(e)&&je().createElement(xe.SegmentAsync,{className:Rn,loadOptions:n,onChange:t=>{return r((n=e.id,a=t.value,{type:fn,payload:{id:n,newField:a}}));var n,a},placeholder:"Select Field",value:e.field}),je().createElement(pa,{bucketAgg:e})))},ma=({nextId:e})=>{const t=Yr(),{bucketAggs:r}=In(),n=(null==r?void 0:r.length)||0;return je().createElement(je().Fragment,null,r.map(((r,a)=>je().createElement(Dn,{key:r.id,label:0===a?"Group By":"Then By",onRemoveClick:()=>{return t((e=r.id,{type:pn,payload:{id:e}}));var e},disableRemove:!(n>1)},je().createElement(ha,{value:r}),0===a&&je().createElement(Qn,{iconName:"plus",onClick:()=>t({type:cn,payload:{id:e}}),label:"add"})))))},ya=(0,xe.stylesFactory)(((e,t)=>({color:t&&ke.css`
      &,
      &:hover,
      label,
      a {
        color: ${t?e.colors.textFaint:e.colors.text};
      }
    `}))),va=(e,t)=>({type:en,payload:{id:e,field:t}}),ba=(e,t,r)=>({type:tn,payload:{metric:e,settingName:t,newValue:r}}),Ea=ke.css`
  white-space: nowrap;
`,Oa=e=>({label:ue(e),value:e}),wa=({options:e,onChange:t,className:r,value:n})=>{return je().createElement(xe.Segment,{className:(0,ke.cx)(r,Ea),options:(a=e,a.map(Oa)),onChange:t,placeholder:"Select Metric",value:n?Oa(e.find((e=>e.id===n))):void 0});var a},Sa="@pipelineVariables/add",qa="@pipelineVariables/remove",Ta="@pipelineVariables/rename",Ia="@pipelineVariables/change_metric";function Aa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Aa(e,t,r[t])}))}return e}function Ra(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Na=(e=[],t)=>{switch(t.type){case Sa:return[...e,{name:"var1",pipelineAgg:""}];case qa:return e.slice(0,t.payload.index).concat(e.slice(t.payload.index+1));case Ta:return e.map(((e,r)=>r!==t.payload.index?e:Ra(Pa({},e),{name:t.payload.newName})));case Ia:return e.map(((e,r)=>r!==t.payload.index?e:Ra(Pa({},e),{pipelineAgg:t.payload.newMetric})));default:return e}},_a=()=>({type:Sa});function Da({label:e,settingName:r,metric:n,placeholder:a,tooltip:s}){const i=Yr(),[o]=(0,Le.useState)((0,t.uniqueId)("es-field-id-")),l=n.settings;return je().createElement(xe.InlineField,{label:e,labelWidth:16,tooltip:s},je().createElement(xe.Input,{id:o,placeholder:a,onBlur:e=>i(ba(n,r,e.target.value)),defaultValue:null==l?void 0:l[r]}))}const Ca=({value:e,previousMetrics:t})=>{var r;const n=Yr(),a=Br((t=>n({type:nn,payload:{metric:e,attribute:"pipelineVariables",newValue:t}})),e.pipelineVariables,Na);return(0,Le.useEffect)((()=>{var t;(null===(t=e.pipelineVariables)||void 0===t?void 0:t.length)||a(_a())}),[null===(r=e.pipelineVariables)||void 0===r?void 0:r.length,a]),je().createElement(je().Fragment,null,je().createElement("div",{className:ke.css`
          display: flex;
        `},je().createElement(xe.InlineLabel,{width:16},"Variables"),je().createElement("div",{className:ke.css`
            display: grid;
            grid-template-columns: 1fr auto;
            row-gap: 4px;
            margin-bottom: 4px;
          `},e.pipelineVariables.map(((r,n)=>je().createElement(Le.Fragment,{key:r.name},je().createElement("div",{className:ke.css`
                  display: grid;
                  column-gap: 4px;
                  grid-template-columns: auto auto;
                `},je().createElement(xe.Input,{defaultValue:r.name,placeholder:"Variable Name",onBlur:e=>a(((e,t)=>({type:Ta,payload:{index:t,newName:e}}))(e.target.value,n))}),je().createElement(wa,{onChange:e=>a(((e,t)=>({type:Ia,payload:{index:t,newMetric:e}}))(e.value.id,n)),options:t,value:r.pipelineAgg})),je().createElement(Kn,{index:n,elements:e.pipelineVariables||[],onAdd:()=>a(_a()),onRemove:()=>a((e=>({type:qa,payload:{index:e}}))(n))})))))),je().createElement(Da,{label:"Script",metric:e,settingName:"script",tooltip:"Scripting language is Painless. Use params.<var> to reference a variable.",placeholder:"params.var1 / params.var2"}))};function La(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ja(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){La(e,t,r[t])}))}return e}function ka(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const xa=({metric:e})=>{var t,r,n,a,s,i,o,l,u,c,p,d,f,g,h,m,y,v,b,E,O,w;const S=Yr();return je().createElement(je().Fragment,null,je().createElement(xe.InlineField,{label:"Model"},je().createElement(xe.Select,{onChange:t=>S(ba(e,"model",t.value)),options:J,value:null===(t=e.settings)||void 0===t?void 0:t.model})),je().createElement(xe.InlineField,{label:"Window"},je().createElement(xe.Input,{onBlur:t=>S(ba(e,"window",parseInt(t.target.value,10))),defaultValue:null===(r=e.settings)||void 0===r?void 0:r.window})),je().createElement(xe.InlineField,{label:"Predict"},je().createElement(xe.Input,{onBlur:t=>S(ba(e,"predict",parseInt(t.target.value,10))),defaultValue:null===(n=e.settings)||void 0===n?void 0:n.predict})),(e=>{var t;return"ewma"===(null===(t=e.settings)||void 0===t?void 0:t.model)})(e)&&je().createElement(je().Fragment,null,je().createElement(xe.InlineField,{label:"Alpha"},je().createElement(xe.Input,{onBlur:t=>{var r;return S(ba(e,"settings",ka(ja({},null===(r=e.settings)||void 0===r?void 0:r.settings),{alpha:parseFloat(t.target.value)})))},defaultValue:null===(s=e.settings)||void 0===s||null===(a=s.settings)||void 0===a?void 0:a.alpha})),je().createElement(xe.InlineField,{label:"Minimize"},je().createElement(xe.Switch,{onChange:t=>S(ba(e,"minimize",t.target.checked)),checked:!!(null===(i=e.settings)||void 0===i?void 0:i.minimize)}))),(e=>{var t;return"holt"===(null===(t=e.settings)||void 0===t?void 0:t.model)})(e)&&je().createElement(je().Fragment,null,je().createElement(xe.InlineField,{label:"Alpha"},je().createElement(xe.Input,{onBlur:t=>{var r;return S(ba(e,"settings",ka(ja({},null===(r=e.settings)||void 0===r?void 0:r.settings),{alpha:parseFloat(t.target.value)})))},defaultValue:null===(l=e.settings)||void 0===l||null===(o=l.settings)||void 0===o?void 0:o.alpha})),je().createElement(xe.InlineField,{label:"Beta"},je().createElement(xe.Input,{onBlur:t=>{var r;return S(ba(e,"settings",ka(ja({},null===(r=e.settings)||void 0===r?void 0:r.settings),{beta:parseFloat(t.target.value)})))},defaultValue:null===(c=e.settings)||void 0===c||null===(u=c.settings)||void 0===u?void 0:u.beta})),je().createElement(xe.InlineField,{label:"Minimize"},je().createElement(xe.Switch,{onChange:t=>S(ba(e,"minimize",t.target.checked)),checked:!!(null===(p=e.settings)||void 0===p?void 0:p.minimize)}))),(e=>{var t;return"holt_winters"===(null===(t=e.settings)||void 0===t?void 0:t.model)})(e)&&je().createElement(je().Fragment,null,je().createElement(xe.InlineField,{label:"Alpha"},je().createElement(xe.Input,{onBlur:t=>{var r;return S(ba(e,"settings",ka(ja({},null===(r=e.settings)||void 0===r?void 0:r.settings),{alpha:parseFloat(t.target.value)})))},defaultValue:null===(f=e.settings)||void 0===f||null===(d=f.settings)||void 0===d?void 0:d.alpha})),je().createElement(xe.InlineField,{label:"Beta"},je().createElement(xe.Input,{onBlur:t=>{var r;return S(ba(e,"settings",ka(ja({},null===(r=e.settings)||void 0===r?void 0:r.settings),{beta:parseFloat(t.target.value)})))},defaultValue:null===(h=e.settings)||void 0===h||null===(g=h.settings)||void 0===g?void 0:g.beta})),je().createElement(xe.InlineField,{label:"Gamma"},je().createElement(xe.Input,{onBlur:t=>{var r;return S(ba(e,"settings",ka(ja({},null===(r=e.settings)||void 0===r?void 0:r.settings),{gamma:parseFloat(t.target.value)})))},defaultValue:null===(y=e.settings)||void 0===y||null===(m=y.settings)||void 0===m?void 0:m.gamma})),je().createElement(xe.InlineField,{label:"Period"},je().createElement(xe.Input,{onBlur:t=>{var r;return S(ba(e,"settings",ka(ja({},null===(r=e.settings)||void 0===r?void 0:r.settings),{period:parseInt(t.target.value,10)})))},defaultValue:null===(b=e.settings)||void 0===b||null===(v=b.settings)||void 0===v?void 0:v.period})),je().createElement(xe.InlineField,{label:"Pad"},je().createElement(xe.Switch,{onChange:t=>{var r;return S(ba(e,"settings",ka(ja({},null===(r=e.settings)||void 0===r?void 0:r.settings),{pad:t.target.checked})))},checked:!!(null===(O=e.settings)||void 0===O||null===(E=O.settings)||void 0===E?void 0:E.pad)})),je().createElement(xe.InlineField,{label:"Minimize"},je().createElement(xe.Switch,{onChange:t=>S(ba(e,"minimize",t.target.checked)),checked:!!(null===(w=e.settings)||void 0===w?void 0:w.minimize)}))))};function Fa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ma(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Fa(e,t,r[t])}))}return e}const $a={labelWidth:16},Va=({metric:e,previousMetrics:t})=>{var r,n,a,s,i,o,l;const u=Yr(),c=(e=>{switch(e.type){case"cardinality":var t;return`Precision threshold: ${(null===(t=e.settings)||void 0===t?void 0:t.precision_threshold)||""}`;case"percentiles":var r,n,a,s;return(null===(r=e.settings)||void 0===r?void 0:r.percents)&&(null===(a=e.settings)||void 0===a||null===(n=a.percents)||void 0===n?void 0:n.length)>=1?`Values: ${null===(s=e.settings)||void 0===s?void 0:s.percents}`:"Percents: Default";case"extended_stats":{const t=Object.entries(e.meta||{}).map((([e,t])=>{var r;return t&&(null===(r=X.find((e=>t=>t.value===e)(e)))||void 0===r?void 0:r.label)})).filter(Boolean);return`Stats: ${t.length>0?t.join(", "):"None selected"}`}case"raw_document":case"raw_data":{var i,o;let t=`Size: ${(null===(i=e.settings)||void 0===i?void 0:i.size)||500}`;return t+=`, Order: ${(null===(o=e.settings)||void 0===o?void 0:o.order)||"desc"}`,t}default:return"Options"}})(e),p=In();var d;return je().createElement(Gn,{label:c,hidden:e.hide},"derivative"===e.type&&je().createElement(Da,{label:"Unit",metric:e,settingName:"unit"}),"cumulative_sum"===e.type&&je().createElement(Da,{label:"Format",metric:e,settingName:"format"}),"moving_avg"===e.type&&je().createElement(xa,{metric:e}),"moving_fn"===e.type&&je().createElement(je().Fragment,null,je().createElement(Da,{label:"Window",metric:e,settingName:"window"}),je().createElement(Da,{label:"Script",metric:e,settingName:"script"}),je().createElement(Da,{label:"Shift",metric:e,settingName:"shift"})),"bucket_script"===e.type&&je().createElement(Ca,{value:e,previousMetrics:t}),("raw_data"===e.type||"raw_document"===e.type)&&je().createElement(je().Fragment,null,je().createElement(xe.InlineField,Ma({label:"Size"},$a),je().createElement(xe.Input,{id:`ES-query-${p.refId}_metric-${e.id}-size`,onBlur:t=>u(ba(e,"size",t.target.value)),defaultValue:null!==(d=null===(r=e.settings)||void 0===r?void 0:r.size)&&void 0!==d?d:null===(n=H.raw_data.defaults.settings)||void 0===n?void 0:n.size})),je().createElement(xe.InlineField,Ma({label:"Use time range"},$a),je().createElement(xe.Switch,{id:`ES-query-${p.refId}_metric-${e.id}-use-time-range`,onChange:t=>u(ba(e,"useTimeRange",t.target.checked)),value:null===(a=e.settings)||void 0===a?void 0:a.useTimeRange})),(null===(s=e.settings)||void 0===s?void 0:s.useTimeRange)&&je().createElement(xe.InlineField,{label:"Order"},je().createElement(xe.Select,{id:`ES-query-${p.refId}_metric-${e.id}-order`,options:z,onChange:t=>u(ba(e,"order",t.value)),value:(null===(i=e.settings)||void 0===i?void 0:i.order)||"desc"}))),"cardinality"===e.type&&je().createElement(Da,{label:"Precision Threshold",metric:e,settingName:"precision_threshold"}),"extended_stats"===e.type&&je().createElement(je().Fragment,null,X.map((t=>{var r,n,a;return je().createElement(Ua,{key:t.value,stat:t,onChange:r=>u(((e,t,r)=>({type:rn,payload:{metric:e,meta:t,newValue:r}}))(e,t.value,r)),value:void 0!==(null===(r=e.meta)||void 0===r?void 0:r[t.value])?!!(null===(n=e.meta)||void 0===n?void 0:n[t.value]):!!(null===(a=H.extended_stats.defaults.meta)||void 0===a?void 0:a[t.value])})})),je().createElement(Da,{label:"Sigma",metric:e,settingName:"sigma",placeholder:"3"})),"percentiles"===e.type&&je().createElement(xe.InlineField,Ma({label:"Percentiles"},$a),je().createElement(xe.Input,{onBlur:t=>u(ba(e,"percents",t.target.value.split(",").filter(Boolean))),defaultValue:(null===(o=e.settings)||void 0===o?void 0:o.percents)||(null===(l=H.percentiles.defaults.settings)||void 0===l?void 0:l.percents),placeholder:"1,5,25,50,75,95,99"})),(e=>H[e.type].supportsInlineScript)(e)&&je().createElement(Da,{label:"Script",metric:e,settingName:"script",placeholder:"_value * 1"}),(e=>H[e.type].supportsMissing)(e)&&je().createElement(Da,{label:"Missing",metric:e,settingName:"missing",tooltip:"The missing parameter defines how documents that are missing a value should be treated. By default they will be ignored but it is also possible to treat them as if they had a value"}))},Ua=({stat:e,onChange:r,value:n})=>{const[a]=(0,Le.useState)((0,t.uniqueId)("es-field-id-"));return je().createElement(xe.InlineField,(s=Ma({label:e.label},$a),i=null!=(i={key:e.value})?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(i)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(i)).forEach((function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(i,e))})),s),je().createElement(xe.Switch,{id:a,onChange:e=>r(e.target.checked),value:n}));var s,i};function Ba(e,t,r,n,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}const Ga=({value:e,text:t})=>({label:t,value:`${e||t}`}),Ya=e=>!H[e.type].isPipelineAgg,Wa=(e,t,r)=>{const n=e.some(Ya);return Object.entries(H).filter((([e,{versionRange:n}])=>(0,qe.satisfies)(r,(null==n?void 0:n[t])||"*"))).filter((([e,t])=>n||!t.isPipelineAgg)).map((([e,{label:t}])=>({label:t,value:e})))},Ha=({value:e})=>{const t=ya((0,xe.useTheme)(),!!e.hide),r=An(),n=In(),a=Yr(),s=n.metrics.slice(0,n.metrics.findIndex((t=>t.id===e.id))),i=(o=function*(){return(yield"cardinality"===e.type?r.getFields():r.getFields("number")).map(Ga)},l=function(){var e=this,t=arguments;return new Promise((function(r,n){var a=o.apply(e,t);function s(e){Ba(a,r,n,s,i,"next",e)}function i(e){Ba(a,r,n,s,i,"throw",e)}s(void 0)}))},function(){return l.apply(this,arguments)});var o,l,u;return je().createElement(je().Fragment,null,je().createElement(xe.InlineSegmentGroup,null,je().createElement(xe.Segment,{className:(0,ke.cx)(t.color,Rn),options:Wa(s,r.flavor,r.version),onChange:t=>{return a((r=e.id,n=t.value,{type:Zr,payload:{id:r,type:n}}));var r,n},value:(u=e,{label:H[u.type].label,value:u.type})}),B(e)&&!G(e)&&je().createElement(xe.SegmentAsync,{className:(0,ke.cx)(t.color,Rn),loadOptions:i,onChange:t=>a(va(e.id,t.value)),placeholder:"Select Field",value:e.field}),G(e)&&!Y(e)&&je().createElement(wa,{className:(0,ke.cx)(t.color,Rn),onChange:t=>{var r;return a(va(e.id,null===(r=t.value)||void 0===r?void 0:r.id))},options:s,value:e.field})),W(e)&&je().createElement(Va,{metric:e,previousMetrics:s}))},Qa=({nextId:e})=>{const t=Yr(),{metrics:r}=In(),n=(null==r?void 0:r.length)||0;return je().createElement(je().Fragment,null,null==r?void 0:r.map(((r,a)=>je().createElement(Dn,{key:r.id,label:`Metric (${r.id})`,hidden:r.hide,onHideClick:()=>{return t((e=r.id,{type:an,payload:{id:e}}));var e},onRemoveClick:()=>{return t((e=r.id,{type:Jr,payload:{id:e}}));var e},disableRemove:!(n>1)},je().createElement(Ha,{value:r}),!H[r.type].isSingleMetric&&0===a&&je().createElement(Qn,{iconName:"plus",onClick:()=>t({type:Xr,payload:{id:e}}),label:"add"})))))};function Ka(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function za(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ka(e,t,r[t])}))}return e}function Xa(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Ja=e=>({label:e,value:e}),Za=e=>{const t=e.query.luceneQueryType||x.Metric,r=(()=>{const{metrics:e,bucketAggs:t}=In();return(0,Le.useMemo)((()=>(Math.max(...[...(null==e?void 0:e.map(Vn))||["0"],...(null==t?void 0:t.map(Vn))||["0"]].map(Un))+1).toString()),[e,t])})();return je().createElement(je().Fragment,null,je().createElement(Dn,{label:"Lucene Query Type",disableRemove:!0},je().createElement(xe.InlineSegmentGroup,null,je().createElement(xe.Segment,{className:Rn,options:Object.values(x).map(Ja),onChange:r=>{var n;n=r.value?x[r.value]:x[t],e.onChange(Xa(za({},e.query),{luceneQueryType:n}))},value:Ja(t)}),t===x.Traces&&je().createElement(xe.InlineField,{label:"Service Map",tooltip:"Request and display service map data for trace(s)"},je().createElement(xe.InlineSwitch,{value:e.query.serviceMap||!1,onChange:t=>{const r=t.currentTarget.checked;e.onChange(Xa(za({},e.query),{serviceMap:r}))}})))),t===x.Metric&&je().createElement(je().Fragment,null,je().createElement(Qa,{nextId:r}),je().createElement(ma,{nextId:r})))},es={queryWrapper:ke.css`
    display: flex;
    flex-grow: 1;
  `},ts=({value:e,onChange:t})=>{const r=Yr();return je().createElement(je().Fragment,null,je().createElement(xe.InlineFieldRow,null,je().createElement(xe.InlineField,{label:"Query",labelWidth:17,grow:!0},je().createElement("div",{className:es.queryWrapper},je().createElement(_n,{value:e.queryType||j.Lucene}),je().createElement(xe.QueryField,{query:e.query,onBlur:()=>{},onChange:e=>r((e=>({type:Hr,payload:{query:e}}))(e)),placeholder:e.queryType===j.PPL?"PPL Query":"Lucene Query",portalOrigin:"opensearch"}))),e.queryType!==j.PPL&&e.luceneQueryType!==x.Traces&&je().createElement(xe.InlineField,{label:"Alias",labelWidth:15},je().createElement(xe.Input,{placeholder:"Alias Pattern",onBlur:e=>{return r((t=e.currentTarget.value,{type:Qr,payload:{aliasPattern:t}}));var t},defaultValue:e.alias}))),e.queryType===j.PPL?je().createElement($n,null):je().createElement(Za,{query:e,onChange:t}))},rs=new e.DataSourcePlugin(Wt).setQueryEditor((({query:e,onChange:t,datasource:r})=>je().createElement(Tn,{datasource:r,onChange:t,query:e},je().createElement(ts,{value:e,onChange:t})))).setConfigEditor((e=>{const{options:t,onOptionsChange:r}=e,n=ut(t);(0,Le.useEffect)((()=>{(e=>!(!(0,qe.valid)(e.jsonData.version)||e.jsonData.flavor!==k.OpenSearch&&e.jsonData.flavor!==k.Elasticsearch||!e.jsonData.timeField||!e.jsonData.maxConcurrentShardRequests||void 0===e.jsonData.logMessageField||void 0===e.jsonData.logLevelField||void 0===e.jsonData.pplEnabled))(t)||r(ut(t))}),[]);const[a,s]=(0,Le.useState)(!!n.version&&n.version>1),i=function(e){const[t,r]=(0,Le.useState)();return(0,Le.useEffect)((()=>{e.options.version&&(0,ae.getDataSourceSrv)().get(e.options.uid).then((e=>{e instanceof Wt&&r(e)}))}),[e.options.version,e.options.uid]),t}(e);(0,Le.useEffect)((()=>{s(!1)}),[n.url,n.access,n.basicAuth,n.basicAuthUser,n.withCredentials,n.secureJsonData,n.jsonData]);const o=(l=function*(e=n){if(a)return;const{datasource:t}=yield(0,ae.getBackendSrv)().put(`/api/datasources/${n.id}`,e);e.version=t.version,r(e),s(!0)},u=function(){var e=this,t=arguments;return new Promise((function(r,n){var a=l.apply(e,t);function s(e){Mr(a,r,n,s,i,"next",e)}function i(e){Mr(a,r,n,s,i,"throw",e)}s(void 0)}))},function(){return u.apply(this,arguments)});var l,u;return je().createElement(je().Fragment,null,je().createElement(xe.DataSourceHttpSettings,{defaultUrl:"http://localhost:9200",dataSourceConfig:n,showAccessOptions:!0,onChange:r,sigV4AuthToggleEnabled:ae.config.sigV4AuthEnabled,renderSigV4Editor:je().createElement(Fr,e)}),je().createElement(et,{value:n,onChange:r,saveOptions:o,datasource:i}),je().createElement(zt,{value:n.jsonData,onChange:e=>r(Ur(Vr({},n),{jsonData:e}))}),je().createElement(pr,{value:n.jsonData.dataLinks,onChange:e=>{r(Ur(Vr({},n),{jsonData:Ur(Vr({},n.jsonData),{dataLinks:e})}))}}))}))})(),c})()));
//# sourceMappingURL=module.js.map